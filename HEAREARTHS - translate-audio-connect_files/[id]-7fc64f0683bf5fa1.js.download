(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4263],{60373:(e,t,s)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/project/[id]",function(){return s(42906)}])},76094:(e,t,s)=>{"use strict";s.d(t,{cn:()=>n});var r=s(34164),a=s(50856);function n(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,a.QP)((0,r.$)(t))}},42906:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>eh});var r=s(74848),a=s(96540),n=s(86715),o=s(13368),l=s.n(o),i=s(91106),c=s.n(i),d=s(46059),u=s(804),m=s(62636);let x=["prerequisites","app-icon","expo-token","expo-create-project","expo-project-info","apple-create-key","apple-p8","apple-key-id","apple-issuer-id","apple-team-id","apple-create-bundle-id","apple-bundle-id","apple-create-app","apple-app-id","google-create-app","google-create-service-account","google-create-service-key","google-service-account","google-add-service-account","review","publishing"];function p(e){let{isOpen:t,onClose:s,projectId:n,onPublishSuccess:o}=e,[l,i]=(0,a.useState)("prerequisites"),[c,d]=(0,a.useState)(!1),[u,p]=(0,a.useState)(""),[h,g]=(0,a.useState)(""),[f,y]=(0,a.useState)(!1),[b,v]=(0,a.useState)(!1),[j,w]=(0,a.useState)(!1),[N,k]=(0,a.useState)(!1),[C,S]=(0,a.useState)(!1),[E,D]=(0,a.useState)(!1),[T,I]=(0,a.useState)(!1),[A,L]=(0,a.useState)(!1),[P,M]=(0,a.useState)(!1),[O,_]=(0,a.useState)(!1),[B,R]=(0,a.useState)(""),[F,U]=(0,a.useState)(!1),[z,W]=(0,a.useState)(!1),[G,J]=(0,a.useState)({expoAccessToken:"",expoProjectSlug:"",expoProjectOwner:"",expoProjectId:"",appleP8File:null,appleKeyId:"",appleTeamId:"",appleIssuerId:"",appleAppId:"",appleBundleId:"",googleServiceAccount:null}),H=(0,a.useCallback)(async()=>{try{let e=await fetch("/api/projects/".concat(n,"?files=no"));if(e.ok){let t=(await e.json()).project;if(t.assets&&Array.isArray(t.assets)){let e=t.assets.find(e=>"./assets/images/icon.png"===e.localPath);e&&p(e.remoteUrl)}}}catch(e){console.error("Error fetching current icon:",e)}},[n]);(0,a.useEffect)(()=>{t&&(i("prerequisites"),d(!1),p(""),g(""),y(!1),v(!1),w(!1),k(!1),S(!1),D(!1),I(!1),L(!1),M(!1),_(!1),R(""),U(!1),W(!1),H())},[t,H]);let V=(e,t)=>{if(J(s=>({...s,[e]:t})),"googleServiceAccount"===e&&t){let e=new FileReader;e.onload=e=>{try{var t;let s=JSON.parse(null===(t=e.target)||void 0===t?void 0:t.result);s.client_email&&R(s.client_email)}catch(e){console.error("Error parsing JSON:",e),R("")}},e.readAsText(t)}else"googleServiceAccount"!==e||t||R("")},q=(e,t)=>{J(s=>({...s,[e]:t}))},Y=async e=>{y(!0);try{let t=await fetch("/api/uploads/signed-url",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({fileType:e.type,fileName:e.name||"icon-".concat(Date.now(),".").concat(e.type.split("/")[1])})});if(!t.ok){let e=await t.json();throw Error(e.error||"Failed to get signed URL")}let{signedUrl:s,fileUrl:r}=await t.json();if(!(await fetch(s,{method:"PUT",body:e,headers:{"Content-Type":e.type},mode:"cors"})).ok)throw Error("Failed to upload file to S3");if(!(await fetch("/api/projects/update-icon",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({projectId:n,iconUrl:r})})).ok)throw Error("Failed to update icon in database");g(r),m.Ay.success("App icon updated")}catch(e){console.error("Error uploading icon:",e),m.Ay.error("Failed to upload icon")}finally{y(!1)}},K=async()=>{v(!0);try{let e=await fetch("/api/projects/generate-icon",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({projectId:n})});if(!e.ok){let t=await e.json();throw Error(t.error||"Failed to generate icon")}let t=await e.json(),s=await fetch("/api/projects/update-icon",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({projectId:n,iconUrl:t.iconUrl})});if(!s.ok){let e=await s.json();throw Error(e.error||"Failed to update icon")}g(t.iconUrl),p(t.iconUrl),m.Ay.success("App icon updated")}catch(e){console.error("Error generating icon:",e),m.Ay.error("Failed to generate icon")}finally{v(!1)}},X=async()=>{U(!0);try{let e=new FormData;if(e.append("projectId",n),e.append("expoAccessToken",G.expoAccessToken),e.append("expoProjectSlug",G.expoProjectSlug),e.append("expoProjectOwner",G.expoProjectOwner),e.append("expoProjectId",G.expoProjectId),e.append("appleKeyId",G.appleKeyId),e.append("appleTeamId",G.appleTeamId),e.append("appleIssuerId",G.appleIssuerId),e.append("appleAppId",G.appleAppId),e.append("appleBundleId",G.appleBundleId),G.appleP8File&&e.append("appleP8File",G.appleP8File),G.googleServiceAccount&&e.append("googleServiceAccount",G.googleServiceAccount),!(await fetch("/api/projects/mobile-publish-config",{method:"POST",body:e})).ok)throw Error("Failed to save configuration");return!0}catch(e){return console.error("Error saving configuration:",e),m.Ay.error("Failed to save configuration"),!1}finally{U(!1)}},$=async()=>{W(!0);try{if(!await X())return;if(!(await fetch("/api/projects/mobile-publish",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({projectId:n})})).ok)throw Error("Failed to publish app");m.Ay.success("App submitted to app stores! It can take several minutes to show in app store drafts.",{duration:6e3}),null==o||o(),s()}catch(e){console.error("Error publishing app:",e),m.Ay.error("Failed to start publishing process")}finally{W(!1)}};if(!t)return null;let Q=(e=>{switch(e){case"prerequisites":return c;case"app-icon":default:return!0;case"expo-token":return!!G.expoAccessToken;case"expo-create-project":return j;case"expo-project-info":return!!(G.expoProjectSlug&&G.expoProjectOwner&&G.expoProjectId);case"apple-create-key":return N;case"apple-p8":return!!G.appleP8File;case"apple-key-id":return!!G.appleKeyId;case"apple-team-id":return!!G.appleTeamId;case"apple-issuer-id":return!!G.appleIssuerId;case"apple-create-bundle-id":return C;case"apple-bundle-id":return!!G.appleBundleId;case"apple-create-app":return E;case"apple-app-id":return!!G.appleAppId;case"google-create-app":return T;case"google-create-service-account":return A;case"google-create-service-key":return P;case"google-service-account":return!!G.googleServiceAccount;case"google-add-service-account":return O}})(l),Z="review"===l;return(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,r.jsxs)("div",{className:"bg-white rounded-lg max-w-4xl w-full max-h-[90vh] overflow-y-auto border border-gray-200 shadow-xl",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center p-6 border-b border-gray-200",children:[(0,r.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"Submit to App Stores"}),"publishing"!==l&&(0,r.jsx)("button",{onClick:s,className:"text-gray-500 hover:text-gray-700",children:(0,r.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]}),"publishing"!==l&&(0,r.jsx)("div",{className:"px-6 py-4",children:(0,r.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,r.jsx)("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300 ease-out",style:{width:"".concat((x.indexOf(l)+1)/(x.length-1)*100,"%")}})})}),(0,r.jsx)("div",{className:"p-6",children:(()=>{let e=(e,t,s,a)=>(0,r.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)("h3",{className:"text-xl font-semibold text-gray-900",children:e}),(0,r.jsx)("p",{className:"text-gray-600",children:t}),s]}),(0,r.jsx)("div",{className:"flex items-center justify-center",children:a?(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("div",{className:"w-full h-64 rounded-lg overflow-hidden cursor-pointer hover:opacity-90 transition-opacity",children:(0,r.jsx)("img",{src:a,alt:e,className:"w-full h-full object-contain bg-white",onClick:()=>window.open(a,"_blank"),title:"Click to view full size"})}),(0,r.jsx)("p",{className:"text-center text-xs text-gray-500 cursor-pointer hover:text-gray-700 transition-colors",onClick:()=>window.open(a,"_blank"),children:"Click to view full size"})]}):(0,r.jsx)(r.Fragment,{})})]});switch(l){case"prerequisites":return(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Before We Start"}),(0,r.jsx)("p",{className:"text-gray-600 mb-6",children:"To submit your mobile app to the app stores, you'll need to complete this one-time setup process. Before starting, you'll need accounts with the following services:"})]}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,r.jsx)("div",{className:"bg-blue-600 text-white text-sm font-bold rounded-full w-6 h-6 flex items-center justify-center mt-0.5",children:"1"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"text-gray-900 font-medium",children:"Expo.dev Account (Free)"}),(0,r.jsx)("p",{className:"text-gray-600 text-sm",children:"Required for building and managing your React Native app"}),(0,r.jsx)("a",{href:"https://expo.dev/signup",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-700 text-sm",children:"Create account →"})]})]}),(0,r.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,r.jsx)("div",{className:"bg-blue-600 text-white text-sm font-bold rounded-full w-6 h-6 flex items-center justify-center mt-0.5",children:"2"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"text-gray-900 font-medium",children:"Google Cloud Account (Free)"}),(0,r.jsx)("p",{className:"text-gray-600 text-sm",children:"Needed for Google Play Store API access"}),(0,r.jsx)("a",{href:"https://cloud.google.com/",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-700 text-sm",children:"Create account →"})]})]}),(0,r.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,r.jsx)("div",{className:"bg-blue-600 text-white text-sm font-bold rounded-full w-6 h-6 flex items-center justify-center mt-0.5",children:"3"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"text-gray-900 font-medium",children:"Apple Developer Account ($99/year)"}),(0,r.jsx)("p",{className:"text-gray-600 text-sm",children:"Required to publish apps to the iOS App Store"}),(0,r.jsx)("a",{href:"https://developer.apple.com/programs/enroll/",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-700 text-sm",children:"Join program →"})]})]}),(0,r.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,r.jsx)("div",{className:"bg-blue-600 text-white text-sm font-bold rounded-full w-6 h-6 flex items-center justify-center mt-0.5",children:"4"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"text-gray-900 font-medium",children:"Google Play Console Account ($25 one-time)"}),(0,r.jsx)("p",{className:"text-gray-600 text-sm",children:"Required to publish apps to the Google Play Store"}),(0,r.jsx)("a",{href:"https://play.google.com/console/",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-700 text-sm",children:"Create account →"})]})]})]}),(0,r.jsx)("div",{className:"border-t border-gray-200 pt-6",children:(0,r.jsxs)("label",{className:"flex items-center space-x-3",children:[(0,r.jsx)("input",{type:"checkbox",checked:c,onChange:e=>d(e.target.checked),className:"w-4 h-4 text-blue-600 bg-white border-gray-300 rounded focus:ring-blue-500 focus:ring-2 accent-blue-600 light-checkbox",style:{backgroundColor:c?"#2563eb":"white",borderColor:"#d1d5db",borderWidth:"1px",borderStyle:"solid",colorScheme:"light",appearance:"none",backgroundImage:c?"url(\"data:image/svg+xml,%3csvg viewBox='0 0 16 16' fill='white' xmlns='http://www.w3.org/2000/svg'%3e%3cpath d='m13.854 3.646-7.5 7.5a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L6 10.293l7.146-7.147a.5.5 0 0 1 .708.708z'/%3e%3c/svg%3e\")":"none"}}),(0,r.jsx)("span",{className:"text-gray-900",children:"I have all 4 of these accounts"})]})})]});case"app-icon":return(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Update Your App Icon"}),(0,r.jsx)("p",{className:"text-gray-600 mb-6",children:"You can customize your app's icon that will appear on users' devices."})]}),(0,r.jsxs)("div",{className:"flex flex-col items-center space-y-6",children:[(0,r.jsxs)("div",{className:"space-y-4 text-center",children:[(0,r.jsx)("h4",{className:"text-lg font-medium text-gray-900",children:"App Icon"}),(0,r.jsx)("div",{className:"flex items-center justify-center w-32 h-32 bg-gray-100 rounded-lg cursor-pointer transition-colors",onClick:()=>{var e;return!f&&!b&&(null===(e=document.getElementById("icon-file-input"))||void 0===e?void 0:e.click())},onDragOver:e=>{e.preventDefault(),e.stopPropagation(),e.dataTransfer.dropEffect="copy"},onDragEnter:e=>{e.preventDefault(),e.stopPropagation()},onDrop:e=>{if(e.preventDefault(),e.stopPropagation(),e.dataTransfer.files&&e.dataTransfer.files.length>0){let t=e.dataTransfer.files[0];t.type.startsWith("image/")&&t.size<=5242880?["image/png","image/jpeg","image/jpg"].includes(t.type)?Y(t):m.Ay.error("Please upload a PNG or JPEG image"):m.Ay.error("File must be an image under 5MB")}},children:f||b?(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsxs)("svg",{className:"animate-spin w-8 h-8 text-blue-500 mx-auto mb-2",fill:"none",viewBox:"0 0 24 24",children:[(0,r.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,r.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),(0,r.jsx)("span",{className:"text-sm text-gray-600",children:b?"Generating...":"Uploading..."})]}):(0,r.jsx)(r.Fragment,{children:h||u?(0,r.jsx)("img",{src:h||u,alt:"App icon",className:"w-full h-full object-cover rounded-lg"}):(0,r.jsxs)("div",{className:"text-gray-400 text-center",children:[(0,r.jsx)("svg",{className:"w-12 h-12 mx-auto mb-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})}),(0,r.jsx)("span",{className:"text-sm",children:"Default Icon"})]})})})]}),(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsxs)("div",{className:"flex space-x-3 justify-center",children:[(0,r.jsx)("button",{type:"button",disabled:f||b,onClick:()=>{var e;return null===(e=document.getElementById("icon-file-input"))||void 0===e?void 0:e.click()},className:"bg-blue-600 hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed text-white font-medium rounded-md px-6 py-2 text-sm transition-colors",children:"Upload New Icon"}),(0,r.jsx)("button",{type:"button",disabled:f||b,onClick:K,className:"bg-purple-600 hover:bg-purple-700 disabled:opacity-50 disabled:cursor-not-allowed text-white font-medium rounded-md px-6 py-2 text-sm transition-colors flex items-center",children:b?(0,r.jsx)(r.Fragment,{children:"Generating..."}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M13 10V3L4 14h7v7l9-11h-7z"})}),"Generate Using AI"]})})]}),(0,r.jsx)("input",{id:"icon-file-input",type:"file",accept:"image/png,image/jpeg,image/jpg",className:"hidden",disabled:f,onChange:e=>{var t;let s=null===(t=e.target.files)||void 0===t?void 0:t[0];if(s){if(s.size>5242880){m.Ay.error("File size must be less than 5MB");return}if(!["image/png","image/jpeg","image/jpg"].includes(s.type)){m.Ay.error("Please upload a PNG or JPEG image");return}Y(s)}}})]})]}),(0,r.jsx)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:(0,r.jsxs)("div",{className:"flex items-start",children:[(0,r.jsx)("svg",{className:"w-5 h-5 text-blue-600 mt-0.5 mr-3 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,r.jsxs)("div",{className:"text-blue-800 text-sm",children:[(0,r.jsx)("p",{className:"font-medium mb-1",children:"Icon Guidelines:"}),(0,r.jsxs)("ul",{className:"list-disc list-inside space-y-1 text-blue-700",children:[(0,r.jsx)("li",{children:"Use a square image (1:1 aspect ratio)"}),(0,r.jsx)("li",{children:"Recommended size: 1024x1024 pixels, PNG or JPEG, max 5MB"}),(0,r.jsx)("li",{children:"Avoid text or fine details that may not be visible at small sizes"}),(0,r.jsx)("li",{children:"Use PNG format for best quality with transparency support"})]})]})]})})]});case"expo-token":return e("Get Your Expo Access Token","You'll need an access token from Expo to build your app. This allows us to create production builds of your React Native app.",(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Expo Access Token"}),(0,r.jsx)("input",{type:"password",value:G.expoAccessToken,onChange:e=>q("expoAccessToken",e.target.value),className:"w-full px-3 py-2 bg-white border border-gray-300 rounded-md text-gray-900 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"expo_xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx"}),(0,r.jsxs)("p",{className:"text-gray-600 text-xs mt-1",children:["Get this from ",(0,r.jsx)("a",{href:"https://expo.dev/accounts/[account]/settings/access-tokens",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-700",children:"Expo.dev → Settings → Access Tokens"})]})]}),"/mobilepublish/expo_access_token.png");case"expo-create-project":return e("Create Your Expo Project","Create a new project in your Expo dashboard. Follow these steps:",(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,r.jsx)("div",{className:"bg-blue-600 text-white text-sm font-bold rounded-full w-6 h-6 flex items-center justify-center mt-0.5 flex-shrink-0",children:"1"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"text-gray-900 font-medium",children:"Go to Expo Dashboard"}),(0,r.jsx)("p",{className:"text-gray-600 text-sm",children:'Visit your Expo dashboard and click "Create a project"'}),(0,r.jsx)("a",{href:"https://expo.dev/accounts/[accountid]/projects",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-700 text-sm",children:"Open Expo Dashboard →"})]})]}),(0,r.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,r.jsx)("div",{className:"bg-blue-600 text-white text-sm font-bold rounded-full w-6 h-6 flex items-center justify-center mt-0.5 flex-shrink-0",children:"2"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"text-gray-900 font-medium",children:"Name Your Project"}),(0,r.jsx)("p",{className:"text-gray-600 text-sm",children:"You can give it any name and slug you want. This will not be visible to users."})]})]}),(0,r.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,r.jsx)("div",{className:"bg-blue-600 text-white text-sm font-bold rounded-full w-6 h-6 flex items-center justify-center mt-0.5 flex-shrink-0",children:"3"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"text-gray-900 font-medium",children:"Create the Project"}),(0,r.jsx)("p",{className:"text-gray-600 text-sm",children:'Click "Create project" to finish the setup'})]})]})]}),(0,r.jsx)("div",{className:"border-t border-gray-200 pt-6",children:(0,r.jsxs)("label",{className:"flex items-center space-x-3",children:[(0,r.jsx)("input",{type:"checkbox",checked:j,onChange:e=>w(e.target.checked),className:"w-4 h-4 text-blue-600 bg-white border-gray-300 rounded focus:ring-blue-500 focus:ring-2 accent-blue-600 light-checkbox",style:{backgroundColor:j?"#2563eb":"white",borderColor:"#d1d5db",borderWidth:"1px",borderStyle:"solid",colorScheme:"light",appearance:"none",backgroundImage:j?"url(\"data:image/svg+xml,%3csvg viewBox='0 0 16 16' fill='white' xmlns='http://www.w3.org/2000/svg'%3e%3cpath d='m13.854 3.646-7.5 7.5a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L6 10.293l7.146-7.147a.5.5 0 0 1 .708.708z'/%3e%3c/svg%3e\")":"none"}}),(0,r.jsx)("span",{className:"text-gray-900",children:"I have created an Expo project"})]})})]}),"/mobilepublish/expo_create_project.png");case"expo-project-info":return e("Paste Your Expo Project Info","Now, copy these 3 values from your newly created Expo project overview page, and paste them here.",(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Project Slug"}),(0,r.jsx)("input",{type:"text",value:G.expoProjectSlug,onChange:e=>q("expoProjectSlug",e.target.value),className:"w-full px-3 py-2 bg-white border border-gray-300 rounded-md text-gray-900 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"johns-weather-app"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Project ID"}),(0,r.jsx)("input",{type:"text",value:G.expoProjectId,onChange:e=>q("expoProjectId",e.target.value),className:"w-full px-3 py-2 bg-white border border-gray-300 rounded-md text-gray-900 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"63b71db7-..."})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Project Owner"}),(0,r.jsx)("input",{type:"text",value:G.expoProjectOwner,onChange:e=>q("expoProjectOwner",e.target.value),className:"w-full px-3 py-2 bg-white border border-gray-300 rounded-md text-gray-900 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"john123"})]})]}),"/mobilepublish/expo_project_info.png");case"apple-create-key":return(0,r.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)("h3",{className:"text-xl font-semibold text-gray-900",children:"Create an Apple API Key"}),(0,r.jsx)("p",{className:"text-gray-600",children:"You'll need to create an API key in App Store Connect. Follow these steps:"}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,r.jsx)("div",{className:"bg-blue-600 text-white text-sm font-bold rounded-full w-6 h-6 flex items-center justify-center mt-0.5 flex-shrink-0",children:"1"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"text-gray-900 font-medium",children:"Go to App Store Connect"}),(0,r.jsx)("p",{className:"text-gray-600 text-sm",children:"Navigate to Users and Access → Integrations"}),(0,r.jsx)("a",{href:"https://appstoreconnect.apple.com/access/integrations/api",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-700 text-sm",children:"Open App Store Connect →"})]})]}),(0,r.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,r.jsx)("div",{className:"bg-blue-600 text-white text-sm font-bold rounded-full w-6 h-6 flex items-center justify-center mt-0.5 flex-shrink-0",children:"2"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"text-gray-900 font-medium",children:"Create New API Key"}),(0,r.jsx)("p",{className:"text-gray-600 text-sm",children:'Click the "+" button to create a new API key'})]})]}),(0,r.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,r.jsx)("div",{className:"bg-blue-600 text-white text-sm font-bold rounded-full w-6 h-6 flex items-center justify-center mt-0.5 flex-shrink-0",children:"3"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"text-gray-900 font-medium",children:"Configure the Key"}),(0,r.jsxs)("p",{className:"text-gray-600 text-sm",children:[(0,r.jsx)("strong",{children:"Name:"}),' You can type anything (e.g., "My App Publishing Key")',(0,r.jsx)("br",{}),(0,r.jsx)("strong",{children:"Access:"}),' You MUST select "App Manager"']})]})]}),(0,r.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,r.jsx)("div",{className:"bg-blue-600 text-white text-sm font-bold rounded-full w-6 h-6 flex items-center justify-center mt-0.5 flex-shrink-0",children:"4"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"text-gray-900 font-medium",children:"Generate"}),(0,r.jsx)("p",{className:"text-gray-600 text-sm",children:'Click "Generate", and you should see a new row get added, which has a Download link'})]})]})]}),(0,r.jsx)("div",{className:"border-t border-gray-200 pt-6",children:(0,r.jsxs)("label",{className:"flex items-center space-x-3",children:[(0,r.jsx)("div",{children:(0,r.jsx)("input",{type:"checkbox",checked:N,onChange:e=>k(e.target.checked),className:"w-4 h-4 text-blue-600 bg-white border-gray-300 rounded focus:ring-blue-500 focus:ring-2 accent-blue-600 light-checkbox",style:{backgroundColor:N?"#2563eb":"white",borderColor:"#d1d5db",borderWidth:"1px",borderStyle:"solid",colorScheme:"light",appearance:"none",backgroundImage:N?"url(\"data:image/svg+xml,%3csvg viewBox='0 0 16 16' fill='white' xmlns='http://www.w3.org/2000/svg'%3e%3cpath d='m13.854 3.646-7.5 7.5a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L6 10.293l7.146-7.147a.5.5 0 0 1 .708.708z'/%3e%3c/svg%3e\")":"none"}})}),(0,r.jsx)("span",{className:"text-gray-900",children:'I\'ve created an API key with "App Manager" access and downloaded it'})]})})]}),(0,r.jsxs)("div",{className:"flex flex-col items-center justify-start space-y-4",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("div",{className:"w-full h-48 rounded-lg overflow-hidden cursor-pointer hover:opacity-90 transition-opacity",children:(0,r.jsx)("img",{src:"/mobilepublish/apple_new_key.png",alt:"Create new Apple API key",className:"w-full h-full object-contain bg-white",onClick:()=>window.open("/mobilepublish/apple_new_key.png","_blank"),title:"Click to view full size"})}),(0,r.jsx)("p",{className:"text-center text-xs text-gray-500 cursor-pointer hover:text-gray-700 transition-colors",onClick:()=>window.open("/mobilepublish/apple_new_key.png","_blank"),children:"Click to view full size"})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("div",{className:"w-full h-48 rounded-lg overflow-hidden cursor-pointer hover:opacity-90 transition-opacity",children:(0,r.jsx)("img",{src:"/mobilepublish/apple_key_popup.png",alt:"Apple API key configuration popup",className:"w-full h-full object-contain bg-white",onClick:()=>window.open("/mobilepublish/apple_key_popup.png","_blank"),title:"Click to view full size"})}),(0,r.jsx)("p",{className:"text-center text-xs text-gray-500 cursor-pointer hover:text-gray-700 transition-colors",onClick:()=>window.open("/mobilepublish/apple_key_popup.png","_blank"),children:"Click to view full size"})]})]})]});case"apple-p8":return e("Upload Your Apple API Key File (.p8)","This key file allows us to authenticate with Apple's services to submit your app to the App Store.",(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Apple P8 Key File"}),(0,r.jsx)("input",{type:"file",accept:".p8",onChange:e=>{var t;return V("appleP8File",(null===(t=e.target.files)||void 0===t?void 0:t[0])||null)},className:"w-full px-3 py-2 bg-white border border-gray-300 rounded-md text-gray-900 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),"/mobilepublish/apple_download_key.png");case"apple-key-id":return e("Enter Your Apple Key ID","This is the ID of the P8 key you just uploaded. You can find this in the same row as the API key you just created.",(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Key ID"}),(0,r.jsx)("input",{type:"text",value:G.appleKeyId,onChange:e=>q("appleKeyId",e.target.value),className:"w-full px-3 py-2 bg-white border border-gray-300 rounded-md text-gray-900 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"ABC123DEFG"})]}),"/mobilepublish/apple_key_id.png");case"apple-team-id":return e("Enter Your Apple Team ID","This identifies your Apple Developer team. You'll need to find this in your Apple Developer account.",(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Team ID"}),(0,r.jsx)("input",{type:"text",value:G.appleTeamId,onChange:e=>q("appleTeamId",e.target.value),className:"w-full px-3 py-2 bg-white border border-gray-300 rounded-md text-gray-900 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"ABC123DEFG"}),(0,r.jsxs)("p",{className:"text-gray-600 text-xs mt-1",children:["Sign in to ",(0,r.jsx)("a",{href:"https://developer.apple.com/account",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-700",children:"developer.apple.com"}),' and scroll down to find your Team ID in the "Membership details" section']})]}),"/mobilepublish/apple_team_id.png");case"apple-issuer-id":return e("Enter Your Apple Issuer ID","This is the issuer ID for your App Store Connect API key. You can find this on the same page as the API key you just created.",(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Issuer ID"}),(0,r.jsx)("input",{type:"text",value:G.appleIssuerId,onChange:e=>q("appleIssuerId",e.target.value),className:"w-full px-3 py-2 bg-white border border-gray-300 rounded-md text-gray-900 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx"})]}),"/mobilepublish/apple_issuer_id.png");case"apple-create-bundle-id":return e("Create an App Bundle ID","Before creating your app, you need to create a Bundle ID in your Apple Developer account. Follow these steps:",(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,r.jsx)("div",{className:"bg-blue-600 text-white text-sm font-bold rounded-full w-6 h-6 flex items-center justify-center mt-0.5 flex-shrink-0",children:"1"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"text-gray-900 font-medium",children:"Go to Certificates, Identifiers & Profiles"}),(0,r.jsx)("p",{className:"text-gray-600 text-sm",children:"Navigate to the Apple Developer portal"}),(0,r.jsx)("a",{href:"https://developer.apple.com/account/resources/identifiers/list",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-700 text-sm",children:"Open Developer Portal →"})]})]}),(0,r.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,r.jsx)("div",{className:"bg-blue-600 text-white text-sm font-bold rounded-full w-6 h-6 flex items-center justify-center mt-0.5 flex-shrink-0",children:"2"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"text-gray-900 font-medium",children:"Create New Identifier"}),(0,r.jsx)("p",{className:"text-gray-600 text-sm",children:'Click the "+" button, choose "App IDs" and click Continue'})]})]}),(0,r.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,r.jsx)("div",{className:"bg-blue-600 text-white text-sm font-bold rounded-full w-6 h-6 flex items-center justify-center mt-0.5 flex-shrink-0",children:"3"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"text-gray-900 font-medium",children:"Choose App Type"}),(0,r.jsx)("p",{className:"text-gray-600 text-sm",children:'Choose "App" for the type and click Continue'})]})]}),(0,r.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,r.jsx)("div",{className:"bg-blue-600 text-white text-sm font-bold rounded-full w-6 h-6 flex items-center justify-center mt-0.5 flex-shrink-0",children:"4"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"text-gray-900 font-medium",children:"Configure Bundle ID"}),(0,r.jsxs)("p",{className:"text-gray-600 text-sm",children:[(0,r.jsx)("strong",{children:"Description:"})," Enter any app name (customers won't see it)",(0,r.jsx)("br",{}),(0,r.jsx)("strong",{children:"Bundle ID:"}),' Choose "Explicit" and enter a bundle ID that is unique, in this format: ',(0,r.jsx)("code",{className:"bg-gray-100 px-1 rounded",children:"com.domainname.appname"}),(0,r.jsx)("br",{}),"Click Continue, then Register"]})]})]})]}),(0,r.jsx)("div",{className:"border-t border-gray-200 pt-6",children:(0,r.jsxs)("label",{className:"flex items-center space-x-3",children:[(0,r.jsx)("input",{type:"checkbox",checked:C,onChange:e=>S(e.target.checked),className:"w-4 h-4 text-blue-600 bg-white border-gray-300 rounded focus:ring-blue-500 focus:ring-2 accent-blue-600 light-checkbox",style:{backgroundColor:C?"#2563eb":"white",borderColor:"#d1d5db",borderWidth:"1px",borderStyle:"solid",colorScheme:"light",appearance:"none",backgroundImage:C?"url(\"data:image/svg+xml,%3csvg viewBox='0 0 16 16' fill='white' xmlns='http://www.w3.org/2000/svg'%3e%3cpath d='m13.854 3.646-7.5 7.5a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L6 10.293l7.146-7.147a.5.5 0 0 1 .708.708z'/%3e%3c/svg%3e\")":"none"}}),(0,r.jsx)("span",{className:"text-gray-900",children:"I've created a Bundle ID"})]})})]}),"/mobilepublish/apple_bundle_id.png");case"apple-bundle-id":return e("Enter Your App Bundle ID","This is the bundle identifier that you just created.",(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Bundle ID"}),(0,r.jsx)("input",{type:"text",value:G.appleBundleId,onChange:e=>q("appleBundleId",e.target.value),className:"w-full px-3 py-2 bg-white border border-gray-300 rounded-md text-gray-900 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"com.domainname.appname"})]}),"/mobilepublish/apple_copy_bundle_id.png");case"apple-create-app":return e("Create an App in App Store Connect","Now you need to create a new app in App Store Connect using the Bundle ID you just created. Follow these steps:",(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,r.jsx)("div",{className:"bg-blue-600 text-white text-sm font-bold rounded-full w-6 h-6 flex items-center justify-center mt-0.5 flex-shrink-0",children:"1"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"text-gray-900 font-medium",children:"Go to App Store Connect"}),(0,r.jsx)("p",{className:"text-gray-600 text-sm",children:"Navigate to the Apps section"}),(0,r.jsx)("a",{href:"https://appstoreconnect.apple.com/apps",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-700 text-sm",children:"Open App Store Connect →"})]})]}),(0,r.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,r.jsx)("div",{className:"bg-blue-600 text-white text-sm font-bold rounded-full w-6 h-6 flex items-center justify-center mt-0.5 flex-shrink-0",children:"2"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"text-gray-900 font-medium",children:"Create New App"}),(0,r.jsx)("p",{className:"text-gray-600 text-sm",children:'Click the "+" button, then select "New App"'})]})]}),(0,r.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,r.jsx)("div",{className:"bg-blue-600 text-white text-sm font-bold rounded-full w-6 h-6 flex items-center justify-center mt-0.5 flex-shrink-0",children:"3"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"text-gray-900 font-medium",children:"Configure App Details"}),(0,r.jsxs)("p",{className:"text-gray-600 text-sm",children:[(0,r.jsx)("strong",{children:"Platform:"}),' Choose "iOS"',(0,r.jsx)("br",{}),(0,r.jsx)("strong",{children:"Name:"})," Enter your app name",(0,r.jsx)("br",{}),(0,r.jsx)("strong",{children:"Primary Language:"})," Choose your preferred language",(0,r.jsx)("br",{}),(0,r.jsx)("strong",{children:"Bundle ID:"})," Select the Bundle ID you just created",(0,r.jsx)("br",{}),(0,r.jsx)("strong",{children:"SKU:"}),' Enter a unique identifier (e.g., "ComDomainNameAppName")']})]})]}),(0,r.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,r.jsx)("div",{className:"bg-blue-600 text-white text-sm font-bold rounded-full w-6 h-6 flex items-center justify-center mt-0.5 flex-shrink-0",children:"4"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"text-gray-900 font-medium",children:"Create App"}),(0,r.jsx)("p",{className:"text-gray-600 text-sm",children:'Click "Create" to finish setting up your app'})]})]})]}),(0,r.jsx)("div",{className:"border-t border-gray-200 pt-6",children:(0,r.jsxs)("label",{className:"flex items-center space-x-3",children:[(0,r.jsx)("input",{type:"checkbox",checked:E,onChange:e=>D(e.target.checked),className:"w-4 h-4 text-blue-600 bg-white border-gray-300 rounded focus:ring-blue-500 focus:ring-2 accent-blue-600 light-checkbox",style:{backgroundColor:E?"#2563eb":"white",borderColor:"#d1d5db",borderWidth:"1px",borderStyle:"solid",colorScheme:"light",appearance:"none",backgroundImage:E?"url(\"data:image/svg+xml,%3csvg viewBox='0 0 16 16' fill='white' xmlns='http://www.w3.org/2000/svg'%3e%3cpath d='m13.854 3.646-7.5 7.5a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L6 10.293l7.146-7.147a.5.5 0 0 1 .708.708z'/%3e%3c/svg%3e\")":"none"}}),(0,r.jsx)("span",{className:"text-gray-900",children:"I've created an app in App Store Connect"})]})})]}),"/mobilepublish/apple_new_app.png");case"apple-app-id":return e("Enter Your Apple App ID","This is the unique identifier for your app in the App Store. You can find this in the app you just created.",(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"App ID"}),(0,r.jsx)("input",{type:"text",value:G.appleAppId,onChange:e=>q("appleAppId",e.target.value),className:"w-full px-3 py-2 bg-white border border-gray-300 rounded-md text-gray-900 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"1234567890"}),(0,r.jsx)("p",{className:"text-gray-600 text-xs mt-1",children:'In App Store Connect, click on the app you just created, then click the "App Information" tab, and scroll down to find the "Apple ID" value'})]}),"/mobilepublish/apple_app_id.png");case"google-create-app":return e("Create a New App in Google Play Console","Now you need to create a new app in Google Play Console. Follow these steps:",(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,r.jsx)("div",{className:"bg-blue-600 text-white text-sm font-bold rounded-full w-6 h-6 flex items-center justify-center mt-0.5 flex-shrink-0",children:"1"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"text-gray-900 font-medium",children:"Go to Google Play Console"}),(0,r.jsx)("p",{className:"text-gray-600 text-sm",children:"Navigate to the Google Play Console"}),(0,r.jsx)("a",{href:"https://play.google.com/console/",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-700 text-sm",children:"Open Google Play Console →"})]})]}),(0,r.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,r.jsx)("div",{className:"bg-blue-600 text-white text-sm font-bold rounded-full w-6 h-6 flex items-center justify-center mt-0.5 flex-shrink-0",children:"2"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"text-gray-900 font-medium",children:"Create App"}),(0,r.jsx)("p",{className:"text-gray-600 text-sm",children:'Click "Create app" and fill in the required details'})]})]}),(0,r.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,r.jsx)("div",{className:"bg-blue-600 text-white text-sm font-bold rounded-full w-6 h-6 flex items-center justify-center mt-0.5 flex-shrink-0",children:"3"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"text-gray-900 font-medium",children:"Configure App Details"}),(0,r.jsxs)("p",{className:"text-gray-600 text-sm",children:[(0,r.jsx)("strong",{children:"App name:"})," Enter your app name",(0,r.jsx)("br",{}),(0,r.jsx)("strong",{children:"Default language:"})," Choose your preferred language",(0,r.jsx)("br",{}),(0,r.jsx)("strong",{children:"App or game:"}),' Choose "App"',(0,r.jsx)("br",{}),(0,r.jsx)("strong",{children:"Free or paid:"})," Choose based on your preference"]})]})]}),(0,r.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,r.jsx)("div",{className:"bg-blue-600 text-white text-sm font-bold rounded-full w-6 h-6 flex items-center justify-center mt-0.5 flex-shrink-0",children:"4"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"text-gray-900 font-medium",children:"Create App"}),(0,r.jsx)("p",{className:"text-gray-600 text-sm",children:'Accept the declarations and click "Create app" to finish the setup'})]})]})]}),(0,r.jsx)("div",{className:"border-t border-gray-200 pt-6",children:(0,r.jsxs)("label",{className:"flex items-center space-x-3",children:[(0,r.jsx)("input",{type:"checkbox",checked:T,onChange:e=>I(e.target.checked),className:"w-4 h-4 text-blue-600 bg-white border-gray-300 rounded focus:ring-blue-500 focus:ring-2 accent-blue-600 light-checkbox",style:{backgroundColor:T?"#2563eb":"white",borderColor:"#d1d5db",borderWidth:"1px",borderStyle:"solid",colorScheme:"light",appearance:"none",backgroundImage:T?"url(\"data:image/svg+xml,%3csvg viewBox='0 0 16 16' fill='white' xmlns='http://www.w3.org/2000/svg'%3e%3cpath d='m13.854 3.646-7.5 7.5a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L6 10.293l7.146-7.147a.5.5 0 0 1 .708.708z'/%3e%3c/svg%3e\")":"none"}}),(0,r.jsx)("span",{className:"text-gray-900",children:"I've created an app in Google Play Console"})]})})]}),"/mobilepublish/google_create_app.png");case"google-create-service-account":return e("Create a Service Account in Google Cloud","You need to create a service account in Google Cloud Console to access the Google Play API. Follow these steps:",(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,r.jsx)("div",{className:"bg-blue-600 text-white text-sm font-bold rounded-full w-6 h-6 flex items-center justify-center mt-0.5 flex-shrink-0",children:"1"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"text-gray-900 font-medium",children:"Go to Google Cloud Console"}),(0,r.jsx)("p",{className:"text-gray-600 text-sm",children:"Navigate to IAM & Admin → Service Accounts"}),(0,r.jsx)("a",{href:"https://console.cloud.google.com/iam-admin/serviceaccounts",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-700 text-sm",children:"Open Google Cloud Console →"})]})]}),(0,r.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,r.jsx)("div",{className:"bg-blue-600 text-white text-sm font-bold rounded-full w-6 h-6 flex items-center justify-center mt-0.5 flex-shrink-0",children:"2"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"text-gray-900 font-medium",children:"Create Service Account"}),(0,r.jsx)("p",{className:"text-gray-600 text-sm",children:'Click "Create Service Account"'})]})]}),(0,r.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,r.jsx)("div",{className:"bg-blue-600 text-white text-sm font-bold rounded-full w-6 h-6 flex items-center justify-center mt-0.5 flex-shrink-0",children:"3"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"text-gray-900 font-medium",children:"Configure Service Account"}),(0,r.jsxs)("p",{className:"text-gray-600 text-sm",children:[(0,r.jsx)("strong",{children:"Service account name:"})," Enter a descriptive name",(0,r.jsx)("br",{}),(0,r.jsx)("strong",{children:"Service account ID:"})," Will be auto-generated",(0,r.jsx)("br",{}),(0,r.jsx)("strong",{children:"Description:"})," Optional description"]})]})]}),(0,r.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,r.jsx)("div",{className:"bg-blue-600 text-white text-sm font-bold rounded-full w-6 h-6 flex items-center justify-center mt-0.5 flex-shrink-0",children:"4"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"text-gray-900 font-medium",children:"Create Account"}),(0,r.jsx)("p",{className:"text-gray-600 text-sm",children:'Click "Create and Continue" (skip the optional steps)'})]})]})]}),(0,r.jsx)("div",{className:"border-t border-gray-200 pt-6",children:(0,r.jsxs)("label",{className:"flex items-center space-x-3",children:[(0,r.jsx)("input",{type:"checkbox",checked:A,onChange:e=>L(e.target.checked),className:"w-4 h-4 text-blue-600 bg-white border-gray-300 rounded focus:ring-blue-500 focus:ring-2 accent-blue-600 light-checkbox",style:{backgroundColor:A?"#2563eb":"white",borderColor:"#d1d5db",borderWidth:"1px",borderStyle:"solid",colorScheme:"light",appearance:"none",backgroundImage:A?"url(\"data:image/svg+xml,%3csvg viewBox='0 0 16 16' fill='white' xmlns='http://www.w3.org/2000/svg'%3e%3cpath d='m13.854 3.646-7.5 7.5a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L6 10.293l7.146-7.147a.5.5 0 0 1 .708.708z'/%3e%3c/svg%3e\")":"none"}}),(0,r.jsx)("span",{className:"text-gray-900",children:"I've created a service account in Google Cloud"})]})})]}),"/mobilepublish/google_create_service_account.png");case"google-create-service-key":return e("Create a Key for the Service Account","Now you need to create a JSON key for the service account you just created. Follow these steps:",(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,r.jsx)("div",{className:"bg-blue-600 text-white text-sm font-bold rounded-full w-6 h-6 flex items-center justify-center mt-0.5 flex-shrink-0",children:"1"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"text-gray-900 font-medium",children:"Click On Your Service Account"}),(0,r.jsx)("p",{className:"text-gray-600 text-sm",children:"In the service accounts list, click on the service account you just created"})]})]}),(0,r.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,r.jsx)("div",{className:"bg-blue-600 text-white text-sm font-bold rounded-full w-6 h-6 flex items-center justify-center mt-0.5 flex-shrink-0",children:"2"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"text-gray-900 font-medium",children:"Go to Keys Tab"}),(0,r.jsx)("p",{className:"text-gray-600 text-sm",children:'Click on the "Keys" tab'})]})]}),(0,r.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,r.jsx)("div",{className:"bg-blue-600 text-white text-sm font-bold rounded-full w-6 h-6 flex items-center justify-center mt-0.5 flex-shrink-0",children:"3"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"text-gray-900 font-medium",children:"Add Key"}),(0,r.jsx)("p",{className:"text-gray-600 text-sm",children:'Click "Add Key" → "Create new key"'})]})]}),(0,r.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,r.jsx)("div",{className:"bg-blue-600 text-white text-sm font-bold rounded-full w-6 h-6 flex items-center justify-center mt-0.5 flex-shrink-0",children:"4"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"text-gray-900 font-medium",children:"Download JSON Key"}),(0,r.jsx)("p",{className:"text-gray-600 text-sm",children:'Choose "JSON" as the key type and click "Create". The JSON file will download automatically.'})]})]})]}),(0,r.jsx)("div",{className:"border-t border-gray-200 pt-6",children:(0,r.jsxs)("label",{className:"flex items-center space-x-3",children:[(0,r.jsx)("input",{type:"checkbox",checked:P,onChange:e=>M(e.target.checked),className:"w-4 h-4 text-blue-600 bg-white border-gray-300 rounded focus:ring-blue-500 focus:ring-2 accent-blue-600 light-checkbox",style:{backgroundColor:P?"#2563eb":"white",borderColor:"#d1d5db",borderWidth:"1px",borderStyle:"solid",colorScheme:"light",appearance:"none",backgroundImage:P?"url(\"data:image/svg+xml,%3csvg viewBox='0 0 16 16' fill='white' xmlns='http://www.w3.org/2000/svg'%3e%3cpath d='m13.854 3.646-7.5 7.5a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L6 10.293l7.146-7.147a.5.5 0 0 1 .708.708z'/%3e%3c/svg%3e\")":"none"}}),(0,r.jsx)("span",{className:"text-gray-900",children:"I've created and downloaded the JSON key"})]})})]}),"/mobilepublish/google_create_service_key.png");case"google-service-account":return e("Upload Your Google Service Account JSON","Upload the JSON file you just downloaded. This file allows us to authenticate with Google Play Console to submit your Android app.",(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Google Service Account JSON"}),(0,r.jsx)("input",{type:"file",accept:".json",onChange:e=>{var t;return V("googleServiceAccount",(null===(t=e.target.files)||void 0===t?void 0:t[0])||null)},className:"w-full px-3 py-2 bg-white border border-gray-300 rounded-md text-gray-900 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}));case"google-add-service-account":return e("Add Service Account to Google Play","Now you need to add the service account to your Google Play Console app with the proper permissions.",(0,r.jsxs)("div",{className:"space-y-6",children:[G.googleServiceAccount&&(0,r.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[(0,r.jsx)("h4",{className:"text-blue-900 font-medium mb-2",children:"Service Account Email"}),B?(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("p",{className:"text-blue-800 text-sm font-mono break-all bg-white px-3 py-2 rounded border flex-1",children:B}),(0,r.jsxs)("button",{onClick:()=>{navigator.clipboard.writeText(B),m.Ay.success("Email copied to clipboard!")},className:"bg-blue-600 hover:bg-blue-700 text-white px-3 py-2 rounded text-sm font-medium transition-colors flex items-center space-x-1",title:"Copy to clipboard",children:[(0,r.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})}),(0,r.jsx)("span",{children:"Copy"})]})]}),(0,r.jsx)("p",{className:"text-blue-700 text-xs mt-1",children:"Copy this email address for the next steps"})]}):(0,r.jsx)("p",{className:"text-blue-800 text-sm",children:'Reading email from JSON file... If this doesn\'t appear, you can open the JSON file in a text editor to find the "client_email" field.'})]}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,r.jsx)("div",{className:"bg-blue-600 text-white text-sm font-bold rounded-full w-6 h-6 flex items-center justify-center mt-0.5 flex-shrink-0",children:"1"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"text-gray-900 font-medium",children:"Go to Google Play Console"}),(0,r.jsx)("p",{className:"text-gray-600 text-sm",children:"Navigate to your app in Google Play Console"}),(0,r.jsx)("a",{href:"https://play.google.com/console/",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-700 text-sm",children:"Open Google Play Console →"})]})]}),(0,r.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,r.jsx)("div",{className:"bg-blue-600 text-white text-sm font-bold rounded-full w-6 h-6 flex items-center justify-center mt-0.5 flex-shrink-0",children:"2"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"text-gray-900 font-medium",children:"Go to Users and Permissions"}),(0,r.jsx)("p",{className:"text-gray-600 text-sm",children:'In the left sidebar, click "Users and permissions"'})]})]}),(0,r.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,r.jsx)("div",{className:"bg-blue-600 text-white text-sm font-bold rounded-full w-6 h-6 flex items-center justify-center mt-0.5 flex-shrink-0",children:"3"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"text-gray-900 font-medium",children:"Invite New User"}),(0,r.jsx)("p",{className:"text-gray-600 text-sm",children:'Click "Invite new users" and paste the service account email above'})]})]}),(0,r.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,r.jsx)("div",{className:"bg-blue-600 text-white text-sm font-bold rounded-full w-6 h-6 flex items-center justify-center mt-0.5 flex-shrink-0",children:"4"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"text-gray-900 font-medium",children:"Set App Permissions"}),(0,r.jsx)("p",{className:"text-gray-600 text-sm",children:'Under "App permissions", select your app and choose "Admin (all permissions)" for that app'})]})]}),(0,r.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,r.jsx)("div",{className:"bg-blue-600 text-white text-sm font-bold rounded-full w-6 h-6 flex items-center justify-center mt-0.5 flex-shrink-0",children:"5"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"text-gray-900 font-medium",children:"Send Invitation"}),(0,r.jsx)("p",{className:"text-gray-600 text-sm",children:'Click "Send invitation" to complete the setup'})]})]})]}),!G.googleServiceAccount&&(0,r.jsx)("div",{className:"text-gray-600 text-sm",children:"Please upload your Google Service Account JSON file in the previous step first."}),(0,r.jsx)("div",{className:"border-t border-gray-200 pt-6",children:(0,r.jsxs)("label",{className:"flex items-center space-x-3",children:[(0,r.jsx)("div",{children:(0,r.jsx)("input",{type:"checkbox",checked:O,onChange:e=>_(e.target.checked),className:"w-4 h-4 text-blue-600 bg-white border-gray-300 rounded focus:ring-blue-500 focus:ring-2 accent-blue-600 light-checkbox",style:{backgroundColor:O?"#2563eb":"white",borderColor:"#d1d5db",borderWidth:"1px",borderStyle:"solid",colorScheme:"light",appearance:"none",backgroundImage:O?"url(\"data:image/svg+xml,%3csvg viewBox='0 0 16 16' fill='white' xmlns='http://www.w3.org/2000/svg'%3e%3cpath d='m13.854 3.646-7.5 7.5a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L6 10.293l7.146-7.147a.5.5 0 0 1 .708.708z'/%3e%3c/svg%3e\")":"none"}})}),(0,r.jsx)("span",{className:"text-gray-900",children:"I've invited the above service account email to Google Play Console, giving it admin permissions for my app"})]})})]}),"/mobilepublish/google_add_service_account.png");case"review":return(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Review Configuration"}),(0,r.jsx)("p",{className:"text-gray-600 mb-6",children:"Please review your configuration before publishing."})]}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4 border border-gray-200",children:[(0,r.jsx)("h4",{className:"text-gray-900 font-medium mb-2",children:"Expo"}),(0,r.jsxs)("p",{className:"text-gray-700 text-sm",children:["Owner: ",G.expoProjectOwner]}),(0,r.jsxs)("p",{className:"text-gray-700 text-sm",children:["Slug: ",G.expoProjectSlug]}),(0,r.jsxs)("p",{className:"text-gray-700 text-sm",children:["Project ID: ",G.expoProjectId]}),(0,r.jsxs)("p",{className:"text-gray-700 text-sm",children:["Token: ",G.expoAccessToken?"••••••••":"Not set"]})]}),(0,r.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4 border border-gray-200",children:[(0,r.jsx)("h4",{className:"text-gray-900 font-medium mb-2",children:"Apple App Store"}),(0,r.jsxs)("p",{className:"text-gray-700 text-sm",children:["Bundle ID: ",G.appleBundleId]}),(0,r.jsxs)("p",{className:"text-gray-700 text-sm",children:["App ID: ",G.appleAppId]}),(0,r.jsxs)("p",{className:"text-gray-700 text-sm",children:["P8 File: ",G.appleP8File?G.appleP8File.name:"Not uploaded"]})]}),(0,r.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4 border border-gray-200",children:[(0,r.jsx)("h4",{className:"text-gray-900 font-medium mb-2",children:"Google Play Store"}),(0,r.jsx)("p",{className:"text-gray-700 text-sm",children:"Bundle ID: Uses Apple Bundle ID"}),(0,r.jsxs)("p",{className:"text-gray-700 text-sm",children:["Service Account: ",G.googleServiceAccount?G.googleServiceAccount.name:"Not uploaded"]}),(0,r.jsx)("p",{className:"text-gray-700 text-sm",children:"Keystore: Auto-generated"})]})]})]});case"publishing":return(0,r.jsxs)("div",{className:"space-y-6 text-center",children:[(0,r.jsx)("div",{className:"flex justify-center",children:(0,r.jsxs)("svg",{className:"animate-spin h-12 w-12 text-blue-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,r.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,r.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Publishing Your App"}),(0,r.jsx)("p",{className:"text-gray-600",children:"Your app is being prepared for submission to the app stores. This process can take several hours. You'll receive email updates on the progress."})]})]});default:return null}})()}),"publishing"!==l&&(0,r.jsxs)("div",{className:"flex justify-between items-center p-6 border-t border-gray-200",children:[(0,r.jsx)("button",{onClick:()=>{let e=x.indexOf(l);e>0&&i(x[e-1])},disabled:"prerequisites"===l,className:"px-4 py-2 text-gray-600 hover:text-gray-900 disabled:opacity-50 disabled:cursor-not-allowed",children:"Back"}),(0,r.jsx)("div",{className:"flex space-x-3",children:Z?(0,r.jsx)("button",{onClick:$,disabled:!Q||z||F,className:"bg-blue-600 text-white font-medium rounded-md px-6 py-2 text-sm transition-colors disabled:opacity-70 disabled:cursor-not-allowed",children:z||F?(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsxs)("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,r.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,r.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Publishing..."]}):"Submit to App Stores"}):(0,r.jsx)("button",{onClick:()=>{let e=x.indexOf(l);e<x.length-1&&i(x[e+1])},disabled:!Q,className:"bg-blue-600 text-white font-medium rounded-md px-6 py-2 text-sm transition-colors disabled:opacity-70 disabled:cursor-not-allowed",children:"Next"})})]})]})})}function h(e){let{isOpen:t,onClose:s}=e,[n,o]=(0,a.useState)(!1),l=()=>{o(!1),s()};return t?(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,r.jsxs)("div",{className:"bg-white rounded-lg max-w-4xl w-full max-h-[90vh] overflow-y-auto border border-gray-200 shadow-xl",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center p-6 border-b border-gray-200",children:[(0,r.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"Important: First Upload Required"}),(0,r.jsx)("button",{onClick:l,className:"text-gray-500 hover:text-gray-700",children:(0,r.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]}),(0,r.jsx)("div",{className:"p-6",children:(0,r.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Manual Upload Required"}),(0,r.jsxs)("p",{className:"text-gray-600 mb-4",children:["Your app has been submitted for building, but the ",(0,r.jsx)("strong",{children:"first submission to Google Play Store will fail"}),". This is normal and expected."]}),(0,r.jsx)("p",{className:"text-gray-600 mb-6",children:"Google Play requires the first upload to be done manually through their console. Here's what you need to do:"})]}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,r.jsx)("div",{className:"bg-blue-600 text-white text-sm font-bold rounded-full w-6 h-6 flex items-center justify-center mt-0.5 flex-shrink-0",children:"1"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"text-gray-900 font-medium",children:"Wait for Build Completion"}),(0,r.jsx)("p",{className:"text-gray-600 text-sm",children:"Wait for the build to complete in your Expo dashboard (usually 10-20 minutes)"})]})]}),(0,r.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,r.jsx)("div",{className:"bg-blue-600 text-white text-sm font-bold rounded-full w-6 h-6 flex items-center justify-center mt-0.5 flex-shrink-0",children:"2"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"text-gray-900 font-medium",children:"Download the .aab File"}),(0,r.jsx)("p",{className:"text-gray-600 text-sm",children:"Go to your Expo dashboard, find the completed build, and download the Android .aab file"})]})]}),(0,r.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,r.jsx)("div",{className:"bg-blue-600 text-white text-sm font-bold rounded-full w-6 h-6 flex items-center justify-center mt-0.5 flex-shrink-0",children:"3"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"text-gray-900 font-medium",children:"Upload to Google Play Console"}),(0,r.jsx)("p",{className:"text-gray-600 text-sm",children:"In Google Play Console, go to your app → Testing → Internal testing → Create new release, and upload the .aab file"})]})]}),(0,r.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,r.jsx)("div",{className:"bg-blue-600 text-white text-sm font-bold rounded-full w-6 h-6 flex items-center justify-center mt-0.5 flex-shrink-0",children:"4"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"text-gray-900 font-medium",children:"Future Uploads Will Be Automatic"}),(0,r.jsx)("p",{className:"text-gray-600 text-sm",children:"After this first manual upload, all future submissions will work automatically through our system"})]})]})]})]}),(0,r.jsx)("div",{className:"space-y-6",children:(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"text-lg font-medium text-gray-900 mb-4",children:"Step-by-Step Screenshots"}),(0,r.jsxs)("div",{className:"space-y-2 mb-6",children:[(0,r.jsx)("h5",{className:"text-md font-medium text-gray-800",children:"Download from Expo Dashboard"}),(0,r.jsx)("div",{className:"w-full h-48 rounded-lg overflow-hidden cursor-pointer hover:opacity-90 transition-opacity",children:(0,r.jsx)("img",{src:"/mobilepublish/expo_download_build.png",alt:"Download build from Expo dashboard",className:"w-full h-full object-contain bg-white border border-gray-200",onClick:()=>window.open("/mobilepublish/expo_download_build.png","_blank"),title:"Click to view full size"})}),(0,r.jsx)("p",{className:"text-center text-xs text-gray-500 cursor-pointer hover:text-gray-700 transition-colors",onClick:()=>window.open("/mobilepublish/expo_download_build.png","_blank"),children:"Click to view full size"})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("h5",{className:"text-md font-medium text-gray-800",children:"Upload to Google Play Console"}),(0,r.jsx)("div",{className:"w-full h-48 rounded-lg overflow-hidden cursor-pointer hover:opacity-90 transition-opacity",children:(0,r.jsx)("img",{src:"/mobilepublish/google_upload_build.png",alt:"Upload build to Google Play Console",className:"w-full h-full object-contain bg-white border border-gray-200",onClick:()=>window.open("/mobilepublish/google_upload_build.png","_blank"),title:"Click to view full size"})}),(0,r.jsx)("p",{className:"text-center text-xs text-gray-500 cursor-pointer hover:text-gray-700 transition-colors",onClick:()=>window.open("/mobilepublish/google_upload_build.png","_blank"),children:"Click to view full size"})]})]})})]})}),(0,r.jsxs)("div",{className:"flex justify-between items-center p-6 border-t border-gray-200",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,r.jsx)("input",{type:"checkbox",id:"acknowledge-checkbox",checked:n,onChange:e=>o(e.target.checked),className:"w-4 h-4 text-blue-600 bg-white border-gray-300 rounded focus:ring-blue-500 focus:ring-2 accent-blue-600",style:{backgroundColor:n?"#2563eb":"white",borderColor:"#d1d5db",borderWidth:"1px",borderStyle:"solid",colorScheme:"light",appearance:"none",backgroundImage:n?"url(\"data:image/svg+xml,%3csvg viewBox='0 0 16 16' fill='white' xmlns='http://www.w3.org/2000/svg'%3e%3cpath d='m13.854 3.646-7.5 7.5a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L6 10.293l7.146-7.147a.5.5 0 0 1 .708.708z'/%3e%3c/svg%3e\")":"none"}}),(0,r.jsx)("label",{htmlFor:"acknowledge-checkbox",className:"text-gray-900 cursor-pointer",children:"Ok, I understand and will do this manual upload"})]}),(0,r.jsx)("button",{onClick:l,disabled:!n,className:"bg-blue-600 hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed text-white font-medium rounded-md px-6 py-2 text-sm transition-colors",children:"Close"})]})]})}):null}function g(e){let{isOpen:t,onClose:s,projectExpoPreviewProjectId:n,isMobile:o,projectStatus:l,projectId:i,onGeneratePreview:c}=e,[d,u]=(0,a.useState)(!1);(0,a.useEffect)(()=>{d&&n&&(u(!1),m.Ay.success("App preview is ready!",{duration:3e3}))},[d,n]);let x=async()=>{if(i){u(!0);try{let e=await fetch("/api/projects/mobile-preview",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({projectId:i})});if(429===e.status){let t=(await e.json()).message||"Rate limit exceeded. Please try again later.";throw Error(t)}if(!e.ok)throw Error("Failed to generate app preview");c&&await c()}catch(e){console.error("Preview generation error:",e),m.Ay.error(e.message||"Failed to start preview generation"),u(!1)}}};return t?(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50",children:(0,r.jsxs)("div",{className:"bg-gray-900 rounded-lg max-w-md w-full p-6 border border-gray-800",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,r.jsx)("h3",{className:"text-xl text-white font-semibold",children:"Preview on Device"}),(0,r.jsx)("button",{onClick:s,className:"text-gray-400 hover:text-white",children:(0,r.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]}),(0,r.jsxs)("div",{className:"mb-6",children:[(0,r.jsxs)("div",{className:"flex items-center mb-2",children:[(0,r.jsx)("div",{className:"bg-blue-600 text-white text-xs font-bold rounded-full w-5 h-5 flex items-center justify-center mr-2",children:"1"}),(0,r.jsx)("h4",{className:"text-white font-medium",children:"Get the Expo Go app"})]}),(0,r.jsx)("p",{className:"text-gray-300 text-sm mb-3 pl-7",children:"Download Expo Go on your mobile device."}),(0,r.jsxs)("div",{className:"flex space-x-3 justify-center pl-7",children:[(0,r.jsx)("a",{href:"https://apps.apple.com/app/apple-store/id982107779",target:"_blank",rel:"noopener noreferrer",className:"inline-block",children:(0,r.jsx)("div",{className:"h-[40px] flex items-center",children:(0,r.jsx)("img",{src:"/apple_app_store.svg",alt:"Download on the App Store",className:"h-full"})})}),(0,r.jsx)("a",{href:"https://play.google.com/store/apps/details?id=host.exp.exponent",target:"_blank",rel:"noopener noreferrer",className:"inline-block",children:(0,r.jsx)("div",{className:"relative -top-0 h-[40px] w-36 flex items-center justify-center",children:(0,r.jsx)("img",{src:"/google_play_store.svg",alt:"Get it on Google Play",className:"w-32"})})})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"flex items-center mb-2",children:[(0,r.jsx)("div",{className:"bg-blue-600 text-white text-xs font-bold rounded-full w-5 h-5 flex items-center justify-center mr-2",children:"2"}),(0,r.jsx)("h4",{className:"text-white font-medium",children:n?o?"Open the preview":"Scan the QR code":"Generate App Preview"})]}),n?o?(0,r.jsxs)("div",{className:"pl-7",children:[(0,r.jsx)("p",{className:"text-gray-300 text-sm mb-3",children:"Once you have Expo Go installed, tap the button below to open the preview. This preview will remain active for 6 hours."}),(0,r.jsx)("div",{className:"flex justify-center",children:(0,r.jsxs)("a",{href:"exp://u.expo.dev/".concat(n,"?runtime-version=exposdk%3A54.0.0&channel-name=preview"),className:"bg-blue-600 text-white font-medium rounded-md px-6 py-3 text-sm transition-colors hover:bg-blue-700 flex items-center",children:[(0,r.jsxs)("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]}),"Open in Expo Go"]})})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("p",{className:"text-gray-300 text-sm mb-3 pl-7",children:"Scan this QR code with your device's camera. This QR code will remain active for 6 hours."}),(0,r.jsx)("div",{className:"flex flex-col items-center justify-center bg-white p-4 rounded-lg",children:(0,r.jsx)("img",{src:"https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=".concat(encodeURIComponent("exp://u.expo.dev/".concat(n,"?runtime-version=exposdk%3A54.0.0&channel-name=preview"))),alt:"QR Code for Expo Preview",width:200,height:200})})]}):(0,r.jsxs)("div",{className:"pl-7",children:[(0,r.jsxs)("p",{className:"text-gray-300 text-sm mb-3",children:["Generate a preview of your app to ",o?"open with Expo Go":"scan with Expo Go",". ","building"===l||"answering"===l?"":"It takes about 2 minutes to generate."]}),(0,r.jsx)("div",{className:"flex justify-center",children:(0,r.jsx)("button",{onClick:x,disabled:d||"building"===l||"answering"===l,className:"bg-blue-600 text-white font-medium rounded-md px-6 py-3 text-sm transition-colors hover:bg-blue-700 flex items-center disabled:opacity-70 disabled:cursor-not-allowed",children:d||"building"===l||"answering"===l?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,r.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,r.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Generating..."]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",viewBox:"0 0 24 24",children:[(0,r.jsx)("path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"}),(0,r.jsx)("path",{d:"M21 3v5h-5"}),(0,r.jsx)("path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"}),(0,r.jsx)("path",{d:"M8 16H3v5"})]}),"Generate Preview"]})})})]})]}),n&&(0,r.jsx)("div",{className:"mt-4 border-gray-800",children:(0,r.jsxs)("p",{className:"text-gray-400 text-xs italic text-center",children:[(0,r.jsx)("svg",{className:"inline-block w-4 h-4 mr-1 mb-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),"For continued updates, force quit the Expo Go app on your device and"," ",o?"tap the button":"scan the QR code"," ","again."]})})]})}):null}var f=s(75843),y=s(5193);function b(e){let{isOpen:t,onClose:s,pendingContracts:n,onContractsDeployed:o,onTryToFixIt:l}=e,[i,c]=(0,a.useState)(1),[d,u]=(0,a.useState)(!1),[m,x]=(0,a.useState)(""),[p,h]=(0,a.useState)(!1),[g,b]=(0,a.useState)([]),[v,j]=(0,a.useState)([]),w=void 0!==window.ethereum,N=async()=>{if(!w){j(["Metamask is not installed. Please install it first."]);return}try{let e=new f.k(window.ethereum);await e.send("eth_requestAccounts",[]);let t=await e.getSigner(),s=await t.getAddress();x(s),u(!0),c(3),j([])}catch(e){console.error("Error connecting to Metamask:",e),j(["Failed to connect to Metamask: ".concat(e.message||"Unknown error")])}},k=async()=>{if(!d||0===n.length)return;h(!0),j([]);let e=[],t=[];try{let r=new f.k(window.ethereum),a=await r.getSigner(),l=await r.getNetwork(),i=Number(l.chainId);for(let r of(console.log("Deploying to network ID: ".concat(i)),n))try{var s;console.log("Deploying contract: ".concat(r.filename));let n=await fetch("/api/projects/artifact?url=".concat(encodeURIComponent(r.artifactUrl)));if(!n.ok){let e=await n.json().catch(()=>({error:"Unknown error"}));throw Error("Could not fetch artifact: ".concat(e.error||n.statusText))}let o=await n.json(),l=new y.P(o.abi,o.bytecode,a),c=await l.deploy();console.log("Transaction hash for ".concat(r.filename,":"),null===(s=c.deploymentTransaction())||void 0===s?void 0:s.hash),await c.waitForDeployment();let d=await c.getAddress();console.log("Contract ".concat(r.filename," deployed at:"),d),e.push("".concat(r.filename,": ").concat(d)),t.push({filename:r.filename,address:d,networkId:i})}catch(e){console.error("Error deploying ".concat(r.filename,":"),e),j(t=>[...t,"Failed to deploy ".concat(r.filename,": ").concat(e.message||"Unknown error")])}if(t.length>0)try{if(!(await fetch("/api/projects/contract",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({projectId:new URLSearchParams(window.location.search).get("id")||window.location.pathname.split("/")[2],contracts:t})})).ok)throw Error("Failed to update contract addresses");console.log("Successfully updated contract addresses in database"),o&&o()}catch(e){console.error("Error updating contract addresses:",e),j(t=>[...t,"Failed to save contract addresses: ".concat(e.message||"Unknown error")])}b(e)}catch(e){console.error("Error during deployment:",e),j(t=>[...t,"Deployment failed: ".concat(e.message||"Unknown error")])}finally{h(!1)}};return t?(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4",style:{zIndex:9999},children:(0,r.jsxs)("div",{className:"bg-white rounded-lg max-w-4xl w-full max-h-[90vh] overflow-y-auto border border-gray-200 shadow-xl",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center p-6 border-b border-gray-200",children:[(0,r.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"Deploy Smart Contracts"}),(0,r.jsx)("button",{onClick:()=>{c(1),u(!1),x(""),h(!1),b([]),j([]),s()},className:"text-gray-500 hover:text-gray-700",children:(0,r.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]}),(0,r.jsx)("div",{className:"p-6",children:(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsx)("div",{children:(0,r.jsx)("p",{className:"text-gray-600 mb-6",children:"Your app includes smart contracts that need to be deployed to the blockchain. Follow these steps to deploy them:"})}),v.length>0&&(0,r.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,r.jsx)("h4",{className:"text-red-800 font-medium",children:"Errors:"}),l&&(0,r.jsx)("button",{onClick:()=>{l&&v.length>0&&(l(v.slice(0,5).map((e,t)=>"Error ".concat(t+1,": ").concat(e)).join("\n\n")),s())},className:"px-3 py-1 text-sm font-medium bg-white hover:bg-gray-50 text-gray-800 border border-gray-300 rounded transition-colors",children:"Try to fix it"})]}),(0,r.jsx)("ul",{className:"text-red-700 text-sm space-y-1",children:v.map((e,t)=>(0,r.jsxs)("li",{children:["• ",e]},t))})]}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,r.jsx)("div",{className:"".concat(i>=1?"bg-blue-600":"bg-gray-300"," text-white text-sm font-bold rounded-full w-6 h-6 flex items-center justify-center mt-0.5 flex-shrink-0"),children:w?"✓":"1"}),(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsx)("h4",{className:"text-gray-900 font-medium",children:"Install Metamask"}),(0,r.jsx)("p",{className:"text-gray-600 text-sm mb-2",children:w?"Metamask is installed!":"You need Metamask to deploy smart contracts."}),!w&&(0,r.jsxs)("a",{href:"https://metamask.io/download/",target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center px-4 py-2 bg-orange-600 text-white text-sm font-medium rounded-md hover:bg-orange-700 transition-colors",children:["Install Metamask",(0,r.jsx)("svg",{className:"ml-2 w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})})]})]})]}),(0,r.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,r.jsx)("div",{className:"".concat(i>=2?"bg-blue-600":"bg-gray-300"," text-white text-sm font-bold rounded-full w-6 h-6 flex items-center justify-center mt-0.5 flex-shrink-0"),children:d?"✓":"2"}),(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsx)("h4",{className:"text-gray-900 font-medium",children:"Connect Metamask"}),(0,r.jsx)("p",{className:"text-gray-600 text-sm mb-2",children:d?"Connected: ".concat(m.slice(0,6),"...").concat(m.slice(-4)):"Connect your Metamask wallet to continue."}),w&&!d&&(0,r.jsx)("button",{onClick:N,className:"inline-flex items-center px-4 py-2 bg-blue-600 text-white text-sm font-medium rounded-md hover:bg-blue-700 transition-colors",children:"Connect Metamask"})]})]}),(0,r.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,r.jsx)("div",{className:"".concat(i>=3?"bg-blue-600":"bg-gray-300"," text-white text-sm font-bold rounded-full w-6 h-6 flex items-center justify-center mt-0.5 flex-shrink-0"),children:g.length===n.length&&n.length>0?"✓":"3"}),(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsx)("h4",{className:"text-gray-900 font-medium",children:"Deploy Smart Contracts"}),(0,r.jsxs)("p",{className:"text-gray-600 text-sm mb-2",children:["Deploy ",n.length," smart contract",1!==n.length?"s":""," to the blockchain."]}),(0,r.jsxs)("div",{className:"bg-gray-50 rounded-lg p-3 mb-3",children:[(0,r.jsx)("h5",{className:"text-sm font-medium text-gray-700 mb-2",children:"Contracts to deploy:"}),(0,r.jsx)("ul",{className:"text-sm text-gray-600 space-y-1",children:n.map((e,t)=>(0,r.jsxs)("li",{className:"flex items-center",children:[(0,r.jsx)("span",{className:"w-2 h-2 bg-gray-400 rounded-full mr-2"}),e.filename]},t))})]}),d&&(0,r.jsx)("button",{onClick:k,disabled:p,className:"inline-flex items-center px-4 py-2 bg-green-600 text-white text-sm font-medium rounded-md hover:bg-green-700 disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors",children:p?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,r.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,r.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Deploying..."]}):"Deploy Contracts"})]})]})]}),g.length>0&&(0,r.jsxs)("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[(0,r.jsx)("h4",{className:"text-green-800 font-medium mb-2",children:"Successfully Deployed:"}),(0,r.jsx)("ul",{className:"text-green-700 text-sm space-y-1",children:g.map((e,t)=>(0,r.jsxs)("li",{children:["• ",e]},t))}),g.length===n.length&&(0,r.jsx)("div",{className:"mt-3 pt-3 border-t border-green-200",children:(0,r.jsx)("p",{className:"text-green-800 text-sm font-medium",children:"All contracts deployed successfully! You can now close this modal."})})]})]})})]})}):null}function v(e){let{isOpen:t,onClose:s,projectContracts:n=[],onContractsDeployed:o,onTryToFixIt:l}=e,[i,c]=(0,a.useState)(null),[d,u]=(0,a.useState)(!1),[x,p]=(0,a.useState)([]);if(!t)return null;let h=n.filter(e=>e.artifactUrl),g=async e=>{try{await navigator.clipboard.writeText(e),c(e),m.Ay.success("Address copied to clipboard"),setTimeout(()=>{c(null)},2e3)}catch(e){console.error("Failed to copy address: ",e),m.Ay.error("Failed to copy address")}},f=e=>{p([e]),u(!0)},y=()=>{u(!1),p([]),o&&o()};return(0,r.jsxs)("div",{className:"fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50",children:[(0,r.jsxs)("div",{className:"bg-gray-900 rounded-lg max-w-2xl w-full p-6 border border-gray-800 max-h-[80vh] overflow-y-auto",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,r.jsx)("h3",{className:"text-xl text-white font-semibold",children:"Smart Contracts"}),(0,r.jsx)("button",{onClick:s,className:"text-gray-400 hover:text-white",children:(0,r.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]}),0===h.length?(0,r.jsxs)("div",{className:"text-center py-8",children:[(0,r.jsx)("svg",{className:"w-12 h-12 text-gray-400 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),(0,r.jsx)("p",{className:"text-gray-400 text-sm",children:"No smart contracts found for this project."})]}):(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,r.jsx)("p",{className:"text-gray-300 text-sm",children:"Below are the smart contracts associated with this project:"}),h.length>0&&(0,r.jsx)("button",{onClick:()=>{p(h),u(!0)},className:"inline-flex items-center px-3 py-1.5 bg-blue-600 hover:bg-blue-700 text-white text-sm font-medium rounded transition-colors",children:"Redeploy All"})]}),h.map((e,t)=>(0,r.jsx)("div",{className:"bg-gray-800 rounded-lg p-4 border border-gray-700",children:(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsxs)("div",{className:"flex items-center mb-2",children:[(0,r.jsx)("svg",{className:"w-5 h-5 text-blue-400 mr-2 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),(0,r.jsx)("h4",{className:"text-white font-medium text-sm",children:e.filename})]}),(0,r.jsxs)("div",{className:"flex md:flex-row flex-col md:items-center",children:[(0,r.jsx)("span",{className:"text-gray-400 text-xs mr-2",children:"Contract Address:"}),e.actualAddress?(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("code",{className:"text-white text-xs font-mono break-all",children:e.actualAddress}),(0,r.jsx)("button",{onClick:()=>g(e.actualAddress),className:"ml-2 text-gray-400 hover:text-white p-1",title:i===e.actualAddress?"Copied!":"Copy address",children:i===e.actualAddress?(0,r.jsx)("svg",{className:"w-4 h-4 text-green-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})}):(0,r.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})})})]}):(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("span",{className:"text-gray-500 text-xs italic",children:"(pending)"}),(0,r.jsx)("button",{onClick:()=>f(e),className:"inline-flex items-center px-2 py-1 bg-blue-600 hover:bg-blue-700 text-white text-xs font-medium rounded transition-colors",children:"Deploy"})]})]})]})},t))]})]}),(0,r.jsx)(b,{isOpen:d,onClose:()=>{u(!1),p([])},pendingContracts:x,onContractsDeployed:()=>{y(),u(!1),s()},onTryToFixIt:e=>{l&&l(e),s()}})]})}var j=s(43442);function w(e){let{activeView:t,mobileActiveTab:s,isMobile:n,setActiveView:o,isLoading:l,projectSlug:i,projectId:x,projectPreview:f,projectBuild:y,projectPlatform:b,projectStatus:w,onPublish:N,onGeneratePreview:k,userSubscription:C,domains:S=[],projectExpoPreviewProjectId:E,onSubscriptionClick:D,projectContracts:T,onContractsDeployed:I,onTryToFixIt:A}=e,[L,P]=(0,a.useState)(!0),[M,O]=(0,a.useState)(!1),[_,B]=(0,a.useState)(!1),[R,F]=(0,a.useState)(!1),[U,z]=(0,a.useState)(!1),[W,G]=(0,a.useState)(C),[J,H]=(0,a.useState)(!1),[V,q]=(0,a.useState)(!1),[Y,K]=(0,a.useState)(!1),[X,$]=(0,a.useState)(!1),[Q,Z]=(0,a.useState)(!1),{user:ee}=(0,d.A)(),{isWhitelabel:et,whitelabelConfig:es}=(0,j.p)();(0,a.useEffect)(()=>{document.documentElement.classList.add("dark"),localStorage.setItem("darkMode","true")},[]),(0,a.useEffect)(()=>{C&&G(C)},[C]);let er=async()=>{if(!W&&!J)try{H(!0);let e=await fetch("/api/subscription");if(e.ok){let t=await e.json();t.subscription&&G({tier:t.subscription.tier,messageCount:t.subscription.messageCount,messageLimit:t.subscription.limit,monthlyBuildSpend:t.subscription.monthlyBuildSpend,monthlyBuildCredit:t.subscription.monthlyBuildCredit,dailyBuildSpend:t.subscription.dailyBuildSpend,dailyBuildCredit:t.subscription.dailyBuildCredit,dailyLimit:t.subscription.dailyLimit,monthlyLimit:t.subscription.monthlyLimit,dailyCount:t.subscription.dailyCount,monthlyCount:t.subscription.monthlyCount})}}catch(e){console.error("Error fetching subscription info:",e)}finally{H(!1)}},ea=async()=>{if(!x)return!1;try{let e=await fetch("/api/projects/".concat(x,"/mobile-publish-config"));if(e.ok)return(await e.json()).hasConfiguration}catch(e){console.error("Error checking mobile publish config:",e)}return!1},en=async()=>{if("mobile"===b){if(!await ea()){$(!0);return}z(!0);try{let e=await fetch("/api/projects/mobile-publish",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({projectId:x})});if(429===e.status){let t=(await e.json()).message||"Rate limit exceeded. Please try again later.";throw Error(t)}if(!e.ok)throw Error("Failed to publish app");m.Ay.success("App submitted to app stores! It can take several minutes to show in app store drafts.",{duration:6e3})}catch(e){console.error("Publish error:",e),m.Ay.error(e.message||"Failed to start publishing process")}finally{z(!1)}}else if(N){z(!0);try{await N()}catch(e){console.error("Publish error:",e)}finally{z(!1)}}};null==W||W.messageLimit,(null==W?void 0:W.tier)===u.i.FREE&&(null==W||W.dailyLimit);let eo=(null==W?void 0:W.monthlyBuildCredit)||0;(null==W?void 0:W.tier)===u.i.FREE&&(eo=(null==W?void 0:W.dailyBuildCredit)||0),null==W||W.messageCount,(null==W?void 0:W.tier)===u.i.FREE&&(null==W||W.dailyCount);let el=(null==W?void 0:W.monthlyBuildSpend)||0;return(null==W?void 0:W.tier)===u.i.FREE&&(el=(null==W?void 0:W.dailyBuildSpend)||0),(0,r.jsxs)(r.Fragment,{children:[(_||M)&&(0,r.jsx)("div",{className:"fixed inset-0 w-full h-full z-0",onClick:()=>{O(!1),B(!1),F(!1)}}),(0,r.jsx)(g,{isOpen:V,onClose:()=>q(!1),projectExpoPreviewProjectId:E,isMobile:n,projectStatus:w,projectId:x,onGeneratePreview:k}),(0,r.jsx)(v,{isOpen:Y,onClose:()=>K(!1),projectContracts:T,projectId:x,onContractsDeployed:I,onTryToFixIt:A}),(0,r.jsx)("header",{className:"".concat(!et&&"bg-gray-900"," py-1 relative z-10"),style:{backgroundColor:et&&(null==es?void 0:es.primaryColor)||void 0},children:(0,r.jsx)("div",{className:"max-w-full mx-auto px-2 sm:px-4 py-0",children:(0,r.jsxs)("div",{className:"flex justify-between h-12 items-center",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[et?(0,r.jsx)(c(),{href:(null==es?void 0:es.homepageEnabled)===!0?"/":"/dashboard",className:"flex items-center",children:(0,r.jsxs)("div",{className:"flex items-center justify-center wl-hook-sidebar-logo-container",children:[(null==es?void 0:es.logo)&&(0,r.jsx)("img",{className:"wl-hook-sidebar-logo",src:es.logo,alt:(null==es?void 0:es.siteName)||"Platform",width:30}),es&&!(null==es?void 0:es.logo)&&(null==es?void 0:es.siteName)&&(0,r.jsx)("div",{className:"wl-hook-sitename-text text-white text-2xl font-bold",children:es.siteName})]})}):(0,r.jsx)(c(),{href:"/",className:"flex items-center",children:(0,r.jsx)("div",{className:"flex items-center justify-center wl-hook-sidebar-logo-container",children:(0,r.jsx)("img",{src:"/logo_tp.png",alt:"Famous.ai",width:30,className:"brightness-0 invert wl-hook-sidebar-logo"})})}),i&&(0,r.jsxs)("div",{className:"relative ml-0",children:[(0,r.jsxs)("button",{"data-dropdown-toggle":"nav-dropdown",onClick:()=>{let e=!_;e&&er(),B(e),F(!1)},className:"flex items-center text-gray-300 hover:text-white px-2 py-1 rounded-md text-sm font-medium truncate max-w-[180px] sm:max-w-none",children:[(0,r.jsx)("span",{className:"mr-1 truncate",children:i}),(0,r.jsx)("svg",{className:"w-4 h-4 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 9l-7 7-7-7"})})]}),_&&(0,r.jsxs)("div",{"data-dropdown":"nav-dropdown",className:"absolute left-0 mt-2 w-64 ".concat(!et&&"bg-gray-900"," border border-gray-800 rounded-lg shadow-lg z-50"),style:{backgroundColor:et&&(null==es?void 0:es.primaryColor)||void 0},children:[(0,r.jsx)("div",{className:"p-3 border-b border-gray-800",children:J?(0,r.jsxs)("div",{className:"flex items-center justify-center py-2",children:[(0,r.jsxs)("svg",{className:"animate-spin h-4 w-4 text-blue-500 mr-2",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,r.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,r.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),(0,r.jsx)("span",{className:"text-gray-400 text-xs",children:"Loading subscription info..."})]}):W?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsx)("span",{className:"text-gray-400 text-xs",children:"Subscription"}),(0,r.jsx)("span",{className:"text-blue-400 text-xs font-medium capitalize cursor-pointer",onClick:D,children:W.tier})]}),(0,r.jsxs)("div",{className:"mt-1 flex justify-between items-center",children:[(0,r.jsx)("span",{className:"text-gray-400 text-xs",children:"Build Credit Used"}),(0,r.jsxs)("span",{className:"text-gray-300 text-xs",children:["$",el," ","/ $",eo]})]}),(0,r.jsx)("div",{className:"mt-2 h-1.5 w-full ".concat(!et&&"bg-gray-800"," rounded-full overflow-hidden"),style:{backgroundColor:et&&(null==es?void 0:es.secondaryColor)||void 0},children:(0,r.jsx)("div",{className:"h-full ".concat(!et&&"bg-blue-600"," rounded-full"),style:{backgroundColor:et&&(null==es?void 0:es.tertiaryColor)||void 0,width:"".concat(Math.min(100,el/eo*100),"%")}})})]}):(0,r.jsx)("div",{className:"text-gray-400 text-xs text-center py-1",children:"Unable to load subscription info"})}),(0,r.jsxs)("div",{className:"py-1",children:[x&&(0,r.jsx)(c(),{href:"/project/".concat(x,"/settings"),className:"block px-4 py-2 text-sm text-gray-300 hover:bg-gray-800 hover:text-white",children:(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsxs)("svg",{className:"w-4 h-4 mr-2 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]}),"Project Settings"]})}),(0,r.jsx)(c(),{href:"/dashboard",className:"block px-4 py-2 text-sm text-gray-300 hover:bg-gray-800 hover:text-white",children:(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"w-4 h-4 mr-2 text-gray-400",children:[(0,r.jsx)("rect",{width:"7",height:"9",x:"3",y:"3",rx:"1"}),(0,r.jsx)("rect",{width:"7",height:"5",x:"14",y:"3",rx:"1"}),(0,r.jsx)("rect",{width:"7",height:"9",x:"14",y:"12",rx:"1"}),(0,r.jsx)("rect",{width:"7",height:"5",x:"3",y:"16",rx:"1"})]}),"Dashboard"]})}),!et&&(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("button",{className:"block w-full text-left px-4 py-2 text-sm text-gray-300 hover:bg-gray-800 hover:text-white",onClick:()=>F(!R),onMouseEnter:()=>F(!0),children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"w-4 h-4 mr-2 text-gray-400",children:[(0,r.jsx)("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),(0,r.jsx)("path",{d:"M16 3.128a4 4 0 0 1 0 7.744"}),(0,r.jsx)("path",{d:"M22 21v-2a4 4 0 0 0-3-3.87"}),(0,r.jsx)("circle",{cx:"9",cy:"7",r:"4"})]}),"Community"]}),(0,r.jsx)("svg",{className:"w-3 h-3 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 5l7 7-7 7"})})]})}),R&&(0,r.jsxs)("div",{className:"absolute left-full top-0 w-48 ".concat(!et&&"bg-gray-900"," border border-gray-800 rounded-lg shadow-lg overflow-hidden z-50 ml-0"),style:{backgroundColor:et&&(null==es?void 0:es.primaryColor)||void 0},onMouseLeave:()=>F(!1),children:[(0,r.jsx)(c(),{href:"/discord",target:"_blank",rel:"noopener noreferrer",className:"block px-4 py-2 text-sm text-gray-300 hover:bg-gray-800 hover:text-white",children:(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("svg",{className:"w-4 h-4 mr-2 text-gray-400",fill:"none",strokeWidth:1.5,stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{d:"M20.317 4.3698a19.7913 19.7913 0 00-4.8851-1.5152.0741.0741 0 00-.0785.0371c-.211.3753-.4447.8648-.6083 1.2495-1.8447-.2762-3.68-.2762-5.4868 0-.1636-.3933-.4058-.8742-.6177-1.2495a.077.077 0 00-.0785-.037 19.7363 19.7363 0 00-4.8852 1.515.0699.0699 0 00-.0321.0277C.5334 9.0458-.319 13.5799.0992 18.0578a.0824.0824 0 00.0312.0561c2.0528 1.5076 4.0413 2.4228 5.9929 3.0294a.0777.0777 0 00.0842-.0276c.4616-.6304.8731-1.2952 1.226-1.9942a.076.076 0 00-.0416-.1057c-.6528-.2476-1.2743-.5495-1.8722-.8923a.077.077 0 01-.0076-.1277c.1258-.0943.2517-.1923.3718-.2914a.0743.0743 0 01.0776-.0105c3.9278 1.7933 8.18 1.7933 12.0614 0a.0739.0739 0 01.0785.0095c.1202.099.246.1981.3728.2924a.077.077 0 01-.0066.1276 12.2986 12.2986 0 01-1.873.8914.0766.0766 0 00-.0407.1067c.3604.698.7719 1.3628 1.225 1.9932a.076.076 0 00.0842.0286c1.961-.6067 3.9495-1.5219 6.0023-3.0294a.077.077 0 00.0313-.0552c.5004-5.177-.8382-9.6739-3.5485-13.6604a.061.061 0 00-.0312-.0286zM8.02 15.3312c-1.1825 0-2.1569-1.0857-2.1569-2.419 0-1.3332.9555-2.4189 2.157-2.4189 1.2108 0 2.1757 1.0952 2.1568 2.419 0 1.3332-.9555 2.4189-2.1569 2.4189zm7.9748 0c-1.1825 0-2.1569-1.0857-2.1569-2.419 0-1.3332.9554-2.4189 2.1569-2.4189 1.2108 0 2.1757 1.0952 2.1568 2.419 0 1.3332-.946 2.4189-2.1568 2.4189Z"})}),"Discord"]})}),(0,r.jsx)(c(),{href:"/zoom",target:"_blank",rel:"noopener noreferrer",className:"block px-4 py-2 text-sm text-gray-300 hover:bg-gray-800 hover:text-white",children:(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsxs)("svg",{className:"w-4 h-4 mr-2 text-gray-400",fill:"none",stroke:"currentColor",strokeWidth:"2",viewBox:"0 0 24 24",children:[(0,r.jsx)("path",{d:"M21.42 10.922a1 1 0 0 0-.019-1.838L12.83 5.18a2 2 0 0 0-1.66 0L2.6 9.08a1 1 0 0 0 0 1.832l8.57 3.908a2 2 0 0 0 1.66 0z"}),(0,r.jsx)("path",{d:"M22 10v6"}),(0,r.jsx)("path",{d:"M6 12.5V16a6 3 0 0 0 12 0v-3.5"})]}),"Live Training"]})}),(0,r.jsx)("a",{href:"https://x.com/Famous_AI",target:"_blank",rel:"noopener noreferrer",className:"block px-4 py-2 text-sm text-gray-300 hover:bg-gray-800 hover:text-white",children:(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("svg",{className:"w-4 h-4 mr-2 text-gray-400",viewBox:"0 0 1200 1227",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,r.jsx)("path",{d:"M714.163 519.284L1160.89 0H1055.03L667.137 450.887L357.328 0H0L468.492 681.821L0 1226.37H105.866L515.491 750.218L842.672 1226.37H1200L714.137 519.284H714.163ZM569.165 687.828L521.697 619.934L144.011 79.6944H306.615L611.412 515.685L658.88 583.579L1055.08 1150.3H892.476L569.165 687.854V687.828Z",fill:"currentColor"})}),"X / Twitter"]})}),(0,r.jsx)("a",{href:"https://famous.ai/experts",target:"_blank",rel:"noopener noreferrer",className:"block px-4 py-2 text-sm text-gray-300 hover:bg-gray-800 hover:text-white",children:(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"w-4 h-4 mr-2 text-gray-400",children:[(0,r.jsx)("path",{d:"M16 2v2"}),(0,r.jsx)("path",{d:"M7 22v-2a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v2"}),(0,r.jsx)("path",{d:"M8 2v2"}),(0,r.jsx)("circle",{cx:"12",cy:"11",r:"3"}),(0,r.jsx)("rect",{x:"3",y:"4",width:"18",height:"18",rx:"2"})]}),"Expert Marketplace"]})}),(0,r.jsx)("a",{href:"https://affiliates.famous.ai",target:"_blank",rel:"noopener noreferrer",className:"block px-4 py-2 text-sm text-gray-300 hover:bg-gray-800 hover:text-white",children:(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"w-4 h-4 mr-2 text-gray-400",children:[(0,r.jsx)("circle",{cx:"12",cy:"12",r:"10"}),(0,r.jsx)("path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8"}),(0,r.jsx)("path",{d:"M12 18V6"})]}),"Affiliate Program"]})})]})]}),!et&&(0,r.jsx)("a",{href:"https://famous.ai/help",target:"_blank",rel:"noopener noreferrer",className:"block px-4 py-2 text-sm text-gray-300 hover:bg-gray-800 hover:text-white",children:(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round",className:"w-4 h-4 mr-2 text-gray-400",children:[(0,r.jsx)("circle",{cx:"12",cy:"12",r:"10"}),(0,r.jsx)("path",{d:"m4.93 4.93 4.24 4.24"}),(0,r.jsx)("path",{d:"m14.83 9.17 4.24-4.24"}),(0,r.jsx)("path",{d:"m14.83 14.83 4.24 4.24"}),(0,r.jsx)("path",{d:"m9.17 14.83-4.24 4.24"}),(0,r.jsx)("circle",{cx:"12",cy:"12",r:"4"})]}),"Help Center"]})}),!et&&(0,r.jsx)("a",{href:"https://go.famous.ai/72hourlaunch",target:"_blank",rel:"noopener noreferrer",className:"block px-4 py-2 text-sm text-gray-300 hover:bg-gray-800 hover:text-white",children:(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round",className:"w-4 h-4 mr-2 text-gray-400",children:[(0,r.jsx)("path",{d:"M11 14h2a2 2 0 1 0 0-4h-3c-.6 0-1.1.2-1.4.6L3 16"}),(0,r.jsx)("path",{d:"m7 20 1.6-1.4c.3-.4.8-.6 1.4-.6h4c1.1 0 2.1-.4 2.8-1.2l4.6-4.4a2 2 0 0 0-2.75-2.91l-4.2 3.9"}),(0,r.jsx)("path",{d:"m2 15 6 6"}),(0,r.jsx)("path",{d:"M19.5 8.5c.7-.7 1.5-1.6 1.5-2.7A2.73 2.73 0 0 0 16 4a2.78 2.78 0 0 0-5 1.8c0 1.2.8 2 1.5 2.8L16 12Z"})]}),"Done For You"]})})]})]})]})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-2 sm:space-x-4",children:[!n&&"preview"===t&&f&&"mobile"===b&&(0,r.jsxs)("button",{onClick:()=>q(!0),className:"".concat(!et&&"bg-gray-800"," text-gray-400 hover:text-white py-1.5 px-4 rounded-md transition-colors flex items-center space-x-1 text-sm"),style:{backgroundColor:et&&(null==es?void 0:es.secondaryColor)||void 0},title:"Preview on device with QR code",children:[(0,r.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 4v1m6 11h2m-6 0h-2v4m0-11v3m0 0h.01M12 12h4.01M16 20h4M4 12h4m12 0h.01M5 8h2a1 1 0 001-1V5a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1zm12 0h2a1 1 0 001-1V5a1 1 0 00-1-1h-2a1 1 0 00-1 1v2a1 1 0 001 1zM5 20h2a1 1 0 001-1v-2a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1z"})}),(0,r.jsx)("span",{className:"hidden sm:inline",children:"Device"})]}),!n&&f&&"crypto"===b&&T&&T.length>0&&(0,r.jsxs)("button",{onClick:()=>K(!0),className:"".concat(!et&&"bg-gray-800"," text-gray-400 hover:text-white py-1.5 px-4 rounded-md transition-colors flex items-center space-x-1 text-sm"),style:{backgroundColor:et&&(null==es?void 0:es.secondaryColor)||void 0},title:"Show project smart contracts",children:[(0,r.jsxs)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,children:[(0,r.jsx)("path",{d:"M4 22h14a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v4"}),(0,r.jsx)("path",{d:"M14 2v4a2 2 0 0 0 2 2h4"}),(0,r.jsx)("rect",{width:"4",height:"6",x:"2",y:"12",rx:"2"}),(0,r.jsx)("path",{d:"M10 12h2v6"}),(0,r.jsx)("path",{d:"M10 18h4"})]}),(0,r.jsx)("span",{className:"hidden sm:inline",children:"Contracts"})]}),n&&"preview"===s&&f&&"mobile"===b&&(0,r.jsx)("button",{onClick:()=>q(!0),className:"text-gray-400 hover:text-white p-1.5 rounded-md transition-colors ".concat(!et&&"bg-gray-800"),style:{backgroundColor:et&&(null==es?void 0:es.secondaryColor)||void 0},title:"Preview on device with QR code",children:(0,r.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 4v1m6 11h2m-6 0h-2v4m0-11v3m0 0h.01M12 12h4.01M16 20h4M4 12h4m12 0h.01M5 8h2a1 1 0 001-1V5a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1zm12 0h2a1 1 0 001-1V5a1 1 0 00-1-1h-2a1 1 0 00-1 1v2a1 1 0 001 1zM5 20h2a1 1 0 001-1v-2a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1z"})})}),n&&f&&"crypto"===b&&T&&T.length>0&&(0,r.jsx)("button",{onClick:()=>K(!0),className:"text-gray-400 hover:text-white p-1.5 rounded-md transition-colors ".concat(!et&&"bg-gray-800"),style:{backgroundColor:et&&(null==es?void 0:es.secondaryColor)||void 0},title:"Show project smart contracts",children:(0,r.jsxs)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,children:[(0,r.jsx)("path",{d:"M4 22h14a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v4"}),(0,r.jsx)("path",{d:"M14 2v4a2 2 0 0 0 2 2h4"}),(0,r.jsx)("rect",{width:"4",height:"6",x:"2",y:"12",rx:"2"}),(0,r.jsx)("path",{d:"M10 12h2v6"}),(0,r.jsx)("path",{d:"M10 18h4"})]})}),(0,r.jsxs)("div",{className:"hidden lg:flex ".concat(!et&&"bg-gray-800"," rounded-lg p-0.5"),style:{backgroundColor:et&&(null==es?void 0:es.secondaryColor)||void 0},children:[(0,r.jsx)("button",{onClick:()=>o("code"),className:"px-4 py-1.5 text-sm font-medium rounded-md transition-all duration-200 ".concat("code"===t?"bg-primary text-white shadow-md":"text-gray-400 hover:text-gray-300"),children:(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("svg",{className:"w-4 h-4 mr-1.5 ".concat("code"===t?"text-white":"text-gray-500"),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4"})}),"Code"]})}),(0,r.jsx)("button",{onClick:()=>o("preview"),className:"px-4 py-1.5 text-sm font-medium rounded-md transition-all duration-200 ".concat("preview"===t?"bg-primary text-white shadow-md":"text-gray-400 hover:text-gray-300"),children:(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsxs)("svg",{className:"w-4 h-4 mr-1.5 ".concat("preview"===t?"text-white":"text-gray-500"),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]}),"Preview"]})})]}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("button",{"data-dropdown-toggle":"publish-dropdown",onClick:()=>O(!M),className:"".concat(!et&&"bg-blue-600"," text-white font-medium rounded-md px-3 sm:px-4 py-2 text-sm flex items-center transition-colors"),style:{backgroundColor:et&&(null==es?void 0:es.tertiaryColor)||void 0},children:"Publish"}),M&&(0,r.jsx)("div",{"data-dropdown":"publish-dropdown",className:"absolute right-0 mt-2 w-72 ".concat(!et&&"bg-gray-900"," border border-gray-800 rounded-lg shadow-lg overflow-hidden z-50"),style:{backgroundColor:et&&(null==es?void 0:es.primaryColor)||void 0},children:"mobile"===b?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"p-4",children:[(0,r.jsx)("h3",{className:"text-xl text-white font-semibold",children:"Deploy Mobile App"}),(0,r.jsx)("p",{className:"text-gray-400 text-sm mt-1",children:"Your mobile app is ready to be submitted to app stores"})]}),(0,r.jsxs)("div",{className:"border-t border-gray-800 p-4 flex justify-between items-center",children:[(0,r.jsx)("div",{}),(0,r.jsx)("button",{onClick:en,disabled:U,className:"bg-blue-600 text-white font-medium rounded-md px-6 py-2 text-sm transition-colors disabled:opacity-70",children:U?(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsxs)("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,r.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,r.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Submitting..."]}):"Submit to App Stores"})]})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"p-4",children:[(0,r.jsx)("h3",{className:"text-xl text-white font-semibold",children:"Publish"}),(0,r.jsx)("p",{className:"text-gray-400 text-sm mt-1",children:f&&y&&f!==y?"You have unpublished changes":"Your project is published"})]}),(0,r.jsxs)("div",{className:"border-t border-gray-800 px-4 py-3",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsx)("h4",{className:"text-white font-medium",children:"Domains"}),(0,r.jsx)(c(),{href:"/project/".concat(x,"/settings"),className:"text-blue-400 hover:text-blue-300 text-sm",children:"Manage"})]}),i&&(0,r.jsxs)("button",{onClick:()=>{if(i){let e="https://".concat(i,".").concat("deploypad.app");window.open(e,"_blank")}},className:"mt-2 ".concat(!et&&"bg-gray-800"," rounded-lg p-3 flex items-center w-full text-left hover:bg-gray-750 transition-colors"),style:{backgroundColor:et&&(null==es?void 0:es.secondaryColor)||void 0},children:[(0,r.jsx)("svg",{className:"w-5 h-5 text-gray-400 mr-2 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M21 12a9 9 0 01-9 9m9-9a9 9 0 00-9-9m9 9H3m9 9a9 9 0 01-9-9m9 9c1.657 0 3-4.03 3-9s-1.343-9-3-9m0 18c-1.657 0-3-4.03-3-9s1.343-9 3-9m-9 9a9 9 0 019-9"})}),(0,r.jsxs)("span",{className:"text-gray-300 text-sm truncate flex-1",children:[i,".","deploypad.app"]}),(0,r.jsx)("svg",{className:"w-4 h-4 text-gray-400 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})})]}),S.map(e=>(0,r.jsxs)("button",{onClick:()=>window.open("https://".concat(e),"_blank"),className:"mt-2 ".concat(!et&&"bg-gray-800"," rounded-lg p-3 flex items-center w-full text-left hover:bg-gray-750 transition-colors"),style:{backgroundColor:et&&(null==es?void 0:es.secondaryColor)||void 0},children:[(0,r.jsx)("svg",{className:"w-5 h-5 text-gray-400 mr-2 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M21 12a9 9 0 01-9 9m9-9a9 9 0 00-9-9m9 9H3m9 9a9 9 0 01-9-9m9 9c1.657 0 3-4.03 3-9s-1.343-9-3-9m0 18c-1.657 0-3-4.03-3-9s1.343-9 3-9m-9 9a9 9 0 019-9"})}),(0,r.jsx)("span",{className:"text-gray-300 text-sm truncate flex-1",children:e}),(0,r.jsx)("svg",{className:"w-4 h-4 text-gray-400 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})})]},e))]}),(0,r.jsxs)("div",{className:"border-t border-gray-800 p-4 flex justify-between items-center",children:[(0,r.jsx)("div",{}),(0,r.jsx)("button",{onClick:en,disabled:U,className:"".concat(!et&&"bg-blue-600"," text-white font-medium rounded-md px-6 py-2 text-sm transition-colors disabled:opacity-70"),style:{backgroundColor:et&&(null==es?void 0:es.tertiaryColor)||void 0},children:U?(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsxs)("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,r.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,r.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Publishing..."]}):"Publish"})]})]})})]})]})]})})}),x&&(0,r.jsx)(p,{isOpen:X,onClose:()=>$(!1),projectId:x,onPublishSuccess:()=>{$(!1),Z(!0)}}),(0,r.jsx)(h,{isOpen:Q,onClose:()=>Z(!1)})]})}var N=s(45703),k=s.n(N),C=s(68553);function S(e){let{files:t,projectId:s,isMobile:n,onSaveAllChanges:o,onChangedFilesUpdate:l,onSavingStateUpdate:i}=e,[c,d]=(0,a.useState)(""),[u,m]=(0,a.useState)(""),[x,p]=(0,a.useState)(!1),[h,g]=(0,a.useState)(new Set),[f,y]=(0,a.useState)(!1),[b,v]=(0,a.useState)({}),[j,w]=(0,a.useState)(!1),[N,S]=(0,a.useState)(!1),[E,D]=(0,a.useState)("files"),[T,I]=(0,a.useState)(""),[A,L]=(0,a.useState)(""),[P,M]=(0,a.useState)({}),[O,_]=(0,a.useState)(new Set),B=(0,a.useRef)(null);(0,a.useEffect)(()=>{let e=setTimeout(()=>{L(T)},300);return()=>clearTimeout(e)},[T]);let R=(0,a.useMemo)(()=>c&&b[c]||u,[b,c,u]);(0,a.useEffect)(()=>{l&&l(b)},[b,l]),(0,a.useEffect)(()=>{i&&i(N)},[N,i]),(0,a.useEffect)(()=>{let e=()=>{window.innerWidth<768&&y(!0)};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]);let F=(e=>{let t=[],s={};return Object.keys(e).sort().forEach(e=>{let r=e.split("/"),a="";r.forEach((e,n)=>{let o=n===r.length-1,l=a;if(!s[a=a?"".concat(a,"/").concat(e):e]){let r={name:e,path:a,type:o?"file":"folder",children:o?void 0:[]};s[a]=r,l&&s[l]?s[l].children.push(r):t.push(r)}})}),t})(t||{});(0,a.useEffect)(()=>{if(t&&Object.keys(t).length>0){let e=Object.keys(t)[0];d(e),m(t[e]||"")}},[t]),(0,a.useEffect)(()=>{let e=async e=>{if(s){p(!0);try{let t=await fetch("/api/projects/file-content?projectId=".concat(encodeURIComponent(s),"&filePath=").concat(encodeURIComponent(e))),r=await t.json();t.ok&&r.fileContent&&(m(r.fileContent),r.fileContent)}catch(e){console.error("Error fetching file content:",e)}finally{p(!1)}}};if(c&&t){let s=t[c];s?m(s):(m(""),e(c))}},[c,t,s]);let U=e=>{let t=new Set(h);t.has(e)?t.delete(e):t.add(e),g(t)},z=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,s=h.has(e.path),a=c===e.path,n="file"===e.type&&b.hasOwnProperty(e.path);return(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"flex items-center px-2 py-1 cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-700 ".concat(a&&"file"===e.type?"bg-blue-100 dark:bg-blue-900 text-blue-800 dark:text-blue-200":"text-gray-700 dark:text-gray-300"),style:{paddingLeft:"".concat(16*t+8,"px")},onClick:()=>{"folder"===e.type?U(e.path):(d(e.path),window.innerWidth<768&&y(!0))},children:["folder"===e.type?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("svg",{className:"w-4 h-4 mr-2 transition-transform ".concat(s?"transform rotate-90":""),fill:"currentColor",viewBox:"0 0 20 20",children:(0,r.jsx)("path",{fillRule:"evenodd",d:"M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z",clipRule:"evenodd"})}),(0,r.jsx)("svg",{className:"w-4 h-4 mr-2 text-blue-500",fill:"currentColor",viewBox:"0 0 20 20",children:(0,r.jsx)("path",{d:"M2 6a2 2 0 012-2h5l2 2h5a2 2 0 012 2v6a2 2 0 01-2 2H4a2 2 0 01-2-2V6z"})})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"w-4 h-4 mr-2"}),(0,r.jsx)("svg",{className:"w-4 h-4 mr-2 text-gray-500",fill:"currentColor",viewBox:"0 0 20 20",children:(0,r.jsx)("path",{fillRule:"evenodd",d:"M4 4a2 2 0 012-2h4.586A2 2 0 0112 2.586L15.414 6A2 2 0 0116 7.414V16a2 2 0 01-2 2H6a2 2 0 01-2-2V4zm2 6a1 1 0 011-1h6a1 1 0 110 2H7a1 1 0 01-1-1zm1 3a1 1 0 100 2h6a1 1 0 100-2H7z",clipRule:"evenodd"})})]}),(0,r.jsx)("span",{className:"text-sm truncate flex-1",children:e.name}),n&&(0,r.jsx)("div",{className:"w-2 h-2 bg-orange-500 rounded-full ml-1 flex-shrink-0",title:"File has unsaved changes"})]}),"folder"===e.type&&s&&e.children&&(0,r.jsx)("div",{children:e.children.map(e=>z(e,t+1))})]},e.path)},W=(0,a.useMemo)(()=>{if(!A.trim()||!t)return{};let e={},s=A.toLowerCase();return Object.entries(t).forEach(t=>{let[r,a]=t;if(!a||r.includes("package-lock.json"))return;let n=a.split("\n"),o=[];n.forEach((e,t)=>{let r=e.toLowerCase(),a=0;for(;;){let n=r.indexOf(s,a);if(-1===n)break;o.push({line:t+1,column:n+1,endColumn:n+s.length+1,text:e.substring(n,n+s.length),lineContent:e.trim()}),a=n+1}}),o.length>0&&(e[r]={matches:o})}),e},[A,t]);(0,a.useEffect)(()=>{M(W);let e=Object.entries(W);e.length>0?_(new Set(e.map(e=>{let[t]=e;return t}))):_(new Set)},[W]);let G=(e,t)=>{d(e),window.innerWidth<768&&y(!0),setTimeout(()=>{if(B.current){let e=B.current;e.setPosition({lineNumber:t.line,column:t.column}),e.focus(),e.revealLineInCenter(t.line);let s=e.deltaDecorations([],[{range:{startLineNumber:t.line,startColumn:t.column,endLineNumber:t.line,endColumn:t.endColumn},options:{className:"search-highlight",inlineClassName:"search-highlight-inline"}}]);setTimeout(()=>{B.current&&B.current.deltaDecorations(s,[])},2e3)}},100)},J=e=>{let t=new Set(O);t.has(e)?t.delete(e):t.add(e),_(t)};return t&&0!==Object.keys(t).length?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(k(),{id:"ac8ffe8bfad96ef1",children:".search-highlight{background-color:rgba(255,255,0,.3)!important}.search-highlight-inline{background-color:rgba(255,255,0,.3)!important}"}),(0,r.jsxs)("div",{className:"jsx-ac8ffe8bfad96ef1 flex h-full max-h-[calc(100vh-70px)] w-full bg-white dark:bg-gray-900 border border-gray-200 dark:border-gray-700 rounded-lg overflow-hidden relative",children:[!f&&(0,r.jsx)("div",{onClick:()=>y(!0),className:"jsx-ac8ffe8bfad96ef1 absolute inset-0 bg-black bg-opacity-50 z-10 md:hidden"}),(0,r.jsx)("div",{className:"jsx-ac8ffe8bfad96ef1 "+"\n        ".concat(f?"w-12":"w-64","\n        transition-all duration-300 border-r border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-800\n        absolute md:relative z-20 h-full md:h-auto\n        md:flex-shrink-0\n      "),children:f?(0,r.jsx)("div",{className:"jsx-ac8ffe8bfad96ef1 w-full h-full flex flex-col items-center py-3",children:(0,r.jsx)("button",{onClick:()=>y(!1),title:"Expand file tree",className:"jsx-ac8ffe8bfad96ef1 p-2 rounded hover:bg-gray-200 dark:hover:bg-gray-700 text-gray-500 dark:text-gray-400 mb-4",children:(0,r.jsx)("svg",{fill:"currentColor",viewBox:"0 0 20 20",className:"jsx-ac8ffe8bfad96ef1 w-5 h-5",children:(0,r.jsx)("path",{fillRule:"evenodd",d:"M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z",clipRule:"evenodd",className:"jsx-ac8ffe8bfad96ef1"})})})}):(0,r.jsxs)("div",{className:"jsx-ac8ffe8bfad96ef1 w-full h-full flex flex-col",children:[(0,r.jsxs)("div",{className:"jsx-ac8ffe8bfad96ef1 px-3 h-12 border-b border-gray-200 dark:border-gray-700 flex items-center justify-between flex-shrink-0",children:[(0,r.jsxs)("div",{className:"jsx-ac8ffe8bfad96ef1 flex items-center space-x-2",children:[(0,r.jsx)("button",{onClick:()=>D("files"),title:"File Explorer",className:"jsx-ac8ffe8bfad96ef1 "+"p-1.5 rounded text-xs font-medium transition-colors ".concat("files"===E?"bg-blue-100 dark:bg-blue-900 text-blue-700 dark:text-blue-300":"text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700"),children:(0,r.jsx)("svg",{fill:"currentColor",viewBox:"0 0 20 20",className:"jsx-ac8ffe8bfad96ef1 w-4 h-4",children:(0,r.jsx)("path",{d:"M2 6a2 2 0 012-2h5l2 2h5a2 2 0 012 2v6a2 2 0 01-2 2H4a2 2 0 01-2-2V6z",className:"jsx-ac8ffe8bfad96ef1"})})}),(0,r.jsx)("button",{onClick:()=>D("search"),title:"Search",className:"jsx-ac8ffe8bfad96ef1 "+"p-1.5 rounded text-xs font-medium transition-colors ".concat("search"===E?"bg-blue-100 dark:bg-blue-900 text-blue-700 dark:text-blue-300":"text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700"),children:(0,r.jsx)("svg",{fill:"currentColor",viewBox:"0 0 20 20",className:"jsx-ac8ffe8bfad96ef1 w-4 h-4",children:(0,r.jsx)("path",{fillRule:"evenodd",d:"M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z",clipRule:"evenodd",className:"jsx-ac8ffe8bfad96ef1"})})})]}),(0,r.jsx)("button",{onClick:()=>y(!0),title:"Collapse sidebar",className:"jsx-ac8ffe8bfad96ef1 p-1 rounded hover:bg-gray-200 dark:hover:bg-gray-700 text-gray-500 dark:text-gray-400",children:(0,r.jsx)("svg",{fill:"currentColor",viewBox:"0 0 20 20",className:"jsx-ac8ffe8bfad96ef1 w-4 h-4 transform rotate-180",children:(0,r.jsx)("path",{fillRule:"evenodd",d:"M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z",clipRule:"evenodd",className:"jsx-ac8ffe8bfad96ef1"})})})]}),"search"===E&&(0,r.jsx)("div",{className:"jsx-ac8ffe8bfad96ef1 px-3 py-2 border-b border-gray-200 dark:border-gray-700",children:(0,r.jsxs)("div",{className:"jsx-ac8ffe8bfad96ef1 relative",children:[(0,r.jsx)("input",{type:"text",placeholder:"Search files...",value:T,onChange:e=>I(e.target.value),autoFocus:!0,className:"jsx-ac8ffe8bfad96ef1 w-full px-3 py-2 pl-8 text-sm bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),(0,r.jsx)("svg",{fill:"currentColor",viewBox:"0 0 20 20",className:"jsx-ac8ffe8bfad96ef1 absolute left-2.5 top-2.5 w-4 h-4 text-gray-400",children:(0,r.jsx)("path",{fillRule:"evenodd",d:"M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z",clipRule:"evenodd",className:"jsx-ac8ffe8bfad96ef1"})}),T&&(0,r.jsx)("button",{onClick:()=>I(""),className:"jsx-ac8ffe8bfad96ef1 absolute right-2 top-2 p-0.5 rounded hover:bg-gray-200 dark:hover:bg-gray-700 text-gray-400 hover:text-gray-600",children:(0,r.jsx)("svg",{fill:"currentColor",viewBox:"0 0 20 20",className:"jsx-ac8ffe8bfad96ef1 w-4 h-4",children:(0,r.jsx)("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd",className:"jsx-ac8ffe8bfad96ef1"})})})]})}),(0,r.jsx)("div",{className:"jsx-ac8ffe8bfad96ef1 flex-1 overflow-y-auto",children:"files"===E?(0,r.jsx)("div",{className:"jsx-ac8ffe8bfad96ef1 py-2",children:F.map(e=>z(e))}):(()=>{let e=Object.entries(P);return A.trim()&&0===e.length?(0,r.jsx)("div",{className:"px-3 py-4 text-center",children:(0,r.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"No results found"})}):T.trim()?T.trim()&&!A.trim()?(0,r.jsx)("div",{className:"px-3 py-4 text-center",children:(0,r.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Searching..."})}):(0,r.jsx)("div",{className:"py-2",children:e.map(e=>{let[t,{matches:s}]=e,a=O.has(t),n=t.split("/").pop()||t;return(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"flex items-center px-2 py-1 cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-300",onClick:()=>J(t),children:[(0,r.jsx)("svg",{className:"w-4 h-4 mr-2 transition-transform ".concat(a?"transform rotate-90":""),fill:"currentColor",viewBox:"0 0 20 20",children:(0,r.jsx)("path",{fillRule:"evenodd",d:"M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z",clipRule:"evenodd"})}),(0,r.jsx)("svg",{className:"w-4 h-4 mr-2 text-gray-500",fill:"currentColor",viewBox:"0 0 20 20",children:(0,r.jsx)("path",{fillRule:"evenodd",d:"M4 4a2 2 0 012-2h4.586A2 2 0 0112 2.586L15.414 6A2 2 0 0116 7.414V16a2 2 0 01-2 2H6a2 2 0 01-2-2V4zm2 6a1 1 0 011-1h6a1 1 0 110 2H7a1 1 0 01-1-1zm1 3a1 1 0 100 2h6a1 1 0 100-2H7z",clipRule:"evenodd"})}),(0,r.jsx)("span",{className:"text-sm truncate flex-1",children:n}),(0,r.jsxs)("span",{className:"text-xs text-gray-500 ml-2",children:["(",s.length,")"]})]}),a&&(0,r.jsx)("div",{className:"ml-6",children:s.map((e,s)=>(0,r.jsxs)("div",{className:"flex items-start px-2 py-1 cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-700 text-sm",onClick:()=>G(t,e),children:[(0,r.jsx)("span",{className:"text-xs text-gray-500 dark:text-gray-400 mr-3 mt-0.5 font-mono min-w-[2rem] text-right",children:e.line}),(0,r.jsx)("span",{className:"text-gray-700 dark:text-gray-300 truncate",children:e.lineContent})]},"".concat(t,"-").concat(e.line,"-").concat(e.column,"-").concat(s)))})]},t)})}):(0,r.jsx)("div",{className:"px-3 py-4 text-center",children:(0,r.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Enter a search term"})})})()})]})}),(0,r.jsxs)("div",{className:"jsx-ac8ffe8bfad96ef1 flex-1 flex flex-col min-w-0 pl-12 md:pl-0",children:[c&&(0,r.jsx)("div",{className:"jsx-ac8ffe8bfad96ef1 px-4 h-12 border-b border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-800 flex-shrink-0 flex items-center",children:(0,r.jsx)("div",{className:"jsx-ac8ffe8bfad96ef1 flex items-center justify-between w-full",children:(0,r.jsxs)("div",{className:"jsx-ac8ffe8bfad96ef1 flex items-center min-w-0",children:[(0,r.jsx)("svg",{fill:"currentColor",viewBox:"0 0 20 20",className:"jsx-ac8ffe8bfad96ef1 w-4 h-4 mr-2 text-gray-500 flex-shrink-0",children:(0,r.jsx)("path",{fillRule:"evenodd",d:"M4 4a2 2 0 012-2h4.586A2 2 0 0112 2.586L15.414 6A2 2 0 0116 7.414V16a2 2 0 01-2 2H6a2 2 0 01-2-2V4zm2 6a1 1 0 011-1h6a1 1 0 110 2H7a1 1 0 01-1-1zm1 3a1 1 0 100 2h6a1 1 0 100-2H7z",clipRule:"evenodd",className:"jsx-ac8ffe8bfad96ef1"})}),(0,r.jsx)("span",{className:"jsx-ac8ffe8bfad96ef1 text-sm font-medium text-gray-700 dark:text-gray-300 truncate",children:c}),b.hasOwnProperty(c)&&(0,r.jsx)("div",{title:"File has unsaved changes",className:"jsx-ac8ffe8bfad96ef1 w-2 h-2 bg-orange-500 rounded-full ml-2 flex-shrink-0"})]})})}),(0,r.jsx)("div",{className:"jsx-ac8ffe8bfad96ef1 flex-1 min-h-0",children:x?(0,r.jsx)("div",{className:"jsx-ac8ffe8bfad96ef1 flex items-center justify-center h-full",children:(0,r.jsx)("p",{className:"jsx-ac8ffe8bfad96ef1 text-gray-500 dark:text-gray-400",children:"Loading..."})}):c?(0,r.jsx)(C.Ay,{height:"100%",language:c.endsWith(".js")||c.endsWith(".jsx")?"javascript":c.endsWith(".ts")||c.endsWith(".tsx")?"typescript":c.endsWith(".html")?"html":c.endsWith(".css")?"css":c.endsWith(".json")?"json":c.endsWith(".sol")?"typescript":"plaintext",value:R||u,theme:"vs-dark",options:{readOnly:!1,minimap:{enabled:!1},scrollBeyondLastLine:!1,fontSize:14,wordWrap:"on",automaticLayout:!0,tabSize:2,insertSpaces:!0,detectIndentation:!1,folding:!0,stickyScroll:{enabled:!1},lineNumbers:"on",glyphMargin:!1,contextmenu:!0,quickSuggestions:!1,suggestOnTriggerCharacters:!1,acceptSuggestionOnEnter:"off",hover:{enabled:!0},parameterHints:{enabled:!0}},onChange:e=>{e!==u?v(t=>({...t,[c]:e||""})):v(e=>{let{[c]:t,...s}=e;return s})},onMount:e=>{B.current=e},beforeMount:e=>{e.languages.typescript.typescriptDefaults.setCompilerOptions({target:e.languages.typescript.ScriptTarget.ES2020,allowNonTsExtensions:!0,allowJs:!0,checkJs:!1,moduleResolution:e.languages.typescript.ModuleResolutionKind.NodeJs,module:e.languages.typescript.ModuleKind.ESNext,noEmit:!0,esModuleInterop:!0,jsx:e.languages.typescript.JsxEmit.React,allowSyntheticDefaultImports:!0,forceConsistentCasingInFileNames:!1,skipLibCheck:!0,skipDefaultLibCheck:!0,noImplicitAny:!1,noImplicitReturns:!1,noImplicitThis:!1,strictNullChecks:!1,suppressImplicitAnyIndexErrors:!0}),e.languages.typescript.javascriptDefaults.setCompilerOptions({target:e.languages.typescript.ScriptTarget.ES2020,allowNonTsExtensions:!0,allowJs:!0,checkJs:!1,moduleResolution:e.languages.typescript.ModuleResolutionKind.NodeJs,module:e.languages.typescript.ModuleKind.ESNext,noEmit:!0,esModuleInterop:!0,jsx:e.languages.typescript.JsxEmit.React,allowSyntheticDefaultImports:!0}),e.languages.typescript.typescriptDefaults.setDiagnosticsOptions({noSemanticValidation:!1,noSyntaxValidation:!1,noSuggestionDiagnostics:!0,diagnosticCodesToIgnore:[1003,1108,1109,1011,1005,1128,1144,1228,1381,1382,1434,1435,8006,8008,8009,8010,8013,8016,8037,17008]}),e.languages.typescript.javascriptDefaults.setDiagnosticsOptions({noSemanticValidation:!1,noSyntaxValidation:!1,noSuggestionDiagnostics:!0}),e.languages.json.jsonDefaults.setDiagnosticsOptions({validate:!1,allowComments:!0,schemas:[],enableSchemaRequest:!1,schemaRequest:"ignore"})}}):(0,r.jsx)("div",{className:"jsx-ac8ffe8bfad96ef1 flex items-center justify-center h-full",children:(0,r.jsx)("p",{className:"jsx-ac8ffe8bfad96ef1 text-gray-500 dark:text-gray-400",children:"Select a file to view its content"})})})]})]})]}):(0,r.jsx)("div",{className:"flex items-center justify-center h-full w-full bg-gray-100 dark:bg-gray-800",children:(0,r.jsx)("p",{className:"text-gray-500 dark:text-gray-400",children:"No code generated yet"})})}var E=s(28662),D=s(22172),T=s(25781),I=s(78992),A=s(2352);function L(e){let{testId:t,oldText:s="",newText:r="",lineHint:a,fileContent:n}=e;if(!n)return{success:!1,error:"File content is required"};try{let e=D.parse(n,{sourceType:"module",plugins:["jsx","typescript","decorators-legacy","classProperties","optionalChaining","nullishCoalescingOperator","exportDefaultFrom","dynamicImport"]}),o=!1,l="";if(t&&(0,T.default)(e,{JSXOpeningElement(e){if(e.node.attributes.some(e=>{var s;return A.isJSXAttribute(e)&&(null===(s=e.name)||void 0===s?void 0:s.name)==="data-testid"&&A.isStringLiteral(e.value)&&e.value.value===t})){let t=e.parent;A.isJSXElement(t)&&(t.children=t.children.map(e=>{if(A.isJSXText(e)&&e.value.trim()===s){o=!0,l="jsx-text-by-testid";let e=A.jsxText(r);return e.value=r,e}return e}),t.children.forEach((e,t)=>{A.isJSXExpressionContainer(e)&&A.isStringLiteral(e.expression)&&e.expression.value===s&&(e.expression.value=r,o=!0,l="jsx-expression-by-testid")}))}}}),o||(0,T.default)(e,{StringLiteral(e){if(e.node.value===s){var t;(!a||10>Math.abs(((null===(t=e.node.loc)||void 0===t?void 0:t.start.line)||0)-a))&&(e.node.value=r,o=!0,l="string-literal",e.stop())}}}),o||(0,T.default)(e,{JSXText(e){e.node.value.trim()===s&&(e.node.value=r,o=!0,l="jsx-text",e.stop())}}),o||(0,T.default)(e,{TemplateLiteral(e){let t=e.node.quasis.map(e=>e.value.raw).join("${...}");(t===s||t.includes(s))&&1===e.node.quasis.length&&e.node.quasis[0].value.raw===s&&(e.node.quasis[0].value.raw=r,e.node.quasis[0].value.cooked=r,o=!0,l="template-literal",e.stop())}}),o||(0,T.default)(e,{VariableDeclarator(e){A.isStringLiteral(e.node.init)&&e.node.init.value===s&&(e.node.init.value=r,o=!0,l="variable-declaration",e.stop())}}),o||(0,T.default)(e,{ObjectProperty(e){A.isStringLiteral(e.node.value)&&e.node.value.value===s&&(e.node.value.value=r,o=!0,l="object-property",e.stop())}}),o){(0,T.default)(e,{JSXOpeningElement(e){e.node.attributes=e.node.attributes.filter(e=>{var t;return!(A.isJSXAttribute(e)&&(null===(t=e.name)||void 0===t?void 0:t.name)==="data-testid")})}});let t=(0,I.default)(e,{retainLines:!1,compact:!1,concise:!1});return{success:!0,updatedContent:t.code,strategy:l}}return{success:!1,error:"Text not found in file - AST could not locate the specified text"}}catch(e){return console.error("AST parsing error:",e),{success:!1,error:"Parse error: ".concat(e instanceof Error?e.message:"Unknown error")}}}function P(e,t){let s=e.split(/\s+/).filter(e=>e.length>0),r=[],a=!1,n=!1,o=!1,l=!1,i=!1,c=!1,d=!1;for(let e of s){let s=!0;void 0!==t.textColorClass&&e.match(/^text-(.*?)(-\d{2,3})?$/)?(a||(t.textColorClass&&r.push(t.textColorClass),a=!0),s=!1):void 0!==t.bgColorClass&&e.match(/^bg-(.*?)(-\d{2,3})?$/)?(n||(t.bgColorClass&&r.push(t.bgColorClass),n=!0),s=!1):void 0!==t.textSizeClass&&e.match(/^text-(xs|sm|base|lg|xl|\dxl)$/)?(o||(t.textSizeClass&&r.push(t.textSizeClass),o=!0),s=!1):void 0!==t.paddingClasses&&e.match(/^p[xy]?-/)?(s=!1,l||(l=!0)):void 0!==t.marginClasses&&e.match(/^m[xy]?-/)?(s=!1,i||(i=!0)):void 0!==t.widthClass&&e.match(/^w-/)?(c||(t.widthClass&&r.push(t.widthClass),c=!0),s=!1):void 0!==t.heightClass&&e.match(/^h-/)&&(d||(t.heightClass&&r.push(t.heightClass),d=!0),s=!1),s&&r.push(e)}return!a&&t.textColorClass&&r.push(t.textColorClass),!n&&t.bgColorClass&&r.push(t.bgColorClass),!o&&t.textSizeClass&&r.push(t.textSizeClass),!l&&t.paddingClasses?r.push(...t.paddingClasses):l&&t.paddingClasses&&r.push(...t.paddingClasses),!i&&t.marginClasses?r.push(...t.marginClasses):i&&t.marginClasses&&r.push(...t.marginClasses),!c&&t.widthClass&&r.push(t.widthClass),!d&&t.heightClass&&r.push(t.heightClass),r.join(" ")}let M=null;function O(e){let{files:t,projectId:s,onInspectorClick:n,onFileUpdate:o,onUnsavedChangesUpdate:l,inspectorMode:i,setInspectorMode:c,previewMode:d="desktop",refreshKey:u}=e,[m,x]=(0,a.useState)(""),[p,h]=(0,a.useState)("Initializing..."),[g,f]=(0,a.useState)(""),[y,b]=(0,a.useState)(i||!1),v=void 0!==i?i:y,j=c||b,[w,N]=(0,a.useState)(null),[k,C]=(0,a.useState)(""),[S,O]=(0,a.useState)(!1),[_,B]=(0,a.useState)(null),[R,F]=(0,a.useState)(t),[U,z]=(0,a.useState)(!1),W=(0,a.useRef)(null),[G,J]=(0,a.useState)("text"),[H,V]=(0,a.useState)(""),[q,Y]=(0,a.useState)(""),[K,X]=(0,a.useState)(""),[$,Q]=(0,a.useState)(""),[Z,ee]=(0,a.useState)("");(0,a.useEffect)(()=>{F(t)},[t]);let et=(0,a.useMemo)(()=>{let e={};return Object.keys(R).forEach(s=>{R[s]!==t[s]&&(e[s]=R[s])}),e},[R,t]);(0,a.useEffect)(()=>{let e=Object.keys(et).length>0;z(e),l&&l(e,et)},[et]),(0,a.useEffect)(()=>{o&&o(R)},[R]);let es=(0,a.useCallback)(async()=>{M||(M=E.initialize({wasmURL:"https://static.famous.ai/esbuild.wasm"}));try{await M}catch(e){throw e}},[]),er=async(e,t,s)=>{try{let r=D.parse(e,{sourceType:"module",plugins:["jsx","typescript","decorators-legacy","classProperties","optionalChaining","nullishCoalescingOperator","exportDefaultFrom","dynamicImport"]}),a=0,n={},o=0;(0,T.default)(r,{JSXElement(e){let s=e.node,r=s.openingElement,l="unknown";A.isJSXIdentifier(r.name)&&(l=r.name.name),s.children.forEach((e,s)=>{var i,c,d,u,m,x,p,h,g,f,y,b;if(A.isJSXText(e)&&e.value.trim()){let s="".concat(t,"_text_").concat(a++),u=e.value.trim(),m={type:"literal",value:u,file:t,line:(null===(i=e.loc)||void 0===i?void 0:i.start.line)||0,column:(null===(c=e.loc)||void 0===c?void 0:c.start.column)||0,parent:l};o++,n[s]=m;let x=A.jsxAttribute(A.jsxIdentifier("data-text-source"),A.jsxExpressionContainer(A.stringLiteral(JSON.stringify({id:s,type:"literal",value:e.value.trim(),file:t,line:(null===(d=e.loc)||void 0===d?void 0:d.start.line)||0}))));r.attributes.some(e=>A.isJSXAttribute(e)&&"data-text-source"===e.name.name)||r.attributes.push(x)}else if(A.isJSXExpressionContainer(e)){let s=e.expression,o="".concat(t,"_expr_").concat(a++),l=null;if(A.isIdentifier(s)?(l={type:"variable",varName:s.name,file:t,line:(null===(u=s.loc)||void 0===u?void 0:u.start.line)||0,column:(null===(m=s.loc)||void 0===m?void 0:m.start.column)||0},e.expression=A.callExpression(A.memberExpression(A.memberExpression(A.identifier("window"),A.identifier("__famousTrack")),A.identifier("var")),[s,A.stringLiteral(o),A.stringLiteral(t),A.numericLiteral((null===(x=s.loc)||void 0===x?void 0:x.start.line)||0)])):A.isStringLiteral(s)?(l={type:"literal",value:s.value,file:t,line:(null===(p=s.loc)||void 0===p?void 0:p.start.line)||0,column:(null===(h=s.loc)||void 0===h?void 0:h.start.column)||0},e.expression=A.callExpression(A.memberExpression(A.memberExpression(A.identifier("window"),A.identifier("__famousTrack")),A.identifier("literal")),[s,A.stringLiteral(o),A.stringLiteral(t),A.numericLiteral((null===(g=s.loc)||void 0===g?void 0:g.start.line)||0)])):A.isTemplateLiteral(s)&&(l={type:"template",file:t,line:(null===(f=s.loc)||void 0===f?void 0:f.start.line)||0,column:(null===(y=s.loc)||void 0===y?void 0:y.start.column)||0},e.expression=A.callExpression(A.memberExpression(A.memberExpression(A.identifier("window"),A.identifier("__famousTrack")),A.identifier("template")),[s,A.stringLiteral(o),A.stringLiteral(t),A.numericLiteral((null===(b=s.loc)||void 0===b?void 0:b.start.line)||0)])),l){n[o]=l;let e=A.jsxAttribute(A.jsxIdentifier("data-text-source"),A.jsxExpressionContainer(A.stringLiteral(JSON.stringify(l))));r.attributes.some(e=>A.isJSXAttribute(e)&&"data-text-source"===e.name.name)||r.attributes.push(e)}}})},VariableDeclarator(e){if(A.isIdentifier(e.node.id)&&e.node.init){let o=e.node.id.name;if(A.isStringLiteral(e.node.init)){var r,a;let l="".concat(t,"_var_").concat(o),i={type:"variable",value:e.node.init.value,varName:o,file:t,line:(null===(r=e.node.loc)||void 0===r?void 0:r.start.line)||0,column:(null===(a=e.node.loc)||void 0===a?void 0:a.start.column)||0};n[l]=i,s&&(s["var_".concat(o,"_").concat(t)]=i)}}}});let l=(0,I.default)(r,{retainLines:!1,compact:!1,concise:!1}),i=JSON.stringify(n).replace(/`/g,"\\`").replace(/\${/g,"\\${");return"\n// Famous Text Tracker Runtime\nif (typeof window !== 'undefined' && !window.__famousTrack) {\n  window.__famousTextSources = window.__famousTextSources || {};\n  Object.assign(window.__famousTextSources, ".concat(i,");\n  \n  window.__famousTrack = {\n    var: (value, id, file, line) => {\n      if (typeof window.__famousTextMap === 'undefined') {\n        window.__famousTextMap = new Map();\n      }\n      window.__famousTextMap.set(id, { value, file, line, type: 'variable' });\n      return value;\n    },\n    literal: (value, id, file, line) => {\n      if (typeof window.__famousTextMap === 'undefined') {\n        window.__famousTextMap = new Map();\n      }\n      window.__famousTextMap.set(id, { value, file, line, type: 'literal' });\n      return value;\n    },\n    template: (value, id, file, line) => {\n      if (typeof window.__famousTextMap === 'undefined') {\n        window.__famousTextMap = new Map();\n      }\n      window.__famousTextMap.set(id, { value, file, line, type: 'template' });\n      return value;\n    }\n  };\n}\n")+"\n"+l.code}catch(t){return e}},ea=(0,a.useCallback)(async e=>{let t={},s={...e},r=0;for(let[a,n]of(Object.keys(e).filter(e=>(e.startsWith("/")?e.slice(1):e).match(/\.(jsx|tsx)$/)),Object.entries(e)))if((a.startsWith("/")?a.slice(1):a).match(/\.(jsx|tsx)$/)&&n&&n.includes("<")&&(n.includes("/>")||n.includes("</")))try{let e=D.parse(n,{sourceType:"module",plugins:["jsx","typescript","decorators-legacy","classProperties","optionalChaining","nullishCoalescingOperator","exportDefaultFrom","exportNamespaceFrom","dynamicImport"]}),o=!1,l=0,i=0;if((0,T.default)(e,{JSXOpeningElement(e){var s,n,c,d,u,m;if(i++,A.isJSXFragment(e.parent)||!e.node.name)return;if(e.node.attributes.some(e=>A.isJSXAttribute(e)&&A.isJSXIdentifier(e.name)&&"data-testid"===e.name.name)){let s=null===(d=e.node.attributes.find(e=>A.isJSXAttribute(e)&&A.isJSXIdentifier(e.name)&&"data-testid"===e.name.name))||void 0===d?void 0:null===(c=d.value)||void 0===c?void 0:c.value;if(s&&"string"==typeof s){let r="unknown";A.isJSXIdentifier(e.node.name)?r=e.node.name.name:A.isJSXMemberExpression(e.node.name)&&(r="".concat(e.node.name.object.name,".").concat(e.node.name.property.name)),t[s]={file:a,line:(null===(u=e.node.loc)||void 0===u?void 0:u.start.line)||0,column:(null===(m=e.node.loc)||void 0===m?void 0:m.start.column)||0,tagName:r,fileIndex:l++},i++}return}let x="unknown";A.isJSXIdentifier(e.node.name)?x=e.node.name.name:A.isJSXMemberExpression(e.node.name)&&(x="".concat(e.node.name.object.name,".").concat(e.node.name.property.name));let p=a.replace(/[^a-z0-9]/gi,"_"),h="famous_".concat(p,"_").concat(l++),g=A.jsxAttribute(A.jsxIdentifier("data-testid"),A.stringLiteral(h));e.node.attributes.push(g),t[h]={file:a,line:(null===(s=e.node.loc)||void 0===s?void 0:s.start.line)||0,column:(null===(n=e.node.loc)||void 0===n?void 0:n.start.column)||0,tagName:x,fileIndex:l-1},o=!0,r++}}),o){let t=(0,I.default)(e,{retainLines:!1,compact:!1,concise:!1});s[a]=t.code}}catch(e){e.loc&&n.split("\n")[e.loc.line-1]}return{inspectorFiles:s,inspectorMap:t}},[]),en=(0,a.useCallback)(async e=>{let t=JSON.stringify(e,null,2).replace(/`/g,"\\`").replace(/\${/g,"\\${");return"\n    <script>\n      // Famous.ai Inspector Mode for ESM Preview with Text Tracking\n      const shouldRunInspector = true; // Always run in preview\n      \n      try {\n        if (shouldRunInspector) {\n        \n        // Embedded inspector map\n        const inspectorMap = ".concat(t,";\n        \n        let inspectorEnabled = false;\n        let currentElement = null;\n        let isEditing = false;\n        \n        // Listen for inspector mode toggle from parent\n        window.addEventListener('message', function(e) {\n          if (e.data && e.data.type === 'famous-inspector-toggle') {\n            inspectorEnabled = e.data.enabled;\n            \n            if (!window.inspectorInitialized) {\n              initInspector();\n            }\n            \n            if (window.inspectorInitialized) {\n              toggleInspectorVisual(inspectorEnabled);\n            }\n          } else if (e.data && e.data.type === 'famous-editor-closed') {\n            isEditing = false;\n          }\n        });\n        \n        // Toggle inspector visual effects\n        function toggleInspectorVisual(enabled) {\n          const hoverBox = document.getElementById('famous-inspector-hover-box');\n          const tooltip = document.getElementById('famous-inspector-tooltip');\n          \n          \n          if (enabled) {\n            document.body.style.cursor = 'crosshair';\n            // Show default tooltip when inspector is enabled\n            if (tooltip) {\n              tooltip.textContent = 'Click on text to edit';\n              tooltip.style.setProperty('display', 'block', 'important');\n              tooltip.style.setProperty('left', '20px', 'important');\n              tooltip.style.setProperty('top', '20px', 'important');\n            } else {\n            }\n          } else {\n            document.body.style.cursor = '';\n            if (hoverBox) hoverBox.style.display = 'none';\n            if (tooltip) tooltip.style.display = 'none';\n            currentElement = null;\n          }\n        }\n        \n        // Check if element has editable text content\n        function hasEditableText(element) {\n          if (!element) return false;\n          \n          const tagName = element.tagName.toUpperCase();\n          \n          // Check if element has child elements\n          const hasChildElements = element.children && element.children.length > 0;\n          const hasDirectText = element.childNodes && Array.from(element.childNodes).some(node => \n            node.nodeType === Node.TEXT_NODE && node.textContent.trim()\n          );\n          \n          \n          // Always allow text elements, even with formatting children (span, em, strong)\n          const textTags = ['H1', 'H2', 'H3', 'H4', 'H5', 'H6', 'P', 'A', 'BUTTON', 'LABEL'];\n          if (textTags.includes(tagName) && element.textContent.trim()) {\n            return true;\n          }\n          \n          // For SPAN elements, be more careful about mixed content\n          if (tagName === 'SPAN') {\n            // SPAN with only text or only formatting children is editable\n            if (hasDirectText && !hasChildElements) {\n              console.log('\uD83D\uDD0D EDITABLE_CHECK: SPAN with direct text - EDITABLE');\n              return true;\n            }\n            // SPAN with child elements might be mixed content\n            if (hasChildElements) {\n              console.log('\uD83D\uDD0D EDITABLE_CHECK: SPAN with children - NOT EDITABLE');\n              return false;\n            }\n          }\n          \n          // Check for direct text content only (no child elements)\n          if (hasDirectText && !hasChildElements) {\n            console.log('\uD83D\uDD0D EDITABLE_CHECK:', tagName, 'has direct text, no children - EDITABLE');\n            return true;\n          }\n          \n          console.log('\uD83D\uDD0D EDITABLE_CHECK:', tagName, 'default case - NOT EDITABLE');\n          return false;\n        }\n        \n        // Get editable text from element\n        function getEditableText(element) {\n          // Try direct text nodes first\n          for (let node of element.childNodes) {\n            if (node.nodeType === Node.TEXT_NODE) {\n              const text = node.textContent.trim();\n              if (text) return text;\n            }\n          }\n          \n          // Fallback to full text content\n          return element.textContent ? element.textContent.trim() : '';\n        }\n        \n        // Initialize inspector\n        function initInspector() {\n          console.log('\uD83D\uDD0D INSP_DEBUG: Inspector initializing...');\n          window.inspectorInitialized = true;\n          \n          // Create styles\n          console.log('\uD83D\uDD0D INSP_DEBUG: Creating styles...');\n          const style = document.createElement('style');\n          style.textContent = \n            '#famous-inspector-hover-box {' +\n            '  position: fixed !important;' +\n            '  pointer-events: none !important;' +\n            '  border: 2px solid #3B82F6 !important;' +\n            '  background: rgba(59, 130, 246, 0.15) !important;' +\n            '  z-index: 2147483646 !important;' +\n            '  transition: all 0.1s ease !important;' +\n            '  box-shadow: 0 0 0 1px rgba(59, 130, 246, 0.4) !important;' +\n            '  display: none;' +\n            '}' +\n            '#famous-inspector-tooltip {' +\n            '  position: fixed !important;' +\n            '  background: #1f2937 !important;' +\n            '  color: white !important;' +\n            '  padding: 8px 12px !important;' +\n            '  border-radius: 8px !important;' +\n            '  font-size: 12px !important;' +\n            '  font-family: -apple-system, BlinkMacSystemFont, \"Segoe UI\", Roboto, sans-serif !important;' +\n            '  z-index: 2147483647 !important;' +\n            '  pointer-events: none !important;' +\n            '  box-shadow: 0 4px 12px rgba(0,0,0,0.3) !important;' +\n            '  display: none;' +\n            '  white-space: nowrap !important;' +\n            '  max-width: 300px !important;' +\n            '  line-height: 1.4 !important;' +\n            '}';\n          document.head.appendChild(style);\n          console.log('\uD83D\uDD0D INSP_DEBUG: Styles appended to head');\n          \n          // Create hover box\n          console.log('\uD83D\uDD0D INSP_DEBUG: Creating hover box...');\n          const hoverBox = document.createElement('div');\n          hoverBox.id = 'famous-inspector-hover-box';\n          document.body.appendChild(hoverBox);\n          console.log('\uD83D\uDD0D INSP_DEBUG: Hover box created and appended');\n          \n          // Create tooltip with explicit styling\n          console.log('\uD83D\uDD0D INSP_DEBUG: Creating tooltip...');\n          const tooltip = document.createElement('div');\n          tooltip.id = 'famous-inspector-tooltip';\n          tooltip.textContent = 'Click on text to edit';\n          \n          // Force explicit styles\n          tooltip.style.setProperty('position', 'fixed', 'important');\n          tooltip.style.setProperty('background', '#1f2937', 'important');\n          tooltip.style.setProperty('color', 'white', 'important');\n          tooltip.style.setProperty('padding', '8px 12px', 'important');\n          tooltip.style.setProperty('border-radius', '8px', 'important');\n          tooltip.style.setProperty('font-size', '12px', 'important');\n          tooltip.style.setProperty('font-family', '-apple-system, BlinkMacSystemFont, \"Segoe UI\", Roboto, sans-serif', 'important');\n          tooltip.style.setProperty('z-index', '2147483647', 'important');\n          tooltip.style.setProperty('pointer-events', 'none', 'important');\n          tooltip.style.setProperty('box-shadow', '0 4px 12px rgba(0,0,0,0.3)', 'important');\n          tooltip.style.setProperty('display', 'none', 'important');\n          tooltip.style.setProperty('left', '20px', 'important');\n          tooltip.style.setProperty('top', '20px', 'important');\n          \n          document.body.appendChild(tooltip);\n          console.log('\uD83D\uDD0D INSP_DEBUG: Tooltip created and appended');\n          console.log('\uD83D\uDD0D INSP_DEBUG: Tooltip element:', tooltip);\n          console.log('\uD83D\uDD0D INSP_DEBUG: Tooltip computed styles:', window.getComputedStyle(tooltip));\n          \n          \n          // Track mouse movement - highlight elements with data-testid\n          console.log('\uD83D\uDD0D INSP_DEBUG: Adding mousemove event listener');\n          document.addEventListener('mousemove', (e) => {\n            if (!inspectorEnabled || isEditing) {\n              if (!inspectorEnabled) {\n                console.log('\uD83D\uDD0D INSP_DEBUG: Mouse move but inspector not enabled');\n              }\n              if (isEditing) {\n                console.log('\uD83D\uDD0D INSP_DEBUG: Mouse move but currently editing');\n              }\n              hoverBox.style.display = 'none';\n              tooltip.style.display = 'none';\n              return;\n            }\n            \n            // Update tooltip position and make sure it's visible\n            tooltip.style.setProperty('left', (e.clientX + 12) + 'px', 'important');\n            tooltip.style.setProperty('top', (e.clientY - 30) + 'px', 'important');\n            tooltip.style.setProperty('display', 'block', 'important');\n            tooltip.textContent = 'Click on text to edit';\n            \n            // Find element with data-testid, prioritizing text-bearing elements\n            let element = e.target;\n            let searchSteps = 0;\n            let foundElements = [];\n            \n            // Collect all elements with testid in the hierarchy\n            let currentElement = element;\n            while (currentElement && currentElement !== document.body) {\n              if (currentElement.dataset && currentElement.dataset.testid) {\n                foundElements.push({\n                  element: currentElement,\n                  testid: currentElement.dataset.testid,\n                  steps: searchSteps\n                });\n              }\n              currentElement = currentElement.parentElement;\n              searchSteps++;\n            }\n            \n            // Prioritize text-bearing elements over containers\n            let bestElement = null;\n            for (const candidate of foundElements) {\n              const el = candidate.element;\n              \n              // Check if this element has direct text content (not just from children)\n              const hasDirectText = el.childNodes && Array.from(el.childNodes).some(node => \n                node.nodeType === Node.TEXT_NODE && node.textContent.trim()\n              );\n              \n              // Check if it's a text-bearing element type\n              const isTextElement = ['h1', 'h2', 'h3', 'h4', 'h5', 'h6', 'p', 'span', 'a', 'button', 'label', 'strong', 'em'].includes(\n                el.tagName.toLowerCase()\n              );\n              \n              // Prefer elements with direct text or text element types\n              if (hasDirectText || isTextElement) {\n                bestElement = candidate;\n                break; // Take the first (closest to click) text element\n              }\n              \n              // If no text elements found, use the closest one as fallback\n              if (!bestElement) {\n                bestElement = candidate;\n              }\n            }\n            \n            if (bestElement) {\n              element = bestElement.element;\n              console.log('\uD83D\uDD0D Found element with testid after', bestElement.steps, 'steps:', bestElement.testid);\n            } else {\n              element = null;\n            }\n            \n            if (element && element.dataset && element.dataset.testid) {\n              // Skip if element is not editable\n              if (!hasEditableText(element)) {\n                console.log('\uD83D\uDD0D HOVER: Skipping non-editable element:', element.tagName, element.dataset.testid);\n                currentElement = null;\n                hoverBox.style.display = 'none';\n                // Keep tooltip visible with default message for non-editable elements\n                tooltip.style.setProperty('display', 'block', 'important');\n                tooltip.textContent = 'Click on text to edit';\n                return;\n              }\n              \n              if (currentElement !== element) {\n                currentElement = element;\n                const rect = element.getBoundingClientRect();\n                const testId = element.dataset.testid;\n                const mapData = inspectorMap[testId];\n                console.log('\uD83D\uDD0D Hover - testId:', testId, 'mapData:', mapData);\n                \n                // Update hover box\n                hoverBox.style.display = 'block';\n                hoverBox.style.left = (rect.left - 2) + 'px';\n                hoverBox.style.top = (rect.top - 2) + 'px';\n                hoverBox.style.width = (rect.width + 4) + 'px';\n                hoverBox.style.height = (rect.height + 4) + 'px';\n                \n                // Update tooltip\n                tooltip.style.display = 'block';\n                \n                const elementText = getEditableText(element);\n                let tooltipContent = '';\n                \n                if (elementText) {\n                  const maxLength = 45;\n                  let displayText = elementText.trim();\n                  if (displayText.length > maxLength) {\n                    displayText = displayText.substring(0, maxLength);\n                    const lastSpace = displayText.lastIndexOf(' ');\n                    if (lastSpace > maxLength * 0.6) {\n                      displayText = displayText.substring(0, lastSpace);\n                    }\n                    displayText += '...';\n                  }\n                  tooltipContent = '\"' + displayText + '\"';\n                } else {\n                  tooltipContent = 'Text element';\n                }\n                \n                if (hasEditableText(element)) {\n                  tooltipContent += '<br><small style=\"color:#10b981;\">Click to edit • Escape to cancel</small>';\n                } else {\n                  tooltipContent += '<br><small style=\"color:#8b5cf6;\">Click to select • Escape to cancel</small>';\n                }\n                tooltip.innerHTML = tooltipContent;\n              }\n            } else {\n              currentElement = null;\n              hoverBox.style.display = 'none';\n              // Keep tooltip visible with default message\n              tooltip.style.setProperty('display', 'block', 'important');\n              tooltip.textContent = 'Click on text to edit';\n            }\n          });\n          \n          // Handle clicks to inspect/edit elements\n          document.addEventListener('click', (e) => {\n            if (!inspectorEnabled || isEditing) return;\n            \n            // Find element with data-testid using the same smart logic as hover\n            let element = e.target;\n            let searchSteps = 0;\n            let foundElements = [];\n            \n            // Collect all elements with testid in the hierarchy\n            let currentElement = element;\n            while (currentElement && currentElement !== document.body) {\n              if (currentElement.dataset && currentElement.dataset.testid) {\n                foundElements.push({\n                  element: currentElement,\n                  testid: currentElement.dataset.testid,\n                  steps: searchSteps\n                });\n              }\n              currentElement = currentElement.parentElement;\n              searchSteps++;\n            }\n            \n            // Use the same prioritization logic as hover\n            let bestElement = null;\n            for (const candidate of foundElements) {\n              const el = candidate.element;\n              \n              // Check if this element has direct text content (not just from children)\n              const hasDirectText = el.childNodes && Array.from(el.childNodes).some(node => \n                node.nodeType === Node.TEXT_NODE && node.textContent.trim()\n              );\n              \n              // Check if it's a text-bearing element type\n              const isTextElement = ['h1', 'h2', 'h3', 'h4', 'h5', 'h6', 'p', 'span', 'a', 'button', 'label', 'strong', 'em'].includes(\n                el.tagName.toLowerCase()\n              );\n              \n              // Prefer elements with direct text or text element types\n              if (hasDirectText || isTextElement) {\n                bestElement = candidate;\n                break; // Take the first (closest to click) text element\n              }\n              \n              // If no text elements found, use the closest one as fallback\n              if (!bestElement) {\n                bestElement = candidate;\n              }\n            }\n            \n            if (bestElement) {\n              element = bestElement.element;\n            } else {\n              element = null;\n            }\n            \n            if (!element || !element.dataset || !element.dataset.testid) return;\n            \n            // Only allow editing if the element is actually editable\n            if (!hasEditableText(element)) {\n              console.log('\uD83D\uDD0D CLICK: Element not editable, ignoring click:', element.tagName, element.dataset.testid);\n              return;\n            }\n            \n            console.log('\uD83D\uDD0D CLICK: Element is editable, proceeding:', element.tagName, element.dataset.testid);\n            e.preventDefault();\n            e.stopPropagation();\n            e.stopImmediatePropagation();\n            \n            // Send click event to parent to open edit dialog\n            const testId = element.dataset.testid;\n            const mapData = inspectorMap[testId];\n            const elementText = getEditableText(element);\n            \n            // Extract text source information\n            let textSourceData = null;\n            const textSourceAttr = element.getAttribute('data-text-source');\n            if (textSourceAttr) {\n              try {\n                // Decode HTML entities first\n                const decodedAttr = textSourceAttr\n                  .replace(/&quot;/g, '\"')\n                  .replace(/&amp;/g, '&')\n                  .replace(/&lt;/g, '<')\n                  .replace(/&gt;/g, '>')\n                  .replace(/&#39;/g, \"'\");\n                textSourceData = JSON.parse(decodedAttr);\n                console.log('\uD83C\uDFAF Parsed text source:', textSourceData);\n              } catch (e) {\n                console.error('Failed to parse text source:', e, 'Raw:', textSourceAttr);\n              }\n            }\n            \n            // Check runtime text map for additional info\n            let runtimeTextData = null;\n            if (window.__famousTextMap) {\n              // Find text data from runtime map\n              window.__famousTextMap.forEach((value, key) => {\n                if (!runtimeTextData && value.value === elementText) {\n                  runtimeTextData = { id: key, ...value };\n                }\n              });\n            }\n            \n            console.log('\uD83D\uDD0D Click - preparing data:', {\n              testId,\n              mapData,\n              elementText,\n              textSourceData,\n              runtimeTextData,\n              tagName: element.tagName.toLowerCase(),\n              hasEditableText: hasEditableText(element)\n            });\n            \n            // Collect style information\n            const computedStyle = window.getComputedStyle(element);\n            const classList = element.className ? element.className.split(/\\s+/).filter((c) => c) : [];\n            \n            // Extract Tailwind classes\n            const styleData = {\n              // Current computed styles - properly stringified for safe serialization\n              computedTextColor: computedStyle.color || '',\n              computedBgColor: computedStyle.backgroundColor || '',\n              computedFontSize: computedStyle.fontSize || '',\n              computedPadding: {\n                top: computedStyle.paddingTop || '0px',\n                right: computedStyle.paddingRight || '0px',\n                bottom: computedStyle.paddingBottom || '0px',\n                left: computedStyle.paddingLeft || '0px'\n              },\n              computedMargin: {\n                top: computedStyle.marginTop || '0px',\n                right: computedStyle.marginRight || '0px',\n                bottom: computedStyle.marginBottom || '0px',\n                left: computedStyle.marginLeft || '0px'\n              },\n              \n              // Tailwind classes\n              className: element.className || '',\n              textColorClass: classList.find((c) => c.match(/^text-(.*?)(-\\d{2,3})?$/)) || '',\n              bgColorClass: classList.find((c) => c.match(/^bg-(.*?)(-\\d{2,3})?$/)) || '',\n              textSizeClass: classList.find((c) => c.match(/^text-(xs|sm|base|lg|xl|\\dxl)$/)) || '',\n              paddingClasses: classList.filter((c) => c.match(/^p[xy]?-/)),\n              marginClasses: classList.filter((c) => c.match(/^m[xy]?-/)),\n              widthClass: classList.find((c) => c.match(/^w-/)) || '',\n              heightClass: classList.find((c) => c.match(/^h-/)) || '',\n              \n              // Gradient classes\n              gradientClasses: classList.filter((c) => c.match(/^(from|via|to|bg-gradient)-/))\n            };\n            \n            console.log('\uD83D\uDD0D IFRAME DEBUG: inspectorMap keys:', Object.keys(inspectorMap));\n            console.log('\uD83D\uDD0D IFRAME DEBUG: Text tracking data:', { textSourceData, runtimeTextData });\n            console.log('\uD83C\uDFA8 Style data collected:', styleData);\n            \n            // Get element bounds\n            const rect = element.getBoundingClientRect();\n            \n            try {\n              const clickData = {\n                type: 'famous-inspector-click',\n                data: {\n                  testId: testId,\n                  text: elementText,\n                  mapping: mapData,\n                  textSource: textSourceData || runtimeTextData,\n                  bounds: {\n                    top: rect.top,\n                    left: rect.left,\n                    width: rect.width,\n                    height: rect.height,\n                    bottom: rect.bottom,\n                    right: rect.right\n                  },\n                  tagName: element.tagName.toLowerCase(),\n                  hasEditableText: hasEditableText(element),\n                  styleData: styleData\n                }\n              };\n              console.log('\uD83D\uDD0D Sending click data to parent:', clickData);\n              window.parent.postMessage(clickData, '*');\n              console.log('\uD83D\uDD0D Sent inspector click to parent');\n              \n              // Hide hover box when editing starts\n              isEditing = true;\n              if (hoverBox) hoverBox.style.display = 'none';\n              if (tooltip) tooltip.style.display = 'none';\n            } catch (error) {\n              console.error('Failed to send inspector click:', error);\n            }\n            \n            return false;\n          }, true);\n        }\n        \n        // Initialize when DOM is ready\n        console.log('\uD83D\uDD0D INSP_DEBUG: Setting up initialization based on DOM ready state:', document.readyState);\n        if (document.readyState === 'loading') {\n          console.log('\uD83D\uDD0D INSP_DEBUG: DOM still loading, waiting for DOMContentLoaded');\n          document.addEventListener('DOMContentLoaded', initInspector);\n        } else {\n          console.log('\uD83D\uDD0D INSP_DEBUG: DOM ready, initializing inspector in 100ms');\n          setTimeout(initInspector, 100);\n        }\n        }\n      } catch (error) {\n        console.error('\uD83D\uDD0D INSP_DEBUG: Error in inspector script:', error);\n        console.error('\uD83D\uDD0D INSP_DEBUG: Error stack:', error.stack);\n      }\n    <\/script>")},[]),eo=(0,a.useCallback)(async()=>{if(!R||0===Object.keys(R).length){f("No files provided");return}try{var e,t;f(""),h("Initializing esbuild..."),await es();let s=null,r="",a="";for(let e of["tailwind.config.ts","tailwind.config.js","tailwind.config.mjs","src/tailwind.config.ts","src/tailwind.config.js","src/tailwind.config.mjs"])if(R[e]){a=R[e];break}if(a)try{let e=a.replace(/import\s+type\s+\{[^}]+\}\s+from\s+["'][^"']+["'];?\s*/g,"").replace(/import\s+.*?\s+from\s+["'][^"']+["'];?\s*/g,"").replace(/export\s+default\s+/g,"const tailwindConfig = ").replace(/\s+satisfies\s+Config\s*;?$/m,";").replace(/\s+satisfies\s+Config/g,"").replace(/:\s*Config(?=\s*=)/g,"").replace(/\s+satisfies\s+Config/g,"").replace(/plugins:\s*\[[^\]]*\]/g,"plugins: []"),t=(e=e.replace(/\}\s*satisfies\s+Config\s*;?\s*$/,"}")).match(/const\s+tailwindConfig\s*=\s*(\{[\s\S]*\})[\s;]*$/);if(t){let e=t[1];s=e=e.replace(/plugins:\s*\[[^\]]*\]/g,"plugins: []")}}catch(e){console.warn("Could not parse Tailwind config:",e)}for(let[e,t]of Object.entries(R).filter(e=>{let[t]=e;return t.endsWith(".css")})){let e=t.match(/:root\s*\{([^}]+)\}/),s=t.match(/\.dark\s*\{([^}]+)\}/);if(e){let t=e[1].trim();t.endsWith(";")||(t+=";"),r+=":root { ".concat(t," }\n")}if(s){let e=s[1].trim();e.endsWith(";")||(e+=";"),r+=".dark { ".concat(e," }\n")}let a=t.match(/@layer\s+base\s*\{([\s\S]*?)\n\}/g);a&&a.forEach(e=>{let t=e.match(/:root\s*\{([^}]+)\}/);if(t&&!r.includes(t[1])){let e=t[1].trim();e.endsWith(";")||(e+=";"),r+=":root { ".concat(e," }\n")}})}h("Finding entry point...");let n=["src/main.tsx","src/index.tsx","src/App.tsx","main.tsx","index.tsx","App.tsx"],o="",l="";for(let e of n)if(R[e]){o=e,l=R[e];break}if(!l)throw Error("No entry point found. Looking for: ".concat(n.join(", ")));h("Parsing package.json...");let i={};if(R["package.json"])try{let e=JSON.parse(R["package.json"]),t=await fetch("/api/npm/import-map",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({dependencies:e.dependencies||{},devDependencies:e.devDependencies||{}})});t.ok&&(i=(await t.json()).imports)}catch(e){console.warn("Could not generate import map:",e)}h("Injecting inspector support..."),console.log("\uD83D\uDD0D DEBUG: localFiles keys before inspector:",Object.keys(R)),console.log("\uD83D\uDD0D DEBUG: JSX/TSX files in localFiles:",Object.keys(R).filter(e=>e.match(/\.(jsx|tsx)$/))),console.log("\uD83D\uDD0D DEBUG: localFiles sample:",Object.entries(R).slice(0,3).map(e=>{let[t,s]=e;return{path:t,size:s.length,preview:s.substring(0,100)}}));let c=R,d={};try{let e=await ea(R);c=e.inspectorFiles,d=e.inspectorMap,console.log("\uD83D\uDD0D DEBUG: Inspector result - map size:",Object.keys(d).length)}catch(e){console.error("Inspector injection failed:",e)}h("Building with esbuild...");let u=c[o]||l,p=await E.build({stdin:{contents:u,loader:o.endsWith(".tsx")?"tsx":o.endsWith(".ts")?"ts":o.endsWith(".jsx")?"jsx":"js",resolveDir:"/"},format:"esm",bundle:!0,write:!1,jsx:"automatic",platform:"browser",target:"es2020",define:{"process.env.NODE_ENV":'"development"'},plugins:[{name:"virtual-files",setup(e){let t=Object.entries(c).filter(e=>{let[t,s]=e;return"string"==typeof s&&(t.endsWith(".css")||t.includes("index.css")||t.includes("globals.css"))});console.log("\uD83D\uDD0D FOUND CSS FILES:",t.map(e=>{let[t,s]=e;return{path:t,length:s.length,hasTailwind:s.includes("@tailwind"),hasBase:s.includes("@tailwind base"),hasComponents:s.includes("@tailwind components"),hasUtilities:s.includes("@tailwind utilities"),preview:s.substring(0,100)+"..."}})),console.log("\uD83D\uDD0D CSS FILES FULL CONTENT:",t.map(e=>{let[t,s]=e;return{path:t,fullContent:s}}));let s=t.some(e=>{let[t,s]=e;return s.includes("@tailwind")});console.log("\uD83C\uDF0A PROJECT HAS TAILWIND CSS:",s),console.log("\uD83C\uDF0A TAILWIND DETECTION DETAILS:",{totalCSSFiles:t.length,cssFilesWithTailwind:t.filter(e=>{let[t,s]=e;return s.includes("@tailwind")}),allCSSFilesContent:t.map(e=>{let[t,s]=e;return{path:t,content:s}})}),s||(c["__tailwind__.css"]="@tailwind base;\\n@tailwind components;\\n@tailwind utilities;"),e.onResolve({filter:/.*/},e=>{if(!e.path.startsWith(".")&&!e.path.startsWith("@/")&&!e.path.startsWith("/")&&!e.path.endsWith(".css")&&!e.path.endsWith(".scss"))return{path:e.path,external:!0};if(e.path.endsWith(".css")||e.path.endsWith(".scss")||e.path.includes("index.css")){console.log("  → CSS FILE DETECTED: ".concat(e.path));let t=[e.path,"src/".concat(e.path),e.path.replace("@/","src/"),e.path.replace("./","src/")];for(let e of(console.log("  → TRYING CSS VARIATIONS:",t),console.log("  → AVAILABLE FILES FOR CSS MATCHING:",Object.keys(c).filter(e=>e.includes(".css"))),t)){if(c[e])return console.log("  ✅ FOUND CSS FILE: ".concat(e)),console.log("  \uD83D\uDCC4 CSS CONTENT PREVIEW:",c[e].substring(0,200)+"..."),console.log("  \uD83D\uDCC4 CSS FULL CONTENT:",c[e]),{path:e,namespace:"virtual-css"};console.log("  ❌ NOT FOUND: ".concat(e," (file doesn't exist in inspectorFiles)"))}return console.log("  ⚠️ CSS NOT FOUND - Creating empty placeholder: ".concat(e.path)),{path:e.path,namespace:"virtual-css"}}let t=e.importer?e.importer.split("/").slice(0,-1).join("/"):"src",s=[];if(e.path.startsWith("@/")){let t=e.path.replace("@/","src/");s.push(t)}else if(e.path.startsWith("./")){let r=e.path.replace("./",t+"/");s.push(r),s.push(e.path.replace("./","src/"))}else if(e.path.startsWith("../")){let r=t.split("/"),a=e.path.split("/"),n=[...r];for(let e of a)".."===e?n.pop():"."!==e&&n.push(e);s.push(n.join("/"))}else s.push(e.path),s.push("src/".concat(e.path));let r=["",".tsx",".ts",".jsx",".js","/index.tsx","/index.ts","/index.jsx","/index.js"];for(let t of s)for(let s of r){let r=t+s;if(c[r])return console.log("✅ Resolved: ".concat(e.path," -> ").concat(r)),{path:r,namespace:"virtual"}}return console.log("❌ Could not resolve: ".concat(e.path," from ").concat(e.importer||"entry")),console.log("   Tried paths:",s),{path:e.path,external:!0}}),e.onLoad({filter:/.*/,namespace:"virtual-css"},async e=>{let t=c[e.path]||"";console.log("  → CSS CONTENT LENGTH: ".concat(t.length)),console.log('  → CSS CONTENT PREVIEW: "'.concat(t.substring(0,200),'..."')),console.log('  → CSS FULL CONTENT: "'.concat(t,'"')),console.log("  → CSS CONTENT BYTES: [".concat(Array.from(t).map(e=>e.charCodeAt(0)).slice(0,20).join(", "),"]"));let s=t.includes("@tailwind");if(console.log("  → IS TAILWIND CSS: ".concat(s)),console.log("  → TAILWIND DETECTION DETAILS:",{hasAtTailwind:t.includes("@tailwind"),hasTailwindBase:t.includes("@tailwind base"),hasTailwindComponents:t.includes("@tailwind components"),hasTailwindUtilities:t.includes("@tailwind utilities"),contentLines:t.split("\n")}),"src/App.css"===e.path)return console.log("  \uD83D\uDEAB SKIPPING APP.CSS - Contains unwanted #root styles"),{contents:"\n                    // App.css skipped - contains conflicting #root styles\n                    console.log('\uD83D\uDCE6 SKIPPED APP.CSS FILE: ' + ".concat(JSON.stringify(e.path)," + ' - has unwanted root styles');\n                    export default {};\n                  "),loader:"js"};if(s)return console.log("  \uD83C\uDFAE PROCESSING TAILWIND CSS - SKIPPING, PLAY CDN WILL HANDLE IT..."),console.log("  \uD83D\uDE80 SKIPPING CSS INJECTION - Play CDN will auto-generate all Tailwind classes"),{contents:"\n                    // Tailwind CSS file skipped - Play CDN handles all Tailwind classes\n                    console.log('\uD83D\uDCE6 SKIPPED TAILWIND CSS FILE: ' + ".concat(JSON.stringify(e.path)," + ' - Play CDN active');\n                    export default {};\n                  "),loader:"js"};console.log("\uD83D\uDD04 CSS TO JS CONVERSION - Processing ".concat(e.path)),console.log("\uD83D\uDD04 CSS TO JS - Final processedCSS length:",t.length),console.log("\uD83D\uDD04 CSS TO JS - ProcessedCSS preview:",t.substring(0,300)+"...");let r="\n                const css = ".concat(JSON.stringify(t),";\n                console.log('\uD83D\uDCE6 BROWSER CSS INJECTION - Processing CSS from ' + ").concat(JSON.stringify(e.path)," + ':', css.substring(0, 100) + '...');\n                console.log('\uD83D\uDCE6 BROWSER CSS INJECTION - CSS length:', css.length);\n                console.log('\uD83D\uDCE6 BROWSER CSS INJECTION - CSS type:', typeof css);\n                console.log('\uD83D\uDCE6 BROWSER CSS INJECTION - CSS first 500 chars:', css.substring(0, 500));\n                \n                if (css && css.trim()) {\n                  console.log('\uD83D\uDCE6 BROWSER CSS INJECTION - CSS content is valid, proceeding with injection...');\n                  \n                  // Create style element with unique ID to prevent duplicates\n                  const styleId = 'css-").concat(e.path.replace(/[^a-zA-Z0-9]/g,"-"),"';\n                  console.log('\uD83D\uDCE6 BROWSER CSS INJECTION - Style ID:', styleId);\n                  \n                  let style = document.getElementById(styleId);\n                  console.log('\uD83D\uDCE6 BROWSER CSS INJECTION - Existing style element:', style);\n                  \n                  if (!style) {\n                    console.log('\uD83D\uDCE6 BROWSER CSS INJECTION - Creating new style element...');\n                    style = document.createElement('style');\n                    style.id = styleId;\n                    style.setAttribute('data-source', '").concat(e.path,"');\n                    style.setAttribute('data-timestamp', new Date().toISOString());\n                    document.head.appendChild(style);\n                    console.log('\uD83D\uDCE6 BROWSER CSS INJECTION - Style element created and appended to head');\n                  } else {\n                    console.log('\uD83D\uDCE6 BROWSER CSS INJECTION - Updating existing style element');\n                  }\n                  \n                  style.textContent = css;\n                  console.log('✅ BROWSER CSS INJECTION - Injected ' + (").concat(s," ? 'Complete Tailwind' : 'regular') + ' CSS from ' + ").concat(JSON.stringify(e.path),");\n                  console.log('✅ BROWSER CSS INJECTION - Style element content set, length:', style.textContent.length);\n                  console.log('✅ BROWSER CSS INJECTION - Document head contains style:', document.head.contains(style));\n                  \n                  // Verify specific classes are in the injected CSS\n                  console.log('✅ BROWSER CSS VERIFICATION - Checking for gradient classes in injected CSS:');\n                  console.log('  → Contains .bg-gradient-to-r:', css.includes('.bg-gradient-to-r'));\n                  console.log('  → Contains .from-cyan-400:', css.includes('.from-cyan-400'));\n                  console.log('  → Contains .via-purple-400:', css.includes('.via-purple-400'));\n                  console.log('  → Contains .to-pink-400:', css.includes('.to-pink-400'));\n                  console.log('  → Contains .bg-clip-text:', css.includes('.bg-clip-text'));\n                  console.log('  → Contains .text-transparent:', css.includes('.text-transparent'));\n                  console.log('  → Contains .animate-pulse:', css.includes('.animate-pulse'));\n                  console.log('  → Contains .text-6xl:', css.includes('.text-6xl'));\n                  console.log('  → Contains .md\\:text-8xl:', css.includes('.md\\:text-8xl'));\n                  console.log('  → Contains .font-bold:', css.includes('.font-bold'));\n                  \n                  // Log all style elements in document for debugging\n                  const allStyles = Array.from(document.querySelectorAll('style'));\n                  console.log('✅ BROWSER CSS VERIFICATION - All style elements in document:', allStyles.map(s => ({\n                    id: s.id,\n                    source: s.getAttribute('data-source'),\n                    contentLength: s.textContent.length,\n                    timestamp: s.getAttribute('data-timestamp')\n                  })));\n                  \n                } else {\n                  console.log('⚠️ BROWSER CSS INJECTION - Empty CSS content for ' + ").concat(JSON.stringify(e.path),");\n                }\n                \n                export default css;\n              ");return console.log("\uD83D\uDD04 CSS TO JS COMPLETE - Generated JS code length:",r.length),{contents:r,loader:"js"}}),e.onLoad({filter:/.*/,namespace:"virtual"},async e=>{let t=c[e.path];if(!t)return{contents:"",loader:"js"};if(e.path.match(/\.(jsx|tsx)$/))try{console.log("\uD83C\uDFAF Transforming ".concat(e.path," for text tracking")),t=await er(t,e.path,d),console.log("\uD83C\uDFAF Text tracking injected for ".concat(e.path))}catch(t){console.error("Failed to transform ".concat(e.path,":"),t)}t.includes("BrowserRouter")&&(console.log("\uD83D\uDD04 Replacing BrowserRouter with MemoryRouter in ".concat(e.path)),t=(t=t.replace(/import\s*{\s*([^}]*?)BrowserRouter([^}]*?)}\s*from\s*["']react-router-dom["']/g,'import { $1MemoryRouter$2 } from "react-router-dom"')).replace(/BrowserRouter/g,"MemoryRouter")),"src/App.tsx"===e.path&&c["src/App.css"]&&!t.includes("App.css")&&(t="import './App.css';\n".concat(t)),"src/main.tsx"===e.path&&c["styles.css"]&&!t.includes("styles.css")&&(t="import '../styles.css';\n".concat(t)),("src/main.tsx"===e.path||"src/index.tsx"===e.path||"src/App.tsx"===e.path)&&c["__tailwind__.css"]&&!t.includes("__tailwind__.css")?(console.log("\uD83C\uDF0A Auto-importing Tailwind CSS in ".concat(e.path)),console.log("\uD83C\uDF0A AUTO-IMPORT DEBUG - File: ".concat(e.path)),console.log("\uD83C\uDF0A AUTO-IMPORT DEBUG - Has __tailwind__.css file:","__tailwind__.css"in c),console.log("\uD83C\uDF0A AUTO-IMPORT DEBUG - Current content includes __tailwind__.css:",t.includes("__tailwind__.css")),console.log("\uD83C\uDF0A AUTO-IMPORT DEBUG - Original content:",t.substring(0,200)+"..."),t="import './__tailwind__.css';\n".concat(t),console.log("\uD83C\uDF0A AUTO-IMPORT COMPLETE - Modified content:",t.substring(0,200)+"..."),console.log("\uD83C\uDF0A AUTO-IMPORT VERIFICATION - Now includes __tailwind__.css:",t.includes("__tailwind__.css"))):console.log("\uD83C\uDF0A AUTO-IMPORT SKIPPED for ".concat(e.path,":"),{isEntryFile:["src/main.tsx","src/index.tsx","src/App.tsx"].includes(e.path),hasTailwindFile:"__tailwind__.css"in c,alreadyImported:t.includes("__tailwind__.css")});let s=e.path.endsWith(".tsx")?"tsx":e.path.endsWith(".ts")?"ts":e.path.endsWith(".jsx")?"jsx":"js";return{contents:t,loader:s}})}}]}),g=null===(t=p.outputFiles)||void 0===t?void 0:null===(e=t[0])||void 0===e?void 0:e.text;if(!g)throw Error("No build output generated");h("Generating preview..."),console.log("\uD83D\uDD0D INSP_DEBUG: Inspector map keys:",Object.keys(d).slice(0,10)),console.log("\uD83D\uDD0D INSP_DEBUG: Sample inspector map values:",Object.values(d).slice(0,3));let y=await en(d),b=Date.now(),v=Math.random().toString(36).substring(2,15),j='\n<!DOCTYPE html>\n<html lang="en">\n<head>\n  <meta charset="UTF-8">\n  <meta name="viewport" content="width=device-width, initial-scale=1.0">\n  <title>React App Preview</title>\n  \x3c!-- CACHE BUSTER: Build '.concat(v," at ").concat(b," --\x3e\n  <style>\n    body { margin: 0; padding: 0; font-family: system-ui, -apple-system, sans-serif; background: white; }\n    #root { margin: 0; padding: 0; max-width: none; text-align: left; }\n    .loading { \n      display: flex; \n      align-items: center; \n      justify-content: center; \n      height: 100vh; \n    }\n    .spinner { \n      width: 32px; \n      height: 32px; \n      border: 3px solid #f3f3f3; \n      border-top: 3px solid #3b82f6; \n      border-radius: 50%; \n      animation: spin 1s linear infinite; \n    }\n    @keyframes spin { \n      0% { transform: rotate(0deg); } \n      100% { transform: rotate(360deg); } \n    }\n    \n    /* Inject CSS variables for Tailwind custom colors */\n    ").concat(r,"\n  </style>\n  ").concat(Object.keys(i).length>0?'\n  <script type="importmap">\n  '.concat(JSON.stringify({imports:i},null,2),"\n  <\/script>"):"",'\n  \n  \x3c!-- Tailwind Play CDN --\x3e\n  <script src="https://cdn.tailwindcss.com"><\/script>\n  ').concat(s?"\n  <script>\n    // Apply Tailwind configuration\n    tailwind.config = ".concat(s,";\n  <\/script>"):"","\n  \n  \x3c!-- Inspector Script --\x3e\n  ").concat(y,"\n</head>\n<body>\n  <div id=\"root\">\n    <div class=\"loading\">\n      <div class=\"spinner\"></div>\n    </div>\n  </div>\n  <script type=\"module\">\n    console.log('\uD83D\uDE80 Starting React app...');\n    \n    // React Router will handle routing within the blob context\n    \n    // Error handling\n    window.addEventListener('error', (e) => {\n      console.error('Runtime error:', e.error);\n      document.getElementById('root').innerHTML = '<div class=\"loading\" style=\"color: red;\">Error: ' + e.error.message + '</div>';\n    });\n    \n    window.addEventListener('unhandledrejection', (e) => {\n      console.error('Unhandled promise rejection:', e.reason);\n      document.getElementById('root').innerHTML = '<div class=\"loading\" style=\"color: red;\">Promise rejection: ' + e.reason + '</div>';\n    });\n    \n    console.log('\uD83D\uDE80 ABOUT TO EXECUTE USER CODE - Build ID: ' + '").concat(v,"');\n    console.log('\uD83D\uDE80 CACHE BUSTER - Timestamp: ' + '").concat(b,"');\n    console.log('\uD83D\uDE80 USER CODE LENGTH:', ").concat(g.length,");\n    \n    // FORCE RETRIGGER: Build ").concat(v," at ").concat(b,"\n    window.__BUILD_ID__ = '").concat(v,"';\n    window.__BUILD_TIMESTAMP__ = ").concat(b,";\n    \n    \n    // User code\n").concat(g,"\n    \n    console.log('✅ User code executed successfully');\n    \n    // Post-execution CSS verification\n    console.log('\uD83D\uDD0D POST-EXECUTION CSS VERIFICATION:');\n    const allStyleElements = Array.from(document.querySelectorAll('style'));\n    console.log('\uD83D\uDD0D Total style elements:', allStyleElements.length);\n    allStyleElements.forEach((style, index) => {\n      console.log('\uD83D\uDD0D Style element ' + index + ':', {\n        id: style.id,\n        source: style.getAttribute('data-source'),\n        contentLength: style.textContent.length,\n        containsGradient: style.textContent.includes('.bg-gradient-to-r'),\n        containsCyan: style.textContent.includes('.from-cyan-400'),\n        containsPurple: style.textContent.includes('.via-purple-400'),\n        containsPink: style.textContent.includes('.to-pink-400'),\n        contentPreview: style.textContent.substring(0, 200) + '...'\n      });\n    });\n    \n    // Verify DOM elements with gradient classes\n    setTimeout(() => {\n      console.log('\uD83D\uDD0D DOM GRADIENT CLASS VERIFICATION (after 1 second):');\n      const elementsWithGradient = document.querySelectorAll('[class*=\"bg-gradient-to-r\"]');\n      console.log('\uD83D\uDD0D Elements with bg-gradient-to-r:', elementsWithGradient.length);\n      elementsWithGradient.forEach((el, i) => {\n        console.log('\uD83D\uDD0D Gradient element ' + i + ':', {\n          tagName: el.tagName,\n          className: el.className,\n          computedStyle: window.getComputedStyle(el).backgroundImage,\n          element: el\n        });\n      });\n      \n      const elementsWithTextTransparent = document.querySelectorAll('.text-transparent');\n      console.log('\uD83D\uDD0D Elements with text-transparent:', elementsWithTextTransparent.length);\n      elementsWithTextTransparent.forEach((el, i) => {\n        console.log('\uD83D\uDD0D Text-transparent element ' + i + ':', {\n          tagName: el.tagName,\n          className: el.className,\n          computedColor: window.getComputedStyle(el).color,\n          element: el\n        });\n      });\n      \n      const elementsWithClipText = document.querySelectorAll('.bg-clip-text');\n      console.log('\uD83D\uDD0D Elements with bg-clip-text:', elementsWithClipText.length);\n      elementsWithClipText.forEach((el, i) => {\n        console.log('\uD83D\uDD0D Bg-clip-text element ' + i + ':', {\n          tagName: el.tagName,\n          className: el.className,\n          computedClip: window.getComputedStyle(el).webkitBackgroundClip,\n          element: el\n        });\n      });\n      \n      // Check for any elements with the full gradient class combination\n      const fullGradientSelector = '.bg-gradient-to-r.from-cyan-400.via-purple-400.to-pink-400.bg-clip-text.text-transparent';\n      const fullGradientElements = document.querySelectorAll(fullGradientSelector);\n      console.log('\uD83D\uDD0D Elements with full gradient combination:', fullGradientElements.length);\n      \n    }, 1000);\n  <\/script>\n</body>\n</html>");m&&URL.revokeObjectURL(m);let w=j.split("\n");console.log("\uD83D\uDD0D INSP_DEBUG: Generated HTML length:",j.length,"characters"),console.log("\uD83D\uDD0D INSP_DEBUG: Total lines:",w.length),w[3200]&&(console.log("\uD83D\uDD0D INSP_DEBUG: Line 3201 content:",w[3200]),console.log("\uD83D\uDD0D INSP_DEBUG: Line 3201 length:",w[3200].length),w[3200].length>91&&(console.log("\uD83D\uDD0D INSP_DEBUG: Character at position 91:",w[3200].charAt(90)),console.log("\uD83D\uDD0D INSP_DEBUG: Around position 91:",w[3200].substring(85,95)),console.log("\uD83D\uDD0D INSP_DEBUG: Full line segment 80-100:",w[3200].substring(80,100)))),w[3199]&&console.log("\uD83D\uDD0D INSP_DEBUG: Line 3200:",w[3199]),w[3201]&&console.log("\uD83D\uDD0D INSP_DEBUG: Line 3202:",w[3201]);let N=j+"\n\x3c!-- FORCE_REFRESH_".concat(v,"_").concat(b," --\x3e"),k=new Blob([N],{type:"text/html"}),C=URL.createObjectURL(k);if(window.gc)try{window.gc()}catch(e){}x(C),h("Preview ready")}catch(e){console.error("❌ Build failed:",e),f(e.message||"Build failed"),h("Build failed")}},[R,es]),el=(0,a.useCallback)(async e=>{let s=e||w,r=(null==e?void 0:e.newText)||k;if(console.log("\uD83D\uDD0D DEBUG handleUpdateText called with:",{element:s,newText:r,selectedElement:w,editingText:k}),!s){console.error("\uD83D\uDD0D ERROR: No element data provided");return}if(!(null==r?void 0:r.trim())){console.error("\uD83D\uDD0D ERROR: No new text provided");return}O(!0);try{var a,n,o,l;console.log("\uD83D\uDD0D DEBUG: Element mapping:",JSON.stringify(s.mapping)),console.log("\uD83D\uDD0D DEBUG: Text source:",JSON.stringify(s.textSource)),console.log("\uD83D\uDD0D DEBUG: Full element data:",JSON.stringify(s));let e=(null===(a=s.textSource)||void 0===a?void 0:a.file)||(null===(n=s.mapping)||void 0===n?void 0:n.file),i=(null===(o=s.textSource)||void 0===o?void 0:o.line)||(null===(l=s.mapping)||void 0===l?void 0:l.line);if(!e)throw console.error("\uD83D\uDD0D ERROR: No file path found:",JSON.stringify(s)),Error("Cannot determine which file contains this element. Element: ".concat(JSON.stringify(s)));let c=R[e]||t[e];if(!c)throw Error("File ".concat(e," not found in project"));let d=L({testId:s.testId,oldText:s.text,newText:r,lineHint:i,fileContent:c});if(!d.success)throw Error(d.error||"Failed to update text");let u=d.updatedContent||d.content,m={...R,[e]:u},x=(null==u?void 0:u.includes("data-testid"))||!1;console.log("UNSAVED",JSON.stringify({event:"text_updated",file:e,oldText:s.text,newText:r,contentLength:(null==u?void 0:u.length)||0,hasTestIds:x,warning:x?"STORING_INSTRUMENTED_CODE":"clean"})),F(m),N(null),C(""),console.log("\uD83D\uDD0D Text updated, inspector mode should remain:",v)}catch(e){console.error("Failed to update text:",e),alert("Failed to update text: ".concat(e.message))}finally{O(!1)}},[R,w,k,o]);return(0,a.useCallback)(async()=>{if(w){O(!0);try{let e;let{testId:s,mapping:r}=w;if(!r||!r.file)throw Error("No file mapping found for this element");let a=r.file.startsWith("/")?r.file.slice(1):r.file,n=R[a]||t[a];if(!n)throw Error("File ".concat(a," not found in project"));if("text"===G&&k!==w.text)console.log("\uD83D\uDCDD TestId:",s),e=L({testId:s,oldText:w.text||"",newText:k||"",fileContent:n}),console.log("\uD83D\uDCDD Text update result:",e);else if("style"===G)console.log("\uD83C\uDFA8 Updating styles:",{testId:s,textColor:H,bgColor:q,textSize:K,padding:$,margin:Z,fileContent:n?"present":"missing"}),console.log("\uD83C\uDFA8 Sending style update:",{testId:s,textSize:K,textColor:H,bgColor:q}),e=function(e){try{let t=D.parse(e.fileContent,{sourceType:"module",plugins:["jsx","typescript","decorators-legacy","classProperties","optionalChaining","nullishCoalescingOperator","exportDefaultFrom","dynamicImport"]}),s=!1,r=0,a=e.testId.split("_"),n=parseInt(a[a.length-1]),o=0;if((0,T.default)(t,{JSXElement(t){let a=t.node.openingElement;if(o===n){s=!0;let t=a.attributes.find(e=>{var t;return A.isJSXAttribute(e)&&(null===(t=e.name)||void 0===t?void 0:t.name)==="className"});if(t&&A.isJSXAttribute(t)){let s="";if(A.isStringLiteral(t.value)){let a=t.value.value;s=P(a,e),t.value=A.stringLiteral(s),r++}else if(A.isJSXExpressionContainer(t.value)){let a=t.value.expression;if(A.isStringLiteral(a)){let n=a.value;s=P(n,e),t.value.expression=A.stringLiteral(s),r++}else if(A.isTemplateLiteral(a)&&1===a.quasis.length&&0===a.expressions.length){let t=a.quasis[0].value.raw;s=P(t,e),a.quasis[0].value.raw=s,a.quasis[0].value.cooked=s,r++}}}else if(!t){let t=function(e){let t=[];return e.textColorClass&&t.push(e.textColorClass),e.bgColorClass&&t.push(e.bgColorClass),e.textSizeClass&&t.push(e.textSizeClass),e.paddingClasses&&t.push(...e.paddingClasses),e.marginClasses&&t.push(...e.marginClasses),e.widthClass&&t.push(e.widthClass),e.heightClass&&t.push(e.heightClass),t.join(" ")}(e);t&&(a.attributes.push(A.jsxAttribute(A.jsxIdentifier("className"),A.stringLiteral(t))),r++)}}o++}}),!s)return{success:!1,error:'Element with testId "'.concat(e.testId,'" not found')};if(0===r)return{success:!1,error:"No className updates were made"};let{code:l}=(0,I.default)(t,{retainLines:!0,retainFunctionParens:!0,compact:!1,jsescOption:{quotes:"single",minimal:!0}});return{success:!0,content:l}}catch(e){return{success:!1,error:e.message||"Failed to update styles"}}}({testId:s,textColorClass:H||void 0,bgColorClass:q||void 0,textSizeClass:K||void 0,paddingClasses:$?[$]:void 0,marginClasses:Z?[Z]:void 0,fileContent:n}),console.log("\uD83C\uDFA8 Style update result:",e);else{console.log("ℹ️ No changes to apply"),O(!1);return}if(!e||!e.success)throw Error((null==e?void 0:e.error)||"Failed to update");console.log("✅ Update successful:","text"===G?"Text updated":"Styles updated");let l={...R,[a]:e.updatedContent||e.content||n};F(l),o&&(console.log("\uD83D\uDCE4 Calling onFileUpdate with updated files"),o(l)),N(null),C(""),_&&_.contentWindow&&_.contentWindow.postMessage({type:"famous-editor-closed"},"*")}catch(e){console.error("Failed to update styles:",e),alert("Failed to update styles: ".concat(e.message))}finally{O(!1)}}},[w,H,q,K,$,Z,k,R,t,o,G]),(0,a.useEffect)(()=>{let e=e=>{var t;if(console.log("\uD83D\uDCE8 Message received:",null===(t=e.data)||void 0===t?void 0:t.type),e.data&&"famous-inspector-click"===e.data.type){let t=e.data.data;if(console.log("\uD83D\uDD0D DEBUG: Received inspector click data:",t),console.log("\uD83C\uDFAF Element bounds:",t.bounds),console.log("\uD83D\uDCCD Setting selectedElement to:",t),N(t),C(t.text||""),t.styleData){let e=t.styleData,s=e.className?e.className.split(/\\s+/):[],r=s.find(e=>/^text-(xs|sm|base|lg|xl|2xl|3xl|4xl|5xl|6xl|7xl|8xl|9xl)$/.test(e)),a=s.find(e=>/^text-(black|white|gray|red|yellow|green|blue|indigo|purple|pink|orange|teal|cyan|lime|emerald|rose|fuchsia|violet|amber|sky|slate|zinc|neutral|stone)-\d{2,3}$/.test(e)),n=s.find(e=>/^bg-(black|white|gray|red|yellow|green|blue|indigo|purple|pink|orange|teal|cyan|lime|emerald|rose|fuchsia|violet|amber|sky|slate|zinc|neutral|stone)-\d{2,3}$/.test(e)),o=s.filter(e=>/^p[xy]?-/.test(e)),l=s.filter(e=>/^m[xy]?-/.test(e));V(a||""),Y(n||""),X(r||"text-base"),Q(o[0]||""),ee(l[0]||""),console.log("\uD83C\uDFA8 Style data parsed and set:",{textColor:a,bgColor:n,textSize:r,padding:o[0],margin:l[0],allClasses:s})}n&&n(t)}};return window.addEventListener("message",e),()=>window.removeEventListener("message",e)},[n]),(0,a.useEffect)(()=>{let e=e=>{if("Escape"===e.key){if(w){if(N(null),C(""),J("text"),_&&_.contentWindow){var t;null===(t=_.contentWindow)||void 0===t||t.postMessage({type:"famous-editor-closed"},"*")}}else v&&j(!1)}};if(w||v)return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)},[w,v,j]),(0,a.useEffect)(()=>{w&&W.current&&setTimeout(()=>{var e,t;null===(e=W.current)||void 0===e||e.focus(),null===(t=W.current)||void 0===t||t.setSelectionRange(W.current.value.length,W.current.value.length)},100)},[w]),(0,a.useEffect)(()=>{if(_&&_.contentWindow){let e=()=>{try{var e;console.log("\uD83D\uDD0D INSP_DEBUG: Parent sending inspector toggle to iframe:",v),console.log("\uD83D\uDD0D INSP_DEBUG: iframeRef.contentWindow available:",!!(null==_?void 0:_.contentWindow)),null===(e=_.contentWindow)||void 0===e||e.postMessage({type:"famous-inspector-toggle",enabled:v},"*"),console.log("\uD83D\uDD0D INSP_DEBUG: Message sent to iframe")}catch(e){console.log("Could not send inspector toggle:",e)}};e();let t=setTimeout(e,500);return()=>clearTimeout(t)}},[v,_,m]),(0,a.useEffect)(()=>{eo()},[eo]),(0,a.useEffect)(()=>{void 0!==u&&u>0&&(F(t),setTimeout(()=>{eo()},10))},[u,eo,t]),(0,a.useEffect)(()=>()=>{m&&URL.revokeObjectURL(m)},[m]),(0,r.jsxs)("div",{className:"w-full h-full flex flex-col",children:[g&&(0,r.jsx)("div",{className:"bg-red-50 border-l-4 border-red-400 p-4",children:(0,r.jsxs)("div",{className:"text-red-700",children:[(0,r.jsx)("span",{className:"font-medium",children:"Error:"})," ",g]})}),(0,r.jsxs)("div",{className:"flex-1 relative ".concat("mobile"===d?"bg-gray-100 flex items-center justify-center p-8":""),children:[m?(0,r.jsxs)("div",{className:"\n              relative\n              ".concat("mobile"===d?"w-[375px] h-[812px] max-h-full border-[14px] border-gray-900 rounded-[50px] shadow-2xl bg-black overflow-hidden":"w-full h-full","\n              transition-all duration-300 ease-in-out\n            "),children:["mobile"===d&&(0,r.jsx)("div",{className:"absolute top-0 left-1/2 transform -translate-x-1/2 w-[150px] h-[30px] bg-gray-900 rounded-b-[20px] z-10"}),(0,r.jsx)("iframe",{ref:e=>B(e),src:m,className:"w-full h-full border-0 ".concat("mobile"===d?"rounded-[36px]":""),sandbox:"allow-scripts allow-same-origin allow-modals",title:"React App Preview",onLoad:()=>{console.log("\uD83D\uDD0D INSP_DEBUG: Iframe loaded, sending inspector state:",v),console.log("\uD83D\uDD0D INSP_DEBUG: onLoad - iframeRef available:",!!_),console.log("\uD83D\uDD0D INSP_DEBUG: onLoad - contentWindow available:",!!(null==_?void 0:_.contentWindow)),_&&_.contentWindow&&v?(console.log("\uD83D\uDD0D INSP_DEBUG: All conditions met, sending message in 100ms"),setTimeout(()=>{try{var e;console.log("\uD83D\uDD0D INSP_DEBUG: onLoad timeout - sending message now"),null===(e=_.contentWindow)||void 0===e||e.postMessage({type:"famous-inspector-toggle",enabled:v},"*"),console.log("\uD83D\uDD0D INSP_DEBUG: onLoad message sent")}catch(e){console.log("\uD83D\uDD0D INSP_DEBUG: Could not send inspector toggle on load:",e)}},100)):console.log("\uD83D\uDD0D INSP_DEBUG: Conditions not met for sending message on load")}},m)]}):(0,r.jsx)("div",{className:"flex items-center justify-center h-full text-gray-500",children:g?"Build failed - check console for details":"Preview ready"===p?p:(0,r.jsxs)("svg",{className:"animate-spin h-10 w-10 text-blue-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,r.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,r.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})}),w&&w.bounds&&(0,r.jsxs)("div",{className:"fixed bg-gray-900 border-2 border-blue-500 rounded-xl shadow-2xl transform transition-all duration-200 overflow-visible",style:{zIndex:9999,backgroundColor:"rgba(17, 24, 39, 0.98)",padding:"16px",top:"".concat((()=>{let e=null==_?void 0:_.getBoundingClientRect(),t=((null==e?void 0:e.top)||0)+w.bounds.top,s=t+w.bounds.height;return window.innerHeight-s>470?s+10:t>470?t-450-10:60})(),"px"),left:"".concat((()=>{let e=null==_?void 0:_.getBoundingClientRect();return Math.max(10,Math.min(((null==e?void 0:e.left)||0)+w.bounds.left+w.bounds.width/2-150,window.innerWidth-320))})(),"px"),width:"300px",height:"auto",maxHeight:"500px",overflowY:"auto"},children:[(0,r.jsx)("button",{onClick:()=>{if(N(null),C(""),J("text"),_&&_.contentWindow){var e;null===(e=_.contentWindow)||void 0===e||e.postMessage({type:"famous-editor-closed"},"*")}},className:"absolute top-2 right-2 text-gray-400 hover:text-gray-200 transition-colors p-1 rounded-lg hover:bg-gray-700/50",children:(0,r.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),(0,r.jsxs)("div",{className:"space-y-4 pt-8",children:[(0,r.jsx)("div",{children:(0,r.jsx)("textarea",{ref:W,value:k,onChange:e=>C(e.target.value),className:"w-full p-3 bg-gray-800/50 border border-gray-600/50 rounded-lg text-white text-sm placeholder-gray-400 focus:ring-1 focus:ring-blue-500/50 focus:border-blue-500/50 transition-colors resize-none",rows:3,placeholder:"Edit text..."})}),!1,(0,r.jsx)("button",{className:"w-full mt-3 px-3 py-2 bg-blue-600 text-white text-sm rounded hover:bg-blue-700 transition-colors",onClick:()=>el(),children:"Apply Changes"})]})]})]})]})}function _(e){var t;let{previewSlug:s,onConsoleLog:n,onTryToFixIt:o,previewMode:l="desktop",refreshKey:i=0,onInspectorClick:c,projectId:d,files:u={},previewType:m="new",onSaveAllChanges:x,onFilesUpdate:p,onUnsavedChangesUpdate:h,platform:g="website",inspectorMode:f,setInspectorMode:y}=e,b=(0,a.useRef)(null),[v,j]=(0,a.useState)(new Map),[w,N]=(0,a.useState)(!1),[k,C]=(0,a.useState)(null),[S,E]=(0,a.useState)(!1),[D,T]=(0,a.useState)(!1),[I,A]=(0,a.useState)(null),[L,P]=(0,a.useState)(""),[M,_]=(0,a.useState)(!1),[B,R]=(0,a.useState)(!1),F=void 0!==f?f:D,U="website"===g&&u&&Object.keys(u).length>0&&"new"===m,z=async e=>{let t=e||I,s=(null==e?void 0:e.newText)||L;if(t&&d&&(null==s?void 0:s.trim())){_(!0);try{var r;let e=null===(r=t.mapping)||void 0===r?void 0:r.file;if(!e)throw Error("Cannot determine which file contains this element");let a=u[e];if(!a)throw Error("File ".concat(e," not found in project"));let n=a,o=t.text,l=[">".concat(o,"<"),'"'.concat(o,'"'),"'".concat(o,"'"),"{".concat(o,"}"),"{'".concat(o,"'}"),'{"'.concat(o,'"}')],i=!1;for(let e of l)if(n.includes(e)){let t=e.replace(o,s);n=n.replace(e,t),i=!0;break}if(!i&&n.includes(o)&&(n=n.replace(o,s),i=!0),!i)throw Error("Could not find text to replace");let c=await fetch("/api/projects/change-files",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({projectId:d,changedFiles:{[e]:n}})});if(429===c.status){let e=await c.json();throw Error(e.message||"Rate limit exceeded")}if(!c.ok){let e=await c.json();throw Error(e.error||"Failed to save changes")}A(null),P(""),x&&await x()}catch(e){console.error("Failed to update text:",e),alert("Failed to update text: ".concat(e.message))}finally{_(!1)}}};(0,a.useEffect)(()=>{if(B&&b.current&&b.current.contentWindow)try{b.current.contentWindow.postMessage({type:"famous-inspector-toggle",enabled:F},"*")}catch(e){console.log("Could not send inspector toggle:",e)}},[F,B]),(0,a.useEffect)(()=>{i>0&&(j(new Map),N(!1),C(null),R(!1))},[i]);let W=e=>{let t;let s=e.find(e=>e instanceof Error||"object"==typeof e&&null!==e&&"message"in e&&"stack"in e);return s&&(s instanceof Error?t=s.stack:"object"==typeof s&&"stack"in s&&(t=String(s.stack))),{message:e.map(e=>"string"==typeof e?e:e instanceof Error?e.message:JSON.stringify(e)).join(" "),stack:t}},G=()=>{N(e=>!e)},J=e=>{C(t=>t===e?null:e)},H=async()=>{let e=Array.from(v.values()).slice(0,5).map(e=>({message:(e.message||"Unknown browser console error").substring(0,300)})).map((e,t)=>"Error ".concat(t+1,": ").concat(e.message)).join("\n\n");try{await navigator.clipboard.writeText(e),E(!0),setTimeout(()=>{E(!1)},2e3)}catch(e){console.error("Failed to copy error message: ",e)}};if((0,a.useEffect)(()=>{let e=e=>{let t=new URL("https://".concat(s,".").concat("deploypad.app")).origin;if(e.origin===t){if(e.data&&"famous-inspector-click"===e.data.type){let t=e.data.data;A(t),P(t.text||""),c&&c(t);return}if(e.data&&"console"===e.data.type){let t=e.data.method,r=e.data.args;null==n||n({method:t,args:r});let a="[".concat(s,"]");switch(t){case"warn":console.warn(a,...r);break;case"error":let{message:o,stack:l}=W(r);j(e=>{let t=new Map(e),s=t.get(o);return s?t.set(o,{...s,count:s.count+1,timestamp:Date.now()}):t.size<5&&t.set(o,{message:o,stack:l,count:1,timestamp:Date.now()}),t}),console.error(a,...r);break;case"info":console.info(a,...r);break;default:console.log(a,...r)}}}};return window.addEventListener("message",e),()=>{window.removeEventListener("message",e)}},[s,n,o]),U)return(0,r.jsx)(O,{files:u,projectId:d,onInspectorClick:c,onFileUpdate:p,onUnsavedChangesUpdate:h,inspectorMode:f,setInspectorMode:y,previewMode:l,refreshKey:i});if(!s)return(0,r.jsx)("div",{className:"bg-gray-100 dark:bg-gray-800 w-full h-full flex items-center justify-center rounded-md",children:(0,r.jsx)("p",{className:"text-gray-500 dark:text-gray-400",children:"No preview available"})});let V=Array.from(v.values()).sort((e,t)=>t.timestamp-e.timestamp);return(0,r.jsxs)("div",{className:"w-full h-full relative flex flex-col",children:[(0,r.jsx)("div",{className:"\n        w-full h-full flex items-center justify-center\n        ".concat("mobile"===l?"bg-gray-100 p-8":"","\n      "),children:(0,r.jsxs)("div",{className:"\n            relative\n            ".concat("mobile"===l?"w-[375px] h-[812px] max-h-full border-[14px] border-gray-900 rounded-[50px] shadow-2xl bg-black overflow-hidden":"w-full h-full","\n            transition-all duration-300 ease-in-out\n          "),children:["mobile"===l&&(0,r.jsx)("div",{className:"absolute top-0 left-1/2 transform -translate-x-1/2 w-[150px] h-[30px] bg-gray-900 rounded-b-[20px] z-10"}),(0,r.jsx)("iframe",{ref:b,src:"https://".concat(s,".").concat("deploypad.app"),className:"w-full h-full border-0 ".concat("mobile"===l?"rounded-[36px]":""),title:"Preview of ".concat(s),sandbox:"allow-scripts allow-forms allow-same-origin allow-popups allow-modals allow-popups-to-escape-sandbox allow-top-navigation-by-user-activation",allow:"camera; microphone; geolocation; clipboard-write; cross-origin-isolated",loading:"lazy",onLoad:()=>{R(!0)}},"iframe-".concat(s,"-").concat(i))]})}),v.size>0&&(0,r.jsxs)("div",{className:"absolute bottom-0 left-0 w-full transition-all duration-300 pointer-events-auto z-[1000] ".concat(w?"h-48":"h-10"),children:[(0,r.jsxs)("div",{className:"w-full bg-black/80 text-white h-10 flex items-center justify-between px-4",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsxs)("div",{className:"flex items-center cursor-pointer text-sm",onClick:G,children:[(0,r.jsx)("span",{className:"text-red-500 mr-2",children:"●"}),(0,r.jsxs)("span",{children:[v.size," ",1===v.size?"error":"errors"," detected"]})]}),o&&(0,r.jsx)("button",{onClick:()=>{o&&v.size>0&&o(Array.from(v.values()).slice(0,5).map(e=>({message:(e.message||"Unknown browser console error").substring(0,300)})).map((e,t)=>"Error ".concat(t+1,": ").concat(e.message)).join("\n\n"))},className:"ml-4 px-2 py-0.5 text-sm font-medium bg-gray-100 hover:bg-gray-200 text-black rounded",children:"Try to fix it"}),(0,r.jsx)("button",{onClick:H,className:"ml-3 text-gray-400 hover:text-white focus:outline-none transition-colors","aria-label":S?"Copied!":"Copy to clipboard",children:S?(0,r.jsx)("svg",{className:"w-4 h-4 text-green-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})}):(0,r.jsx)("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})})})]}),(0,r.jsxs)("div",{className:"flex space-x-3",children:[(0,r.jsx)("button",{onClick:()=>{j(new Map),N(!1),C(null)},className:"text-xs text-gray-400 hover:text-white",children:"Clear"}),(0,r.jsx)("button",{className:"text-xs cursor-pointer",onClick:G,children:w?"Hide":"Show"})]})]}),w&&(0,r.jsx)("div",{className:"w-full h-40 bg-black/80 p-4 overflow-y-auto",children:(0,r.jsx)("div",{className:"space-y-3",children:V.map((e,t)=>(0,r.jsxs)("div",{className:"text-sm",children:[(0,r.jsxs)("div",{className:"flex cursor-pointer",onClick:()=>e.stack&&J(e.message),children:[(0,r.jsx)("div",{className:"text-red-500 min-w-8 flex-shrink-0",children:e.count>1?"(".concat(e.count,")"):""}),(0,r.jsxs)("div",{className:"text-white break-words flex-grow",children:[(0,r.jsx)("span",{className:"font-semibold",children:e.message}),e.stack&&(0,r.jsxs)("span",{className:"text-gray-400 ml-2 text-xs",children:[k===e.message?"▼":"▶",e.stack?"Stack trace available":""]})]})]}),e.stack&&k===e.message&&(0,r.jsx)("div",{className:"mt-1 ml-8 p-2 bg-gray-900 rounded text-xs text-gray-300 font-mono whitespace-pre-wrap overflow-x-auto",children:e.stack})]},t))})})]}),I&&(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-xl p-6 w-96 max-w-[90vw]",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Edit Text"}),(0,r.jsx)("button",{onClick:()=>{A(null),P("")},className:"text-gray-400 hover:text-gray-600",children:(0,r.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Element"}),(0,r.jsxs)("div",{className:"text-sm text-gray-500 bg-gray-50 p-2 rounded font-mono",children:["<",I.tagName,">",(null===(t=I.mapping)||void 0===t?void 0:t.file)&&(0,r.jsxs)("span",{className:"ml-2 text-xs text-blue-600",children:[I.mapping.file,":",I.mapping.line]})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Current Text"}),(0,r.jsx)("textarea",{value:L,onChange:e=>P(e.target.value),className:"w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",rows:3,placeholder:"Enter new text..."})]}),(0,r.jsxs)("div",{className:"flex justify-end space-x-3",children:[(0,r.jsx)("button",{onClick:()=>{A(null),P("")},className:"px-4 py-2 text-gray-600 border border-gray-300 rounded-md hover:bg-gray-50",children:"Cancel"}),(0,r.jsx)("button",{onClick:()=>z(),disabled:M||!L.trim()||L===I.text,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center",children:M?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",fill:"none",viewBox:"0 0 24 24",children:[(0,r.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,r.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Updating..."]}):"Update Text"})]})]})]})})]})}var B=s(88225),R=s(44283),F=s(25534),U=s(63761),z=s(20005),W=s(97118),G=s(30725),J=s(74909),H=s(77704),V=s(76094);let q=H.Kq,Y=H.bL,K=H.l9,X=a.forwardRef((e,t)=>{let{className:s,sideOffset:a=4,...n}=e;return(0,r.jsx)(H.ZL,{children:(0,r.jsx)(H.UC,{ref:t,sideOffset:a,className:(0,V.cn)("z-50 overflow-hidden rounded-md bg-primary px-3 py-1.5 text-xs text-primary-foreground animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-tooltip-content-transform-origin]",s),...n})})});function $(e){let{activeView:t,isMobile:s=!1,previewMode:a="desktop",setPreviewMode:n,onRefreshPreview:o,isRefreshing:l=!1,projectPlatform:i="website",inspectorMode:c=!1,setInspectorMode:d,previewType:u="new",setPreviewType:m,projectId:x,projectSlug:p,onDownload:h,isDownloading:g=!1,onSaveAllChanges:f,isSavingAllChanges:y=!1,hasUnsavedChanges:b=!1,whitelabelConfig:v,isWhitelabel:j=!1}=e;return"preview"===t?(0,r.jsx)(q,{delayDuration:300,children:(0,r.jsx)("div",{className:"bg-gray-100 dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 px-4 py-2",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[!s&&n&&(0,r.jsxs)(Y,{children:[(0,r.jsx)(K,{asChild:!0,children:(0,r.jsxs)("div",{className:"flex ".concat(!j&&"bg-gray-700"," rounded-lg p-0.5"),style:{backgroundColor:j&&(null==v?void 0:v.secondaryColor)||void 0},children:[(0,r.jsxs)(Y,{children:[(0,r.jsx)(K,{asChild:!0,children:(0,r.jsx)("button",{onClick:()=>n("desktop"),className:"px-3 py-1.5 text-sm font-medium rounded-md transition-all duration-200 flex items-center ".concat("desktop"===a?"bg-blue-600 text-white shadow-md":"text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300"),children:"mobile"===i?(0,r.jsx)(B.A,{className:"w-4 h-4"}):(0,r.jsx)(R.A,{className:"w-4 h-4"})})}),(0,r.jsx)(X,{children:(0,r.jsx)("p",{children:"Desktop view"})})]}),(0,r.jsxs)(Y,{children:[(0,r.jsx)(K,{asChild:!0,children:(0,r.jsx)("button",{onClick:()=>n("mobile"),className:"px-3 py-1.5 text-sm font-medium rounded-md transition-all duration-200 flex items-center ".concat("mobile"===a?"bg-blue-600 text-white shadow-md":"text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300"),children:(0,r.jsx)(F.A,{className:"w-4 h-4"})})}),(0,r.jsx)(X,{children:(0,r.jsx)("p",{children:"Mobile view"})})]})]})}),(0,r.jsx)(X,{children:(0,r.jsx)("p",{children:"Switch preview mode"})})]}),o&&(0,r.jsxs)(Y,{children:[(0,r.jsx)(K,{asChild:!0,children:(0,r.jsx)("button",{onClick:o,disabled:l,className:"p-1.5 text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm hover:bg-gray-50 dark:hover:bg-gray-600 transition-colors",children:(0,r.jsx)(U.A,{className:"w-4 h-4 ".concat(l?"animate-spin":"")})})}),(0,r.jsx)(X,{children:(0,r.jsx)("p",{children:"Refresh preview"})})]})]}),(0,r.jsx)("div",{className:"flex items-center justify-center flex-1",children:b&&(0,r.jsxs)(Y,{children:[(0,r.jsx)(K,{asChild:!0,children:(0,r.jsxs)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-orange-100 text-orange-800 dark:bg-orange-900 dark:text-orange-200",children:[(0,r.jsx)("div",{className:"w-1.5 h-1.5 bg-orange-500 rounded-full mr-1.5"}),"Unsaved changes"]})}),(0,r.jsx)(X,{children:(0,r.jsx)("p",{children:"Unsaved changes from inspector edits"})})]})}),(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:["website"===i&&m&&(0,r.jsxs)(Y,{children:[(0,r.jsx)(K,{asChild:!0,children:(0,r.jsxs)("div",{className:"flex bg-gray-200 dark:bg-gray-700 rounded-lg p-0.5",children:[(0,r.jsx)("button",{onClick:()=>m("new"),className:"px-3 py-1.5 text-sm font-medium rounded-md transition-all duration-200 ".concat("new"===u?"bg-white dark:bg-gray-800 text-gray-900 dark:text-white shadow-sm":"text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200"),children:"Live Edit"}),(0,r.jsx)("button",{onClick:()=>m("old"),className:"px-3 py-1.5 text-sm font-medium rounded-md transition-all duration-200 ".concat("old"===u?"bg-white dark:bg-gray-800 text-gray-900 dark:text-white shadow-sm":"text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200"),children:"View Only"})]})}),(0,r.jsx)(X,{children:(0,r.jsx)("p",{children:"Switch between live edit mode and view-only preview"})})]}),f&&b&&(0,r.jsxs)(Y,{children:[(0,r.jsx)(K,{asChild:!0,children:(0,r.jsx)("button",{onClick:f,disabled:y,className:"flex items-center px-3 py-1.5 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed border border-transparent rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors",children:y?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(U.A,{className:"w-4 h-4 mr-2 animate-spin"}),"Saving..."]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(z.A,{className:"w-4 h-4 mr-2"}),"Save Changes"]})})}),(0,r.jsx)(X,{children:(0,r.jsx)("p",{children:"Save inspector changes"})})]}),d&&"new"===u&&(0,r.jsxs)(Y,{children:[(0,r.jsx)(K,{asChild:!0,children:(0,r.jsxs)("div",{className:"flex bg-gray-200 dark:bg-gray-700 rounded-lg p-0.5",children:[(0,r.jsx)("button",{onClick:()=>d(!1),className:"px-3 py-1.5 text-sm font-medium rounded-md transition-all duration-200 flex items-center ".concat(c?"text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200":"bg-white dark:bg-gray-800 text-gray-900 dark:text-white shadow-sm"),children:(0,r.jsx)(W.A,{className:"w-4 h-4"})}),(0,r.jsx)("button",{onClick:()=>d(!0),className:"px-3 py-1.5 text-sm font-medium rounded-md transition-all duration-200 flex items-center ".concat(c?"bg-white dark:bg-gray-800 text-gray-900 dark:text-white shadow-sm":"text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200"),children:(0,r.jsx)(G.A,{className:"w-4 h-4"})})]})}),(0,r.jsx)(X,{children:(0,r.jsx)("p",{children:"Switch between mouse and edit modes"})})]})]})]})})}):(0,r.jsx)(q,{delayDuration:300,children:(0,r.jsx)("div",{className:"bg-gray-100 dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 px-4 py-2",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("div",{className:"flex items-center space-x-3",children:(0,r.jsxs)(Y,{children:[(0,r.jsx)(K,{asChild:!0,children:(0,r.jsx)("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Code Editor"})}),(0,r.jsx)(X,{children:(0,r.jsx)("p",{children:"Code editor"})})]})}),(0,r.jsx)("div",{className:"flex items-center justify-center flex-1",children:b&&(0,r.jsxs)(Y,{children:[(0,r.jsx)(K,{asChild:!0,children:(0,r.jsxs)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-orange-100 text-orange-800 dark:bg-orange-900 dark:text-orange-200",children:[(0,r.jsx)("div",{className:"w-1.5 h-1.5 bg-orange-500 rounded-full mr-1.5"}),"Unsaved changes"]})}),(0,r.jsx)(X,{children:(0,r.jsx)("p",{children:"Unsaved changes"})})]})}),(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[f&&b&&(0,r.jsxs)(Y,{children:[(0,r.jsx)(K,{asChild:!0,children:(0,r.jsx)("button",{onClick:f,disabled:y,className:"flex items-center px-3 py-1.5 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed border border-transparent rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors",children:y?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(U.A,{className:"w-4 h-4 mr-2 animate-spin"}),"Saving..."]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(z.A,{className:"w-4 h-4 mr-2"}),"Save Changes"]})})}),(0,r.jsx)(X,{children:(0,r.jsx)("p",{children:"Save changes"})})]}),x&&h&&(0,r.jsxs)(Y,{children:[(0,r.jsx)(K,{asChild:!0,children:(0,r.jsxs)("button",{onClick:h,disabled:g,className:"flex items-center px-3 py-1.5 text-sm font-medium text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm hover:bg-gray-50 dark:hover:bg-gray-600 transition-colors",children:[g?(0,r.jsx)(U.A,{className:"w-4 h-4 mr-2 animate-spin"}):(0,r.jsx)(J.A,{className:"w-4 h-4 mr-2"}),"Download"]})}),(0,r.jsx)(X,{children:(0,r.jsx)("p",{children:"Download files"})})]})]})]})})})}X.displayName=H.UC.displayName;var Q=s(56191),Z=function(e){return e.LOADING="loading",e.COMPLETED="completed",e.ERROR="error",e.STATUS="status",e.NEED_SUPABASE_KEY="need_supabase_key",e.CHOOSE_SUPABASE_PROJECT="choose_supabase_project",e.NEED_SECRETS="need_secrets",e.NEED_ANSWERS="need_answers",e}({}),ee=s(56318),et=s(33013);let es=e=>{let{messageId:t,preview:s,projectPreview:a,restoringPreview:n,onRestorePreview:o,timestamp:l,messageContent:i,actions:d,totalCost:u,duration:m,suggestions:x,onSuggestionClick:p,isLastCheckpoint:h=!1}=e,g=a&&s===a,f=!!n&&n===s;return(0,r.jsx)("div",{className:"flex justify-center mt-2",children:(0,r.jsxs)("div",{className:"w-[85%]",children:[(0,r.jsxs)("div",{className:"bg-white dark:bg-gray-900 border border-gray-200 dark:border-gray-700 rounded-lg shadow-sm",children:[(0,r.jsx)("div",{className:"p-3 border-b border-gray-100 dark:border-gray-700",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2.5",children:[(0,r.jsx)("div",{className:"w-8 h-8 bg-green-50 dark:bg-green-900/20 rounded-full flex items-center justify-center",children:(0,r.jsx)("svg",{className:"w-4 h-4 text-green-600 dark:text-green-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"text-sm font-semibold text-gray-900 dark:text-white",children:"Milestone"}),l&&(0,r.jsx)("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:(e=>e?("string"==typeof e?new Date(e):e).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0}):"")(l)})]})]}),g&&(0,r.jsx)("div",{className:"px-2.5 py-0.5 bg-green-100 dark:bg-green-900/20 text-green-700 dark:text-green-400 rounded-full text-xs font-medium",children:"Current"})]})}),d&&d.length>0&&(0,r.jsx)("div",{className:"border-b border-gray-100 dark:border-gray-700",children:(0,r.jsxs)("details",{className:"group",children:[(0,r.jsx)("summary",{className:"px-3 py-2 cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors flex items-center justify-between select-none",children:(0,r.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,r.jsx)("svg",{className:"w-3.5 h-3.5 text-gray-500 dark:text-gray-400 group-open:rotate-90 transition-transform",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})}),(0,r.jsxs)("span",{className:"text-xs font-medium text-gray-700 dark:text-gray-300",children:[d.filter(e=>"finish"!==e.type).length," actions"]})]})}),(0,r.jsx)("div",{className:"px-3 pt-2 pb-2 border-t border-gray-100 dark:border-gray-700",children:(0,r.jsx)("ul",{className:"text-xs space-y-1 pl-5",children:d.filter(e=>"finish"!==e.type).map((e,t)=>(0,r.jsx)("li",{className:"text-gray-600 dark:text-gray-400",children:e.description},t))})})]})}),(0,r.jsx)("div",{className:"p-3 border-b border-gray-100 dark:border-gray-700",children:(0,r.jsxs)("div",{className:"flex gap-1.5",children:[!g&&(0,r.jsx)("button",{onClick:e=>{e.stopPropagation(),o(s)},className:"flex-1 flex items-center justify-center gap-1.5 px-2.5 py-1.5 rounded-md text-xs font-medium transition-all ".concat(f?"bg-gray-100 dark:bg-gray-800 text-gray-400 dark:text-gray-500 cursor-not-allowed":"bg-gray-50 hover:bg-gray-100 dark:bg-gray-800 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-300 border border-gray-200 dark:border-gray-600"),disabled:f,children:f?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("svg",{className:"animate-spin w-3.5 h-3.5",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,r.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"2"}),(0,r.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),(0,r.jsx)("span",{children:"Rolling back..."})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"w-3.5 h-3.5",children:[(0,r.jsx)("path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"}),(0,r.jsx)("path",{d:"M3 3v5h5"})]}),(0,r.jsx)("span",{children:"Rollback here"})]})}),(0,r.jsxs)(c(),{href:"https://".concat(s,".").concat("deploypad.app"),className:"".concat(g?"flex-1":""," flex items-center justify-center gap-1.5 px-2.5 py-1.5 rounded-md text-xs font-medium transition-all bg-gray-50 hover:bg-gray-100 dark:bg-gray-800 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-300 border border-gray-200 dark:border-gray-600"),target:"_blank",rel:"noopener noreferrer",children:[(0,r.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"w-3.5 h-3.5",children:[(0,r.jsx)("path",{d:"M15 3h6v6"}),(0,r.jsx)("path",{d:"M10 14 21 3"}),(0,r.jsx)("path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"})]}),(0,r.jsx)("span",{children:"Preview"})]})]})}),void 0!==m&&(0,r.jsxs)("details",{className:"group",children:[(0,r.jsx)("summary",{className:"px-3 py-2 cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors rounded-b-lg flex items-center justify-between select-none",children:(0,r.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,r.jsx)("svg",{className:"w-3.5 h-3.5 text-gray-500 dark:text-gray-400 group-open:rotate-90 transition-transform",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})}),(0,r.jsxs)("span",{className:"text-xs font-medium text-gray-700 dark:text-gray-300",children:[m<60?"".concat(m," seconds"):"".concat(Math.floor(m/60)," minutes ").concat(m%60," seconds")," of work"]})]})}),(0,r.jsx)("div",{className:"px-3 pt-2 pb-2 rounded-b-lg border-t border-gray-100 dark:border-gray-700",children:(0,r.jsxs)("div",{className:"space-y-1.5 pl-5",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center text-xs",children:[(0,r.jsx)("span",{className:"text-gray-600 dark:text-gray-400",children:"Time worked"}),(0,r.jsx)("span",{className:"font-medium text-gray-800 dark:text-gray-200",children:m<60?"".concat(m," seconds"):"".concat(Math.floor(m/60),"m ").concat(m%60,"s")})]}),d&&d.length>0&&(0,r.jsxs)("div",{className:"flex justify-between items-center text-xs",children:[(0,r.jsx)("span",{className:"text-gray-600 dark:text-gray-400",children:"Work done"}),(0,r.jsxs)("span",{className:"font-medium text-gray-800 dark:text-gray-200",children:[d.filter(e=>"finish"!==e.type).length," actions"]})]}),void 0!==u&&(0,r.jsxs)("div",{className:"flex justify-between items-center text-xs",children:[(0,r.jsx)("span",{className:"text-gray-600 dark:text-gray-400",children:"Build Usage"}),(0,r.jsxs)("span",{className:"font-medium text-gray-800 dark:text-gray-200",children:["$",u<.01?u.toFixed(4):u.toFixed(2)]})]})]})})]})]}),x&&x.length>0&&h&&(0,r.jsxs)("div",{className:"mt-1.5 space-y-1.5",children:[(0,r.jsx)("div",{className:"text-xs font-medium text-gray-700 dark:text-gray-300 px-1",children:"Do Next:"}),x.map((e,t)=>(0,r.jsxs)("div",{className:"relative group",children:[(0,r.jsx)("button",{onClick:t=>{t.stopPropagation(),p&&p(e.prompt)},className:"w-full flex items-center justify-center gap-1.5 px-3 py-2 rounded-md text-sm font-medium transition-all bg-green-50 hover:bg-green-100 dark:bg-green-900/20 dark:hover:bg-green-900/40 text-green-700 dark:text-green-400 border border-green-200 dark:border-green-700/50 hover:border-green-300 dark:hover:border-green-600",children:(0,r.jsx)("span",{children:e.shortTitle})}),(0,r.jsx)("div",{className:"opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-opacity duration-200 absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 w-60 max-w-sm bg-gray-900 text-white text-xs rounded-md p-3 shadow-lg z-10 pointer-events-none",children:(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("p",{className:"whitespace-pre-wrap",children:e.prompt}),(0,r.jsx)("div",{className:"absolute top-full left-1/2 transform -translate-x-1/2 w-2 h-2 bg-gray-900 rotate-45"})]})})]},t))]})]})})},er=e=>{let{message:t,onUpgradeClick:s}=e,[n,o]=(0,a.useState)(!1),l=t.content.length>300;if(t.status===Z.NEED_SUPABASE_KEY||t.status===Z.CHOOSE_SUPABASE_PROJECT||t.status===Z.NEED_SECRETS||t.status===Z.NEED_ANSWERS)return null;if(t.status===Z.ERROR)return(0,r.jsx)("div",{className:"whitespace-pre-wrap text-sm break-words",children:"Build unsuccessful"});if(t.status===Z.STATUS&&t.content.startsWith("Waiting for priority builds")&&s)return(0,r.jsxs)("div",{className:"whitespace-pre-wrap text-sm break-words",children:["Waiting for priority builds to finish. ",(0,r.jsx)("span",{className:"underline cursor-pointer",onClick:e=>{e.stopPropagation(),s()},children:"Upgrade now"})," to get ahead of the line."]});if(t.status===Z.STATUS&&t.content.startsWith("Waiting for priority responses")&&s)return(0,r.jsxs)("div",{className:"whitespace-pre-wrap text-sm break-words",children:["Waiting for priority responses to finish. ",(0,r.jsx)("span",{className:"underline cursor-pointer",onClick:e=>{e.stopPropagation(),s()},children:"Upgrade now"})," to get ahead of the line."]});if(t.status===Z.COMPLETED&&t.content.startsWith("You have reached your message limit")&&s)return(0,r.jsxs)("div",{className:"whitespace-pre-wrap text-sm break-words",children:["You have reached your message limit. ",(0,r.jsx)("span",{className:"underline cursor-pointer",onClick:e=>{e.stopPropagation(),s()},children:"Upgrade now"})," to continue."]});let i=e=>e.split("\\n").map((t,s)=>(0,r.jsxs)(a.Fragment,{children:[t,s<e.split("\\n").length-1&&(0,r.jsx)("br",{})]},s));if("user"===t.role&&l&&!n){let e=t.content.substring(0,300);return(0,r.jsxs)("div",{className:"whitespace-pre-wrap text-sm break-words",children:[i(e),(0,r.jsx)("span",{children:"..."}),(0,r.jsx)("button",{onClick:e=>{e.stopPropagation(),o(!0)},className:"text-blue-500 hover:text-blue-700 dark:text-blue-400 dark:hover:text-blue-300 text-xs font-medium",children:"Show more"})]})}return(0,r.jsxs)("div",{className:"whitespace-pre-wrap text-sm break-words",children:[i(t.content),"user"===t.role&&l&&n&&(0,r.jsx)("button",{onClick:e=>{e.stopPropagation(),o(!1)},className:"block mt-2 text-blue-500 hover:text-blue-700 dark:text-blue-400 dark:hover:text-blue-300 text-xs font-medium",children:"Show less"})]})},ea=(0,a.forwardRef)((e,t)=>{let{initialPrompt:s,onSendMessage:n,onBeforeSendMessage:o,onStopProject:l,isLoading:i,projectId:c,projectStatus:d,projectPreview:u,onRestorePreview:x,restoringPreview:p,hideHeader:h=!1,onErrorClick:g,onTryToFixIt:f,isMobile:y=!1}=e,[b,v]=(0,a.useState)([]),[w,N]=(0,a.useState)(""),[k,C]=(0,a.useState)([]),[S,E]=(0,a.useState)(!1),[D,T]=(0,a.useState)(""),[I,A]=(0,a.useState)(!1),[L,P]=(0,a.useState)(!1),[M,O]=(0,a.useState)({}),[_,B]=(0,a.useState)({}),[R,F]=(0,a.useState)({}),[U,z]=(0,a.useState)({}),[W,G]=(0,a.useState)({}),{data:J}=(0,et.useSession)(),[H,V]=(0,a.useState)(!1),[q,Y]=(0,a.useState)(!1),[K,X]=(0,a.useState)(0),[$,ea]=(0,a.useState)(""),[en,eo]=(0,a.useState)(""),[el,ei]=(0,a.useState)(!1);(0,a.useRef)(null);let[ec,ed]=(0,a.useState)(!1),[eu,em]=(0,a.useState)(!1),[ex,ep]=(0,a.useState)(()=>{{let e=localStorage.getItem("chatMaxMode");return!!e&&JSON.parse(e)}}),[eh,eg]=(0,a.useState)(()=>{{let e=localStorage.getItem("chatImageGeneration");return!e||JSON.parse(e)}}),[ef,ey]=(0,a.useState)(()=>{{let e=localStorage.getItem("chatWebSearch");return!e||JSON.parse(e)}}),[eb,ev]=(0,a.useState)(()=>{{let e=localStorage.getItem("chatGeniusMode");return!!e&&JSON.parse(e)}}),ej=(0,a.useRef)(null),ew=(0,a.useRef)(null),eN=(0,a.useRef)(!1),ek=(0,a.useRef)(!1),eC=(0,a.useRef)(null),[eS,eE]=(0,a.useState)(!0),{isWhitelabel:eD,whitelabelConfig:eT}=(0,j.p)();(0,a.useEffect)(()=>{let e=setTimeout(()=>{eE(!1)},3e3);return()=>clearTimeout(e)},[]),(0,a.useEffect)(()=>{localStorage.setItem("chatMaxMode",JSON.stringify(ex))},[ex]),(0,a.useEffect)(()=>{localStorage.setItem("chatImageGeneration",JSON.stringify(eh))},[eh]),(0,a.useEffect)(()=>{localStorage.setItem("chatWebSearch",JSON.stringify(ef))},[ef]),(0,a.useEffect)(()=>{localStorage.setItem("chatGeniusMode",JSON.stringify(eb))},[eb]),(0,a.useEffect)(()=>{ej.current&&(ej.current.focus(),ej.current.style.height="auto",ej.current.style.height="".concat(ej.current.scrollHeight,"px"))},[w]);let[eI,eA]=(0,a.useState)(!1),[eL,eP]=(0,a.useState)(null),[eM,eO]=(0,a.useState)(!1),e_=(0,a.useRef)(!1),eB=(0,a.useCallback)(async e=>{try{let t=await fetch("/api/uploads/signed-url",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({fileType:e.type,fileName:e.name||"image-".concat(Date.now(),".").concat(e.type.split("/")[1])})});if(!t.ok)throw Error("Failed to get signed URL");let{signedUrl:s,fileUrl:r}=await t.json();if(!(await fetch(s,{method:"PUT",body:e,headers:{"Content-Type":e.type},mode:"cors"})).ok)throw Error("Failed to upload file");return r}catch(e){return console.error("Error uploading file:",e),null}},[]),eR=(0,ee.VB)(),eF=(0,a.useRef)(null),eU=(0,a.useRef)([]);(0,a.useEffect)(()=>{eU.current=k},[k]),(0,a.useEffect)(()=>{if(!eF.current)return eF.current=eR.registerHandler({uploadFiles:async e=>{console.log("Chat: Handling ".concat(e.length," dropped files")),E(!0);try{let t=[...eU.current];for(let s of e){let e=await eB(s);e&&t.push(e)}C(t)}catch(e){console.error("Error uploading dropped files:",e)}finally{E(!1)}}}),()=>{eF.current&&(eR.unregisterHandler(eF.current),eF.current=null)}},[eR,eB]);let ez=(0,a.useCallback)(async e=>{if(e.preventDefault(),e.stopPropagation(),!i&&(console.log("Chat: Files dropped directly on chat component"),e.dataTransfer.files&&e.dataTransfer.files.length>0)){let t=Array.from(e.dataTransfer.files).filter(e=>e.type.startsWith("image/")&&e.size<=5242880);if(t.length>0){E(!0);try{let e=[...k];for(let s of t){let t=await eB(s);t&&e.push(t)}C(e)}catch(e){console.error("Error uploading dropped files:",e)}finally{E(!1)}}}},[i,k,eB]),eW=(0,a.useCallback)(async()=>{if(!e_.current)try{e_.current=!0,eO(!0);let e=await fetch("/api/subscription");if(e.ok){let t=await e.json();t.subscription&&eP(t.subscription)}else console.error("Failed to fetch subscription data")}catch(e){console.error("Error fetching subscription data:",e)}finally{eO(!1),e_.current=!1}},[]),eG=(0,a.useCallback)(async function(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"completed",r=arguments.length>3?arguments[3]:void 0;if(c){if("status"===s)return null;try{let a=!1,n=!1;{let e=localStorage.getItem("chatMaxMode"),t=localStorage.getItem("chatGeniusMode");a=!!e&&JSON.parse(e),n=!!t&&JSON.parse(t)}let o=await fetch("/api/messages",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:c,role:e,content:t,status:s,attachments:r,maxMode:a,geniusMode:n})});if(!o.ok){if(402===o.status&&(await o.json()).requiresUpgrade){eA(!0);let e={id:"assistant-".concat(Date.now().toString()),role:"assistant",content:"You have reached your message limit. Upgrade now to continue.",status:Z.COMPLETED};throw v(t=>[...t,e]),Error("Subscription limit reached")}throw Error("Failed to save message")}return await o.json()}catch(e){throw console.error("Error saving message:",e),e}}},[c]),eJ=(0,a.useCallback)(async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(c&&!ek.current){ek.current=!0;try{var r;let a=await fetch("/api/messages?projectId=".concat(c,"&offset=").concat(e,"&limit=60"));if(!a.ok)throw Error("Failed to fetch messages");let n=await a.json();if(console.log("Messages:",n),V(n.hasMore||!1),X(e+((null===(r=n.messages)||void 0===r?void 0:r.length)||0)),n.messages&&n.messages.length>0){let e=n.messages.map(e=>({id:e._id,role:e.role,content:e.content,status:e.status||"completed",attachments:e.attachments||[],supabaseProjects:e.supabaseProjects||[],preview:e.preview||null,createdAt:e.createdAt||null,secrets:e.secrets||[],experiment:e.experiment||void 0,variation:e.variation||void 0,forceExperiment:e.forceExperiment||void 0,forceVariation:e.forceVariation||void 0,outcome:e.outcome||void 0,questions:e.questions||[],actions:e.actions||[],totalCost:e.totalCost||void 0,duration:e.duration||void 0,suggestions:e.suggestions||[]}));t?v(t=>[...e,...t].filter((e,t,s)=>t===s.findIndex(t=>t.id===e.id))):(v(e),eN.current=!0,"assistant"===e[e.length-1].role?(ea(e[e.length-1].forceExperiment||""),eo(e[e.length-1].forceVariation||"")):(ea(""),eo("")),setTimeout(()=>{var e;null===(e=ew.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})},100))}else if(s&&!eN.current&&!t)try{await eG("user",s),eN.current=!0}catch(e){eN.current=!0}}catch(e){console.error("Error loading messages:",e)}finally{ek.current=!1}}},[c,s,eG]),eH=(0,a.useCallback)(async()=>{if(H&&!q){Y(!0);try{await eJ(K,!0)}catch(e){console.error("Error loading more messages:",e)}finally{Y(!1)}}},[H,q,K,eJ]);(0,a.useEffect)(()=>{c&&eJ()},[c,eJ]),(0,a.useEffect)(()=>{i&&b.length>0&&!eS&&setTimeout(()=>{var e;null===(e=ew.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})},100)},[i,b,eS]),(0,a.useEffect)(()=>{eW()},[eW]),(0,a.useImperativeHandle)(t,()=>({addAssistantMessage:async(e,t,s)=>{let r={id:"assistant-".concat(Date.now().toString()),role:"assistant",content:e,status:t};if(v(e=>[...e,r]),setTimeout(()=>{var e;null===(e=ew.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})},100),s)try{let s=await eG("assistant",e,t);s&&v(e=>e.map(e=>e.id===r.id?{...e,id:s.message._id}:e))}catch(e){console.error("Error saving assistant message:",e)}},updateLastAssistantMessage:async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Z.COMPLETED;v(s=>{let r=s.filter(e=>"assistant"===e.role);return 0===r.length?[...s,{id:"assistant-".concat(Date.now().toString()),role:"assistant",content:e,status:t}]:s.map(s=>s.id===r[r.length-1].id?{...s,content:e,status:t}:s)}),setTimeout(()=>{var e;null===(e=ew.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})},100);try{await eG("assistant",e,t)}catch(e){console.error("Error updating assistant message:",e)}},fetchAndUpdateMessages:async()=>{try{console.log("Fetching and updating messages"),ek.current=!1,X(0),V(!1),await eJ()}catch(e){console.error("Error fetching and updating messages:",e)}},submitHumanMessage:e=>{if(o&&!o(e,[])){N(e),C([]);return}N(e),C([]),setTimeout(()=>{N("");let t={id:"user-".concat(Date.now().toString()),role:"user",content:e};v(e=>[...e,t]),setTimeout(()=>{var e;null===(e=ew.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})},100),eG("user",e,"completed").then(s=>{s&&v(e=>e.map(e=>e.id===t.id?{...e,id:s.message._id}:e)),n(e,[],!1,!1,!1,s.message._id,!1,[],$,en)}).catch(e=>{console.error("Error sending message:",e)})},0)}}));let eV=async e=>{var t;if(!(null===(t=e.target.files)||void 0===t?void 0:t.length))return;E(!0);let s=Array.from(e.target.files).filter(e=>["image/jpeg","image/png","image/gif","image/webp"].includes(e.type)&&e.size<=5242880);if(0===s.length){E(!1);return}try{let e=[...k];for(let t of s){let s=await eB(t);s&&e.push(s)}C(e)}finally{E(!1),eC.current&&(eC.current.value="")}},eq=async e=>{E(!0);try{let t=await eB(e);t?C(e=>[...e,t]):m.oR.error("Failed to upload pasted image")}catch(e){console.error("Error uploading pasted image:",e),m.oR.error("Failed to upload pasted image")}finally{E(!1)}},eY=async()=>{if(!w.trim()&&0===k.length||i)return;let e=[...k];if(o&&!o(w,e))return;let t={id:"user-".concat(Date.now().toString()),role:"user",content:w,attachments:k.length>0?[...k]:void 0};v(e=>[...e,t]),N(""),C([]),setTimeout(()=>{var e;null===(e=ew.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})},100);try{let s=await eG("user",w,"completed",e);s&&v(e=>e.map(e=>e.id===t.id?{...e,id:s.message._id}:e)),n(w,e.length>0?e:[],!1,!1,!1,s.message._id,!1,[],$,en)}catch(e){console.error("Error sending message:",e)}},eK=async e=>{if(D.trim()&&!I){A(!0);try{let t=await fetch("/api/users/supabase",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({key:D})});if(!t.ok||200!==t.status){let e=await t.json();throw Error(e.error||"Failed to save Supabase key")}v(t=>t.map(t=>t.id===e?{...t,status:Z.COMPLETED,content:"Successfully added access token. Continuing.."}:t)),T("");let s="",r=[],a="";for(let e=b.length-1;e>=0;e--)if("user"===b[e].role){s=b[e].content,r=b[e].attachments||[],a=b[e].id;break}s.trim()&&setTimeout(()=>{n(s,r,!0,!1,!1,a,!1,[],$,en)},500)}catch(e){m.oR.error((null==e?void 0:e.message)||"Failed to save Supabase key. Please try again.")}finally{A(!1)}}},eX=async(e,t,s)=>{if(!L){P(!0);try{if(s){let e=await fetch("/api/projects/databasepad",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({projectId:c,id:t})});if(!e.ok||200!==e.status){let t=await e.json();throw Error(t.error||"Failed to set up database")}}else{let r=await fetch("/api/projects/supabase",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({projectId:c,id:t,isInternal:s})});if(!r.ok||200!==r.status){let e=await r.json();throw Error(e.error||"Failed to set up database")}v(t=>t.map(t=>t.id===e?{...t,status:Z.STATUS,content:"Setting up database. Please wait..."}:t));let a=!1,n=0;for(;!a;){let e=await fetch("/api/projects/supabase-status?projectId=".concat(c),{method:"GET",headers:{"Content-Type":"application/json"}});if(!e.ok||200!==e.status)throw Error("Failed to check project health status");if(a=(await e.json()).isHealthy)break;if(++n>60)throw Error("Failed to check project health status");await new Promise(e=>setTimeout(e,5e3))}let o=await fetch("/api/projects/supabase-keys",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({projectId:c})});if(!o.ok||200!==o.status){let e=await o.json();throw Error(e.error||"Failed to set up database")}}v(t=>t.map(t=>t.id===e?{...t,status:Z.STATUS,content:"Successfully set up database. Continuing..."}:t));let r="",a=[],o="";for(let e=b.length-1;e>=0;e--)if("user"===b[e].role){r=b[e].content,a=b[e].attachments||[],o=b[e].id;break}r.trim()&&setTimeout(()=>{n(r,a,!0,!1,!1,o,!1,[],$,en)},500)}catch(e){m.oR.error((null==e?void 0:e.message)||"Failed to set up database. Please try again.",{duration:1e4})}finally{P(!1)}}},e$=async(e,t)=>{var s;if((null===(s=M[t])||void 0===s?void 0:s.trim())&&!_[t]){B(e=>({...e,[t]:!0}));try{let s=b.find(t=>t.id===e),r=(null==s?void 0:s.secrets)?s.secrets.filter(e=>e.name!==t).length:0,a=0===r,o=await fetch("/api/projects/secrets",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({projectId:c,secretName:t,secretValue:M[t],hasMoreSecrets:!a})});if(!o.ok||200!==o.status){let e=await o.json();throw Error(e.error||"Failed to save secret")}if(v(s=>s.map(s=>{if(s.id===e){let e=(s.secrets||[]).filter(e=>e.name!==t);return 0===e.length?{...s,status:Z.COMPLETED,content:"Successfully added secrets. Continuing...",secrets:[]}:{...s,secrets:e}}return s})),O(e=>{let s={...e};return delete s[t],s}),a){let e="",t=[],s="";for(let r=b.length-1;r>=0;r--)if("user"===b[r].role){e=b[r].content,t=b[r].attachments||[],s=b[r].id;break}e.trim()&&setTimeout(()=>{n(e,t,!0,!1,!0,s,!1,[],$,en)},500)}}catch(e){m.oR.error((null==e?void 0:e.message)||"Failed to save secret. Please try again.")}finally{B(e=>({...e,[t]:!1}))}}},eQ=async(e,t)=>{let s=b.find(t=>t.id===e),r=0===((null==s?void 0:s.secrets)?s.secrets.filter(e=>e.name!==t).length:0);v(s=>s.map(s=>{if(s.id===e){let e=(s.secrets||[]).filter(e=>e.name!==t);return 0===e.length?{...s,status:Z.COMPLETED,content:"Skipped secrets. Continuing.",secrets:[]}:{...s,secrets:e}}return s})),O(e=>{let s={...e};return delete s[t],s});try{let s=await fetch("/api/projects/skipsecrets",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({projectId:c,messageId:e,secretName:t,hasMoreSecrets:!r})});if(!s.ok||200!==s.status){let e=await s.json();throw Error(e.error||"Failed to skip secret")}if(r){let e="",t=[],s="";for(let r=b.length-1;r>=0;r--)if("user"===b[r].role){e=b[r].content,t=b[r].attachments||[],s=b[r].id;break}e.trim()&&setTimeout(()=>{n(e,t,!0,!1,!0,s,!1,[],$,en)},500)}}catch(e){m.oR.error((null==e?void 0:e.message)||"Failed to skip secret. Please try again.")}},eZ=async e=>{try{v(t=>t.map(t=>t.id===e?{...t,status:Z.COMPLETED,content:"Skipped database integration. Continuing."}:t));let t=await fetch("/api/users/skipsupabase",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({projectId:c,messageId:e})});if(!t.ok||200!==t.status){let e=await t.json();throw Error(e.error||"Failed to skip database integration")}let s="",r=[],a="";for(let e=b.length-1;e>=0;e--)if("user"===b[e].role){s=b[e].content,r=b[e].attachments||[],a=b[e].id;break}s.trim()&&setTimeout(()=>{n(s,r,!1,!0,!1,a,!1,[],$,en)},500)}catch(e){m.oR.error((null==e?void 0:e.message)||"Failed to skip database integration. Please try again.")}},e0=async e=>{try{v(t=>t.map(t=>t.id===e?{...t,status:Z.COMPLETED,content:"Skipped database project selection. Continuing."}:t));let t=await fetch("/api/projects/skipsupabase",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({projectId:c,messageId:e})});if(!t.ok||200!==t.status){let e=await t.json();throw Error(e.error||"Failed to skip database project selection")}let s="",r=[],a="";for(let e=b.length-1;e>=0;e--)if("user"===b[e].role){s=b[e].content,r=b[e].attachments||[],a=b[e].id;break}s.trim()&&setTimeout(()=>{n(s,r,!1,!0,!1,a,!1,[],$,en)},500)}catch(e){m.oR.error((null==e?void 0:e.message)||"Failed to skip database project selection. Please try again.")}},e1=async e=>{if(i)return;if(o&&!o(e,[])){N(e);return}let t={id:"user-".concat(Date.now().toString()),role:"user",content:e,attachments:void 0};v(e=>[...e,t]),N(""),C([]),setTimeout(()=>{var e;null===(e=ew.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})},100);try{let s=await eG("user",e,"completed",[]);s&&v(e=>e.map(e=>e.id===t.id?{...e,id:s.message._id}:e)),n(e,[],!1,!1,!1,s.message._id,!1,[],$,en)}catch(e){console.error("Error sending suggestion message:",e)}},e2=async(e,t)=>{try{v(s=>s.map(s=>s.id===e?{...s,outcome:t}:s)),m.oR.success("Thank you for your feedback!",{duration:4e3});let s=await fetch("/api/messages/vote",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({messageId:e,outcome:t})});if(!s.ok){let e=await s.json();throw Error(e.error||"Failed to record vote")}}catch(e){console.error(e)}},e4=async e=>{try{G(t=>({...t,[e]:!0}));let t=R[e]||{},s=U[e]||{},r=Object.entries(t).filter(e=>{let[t,r]=e;return!s[t]&&r.trim()}).map(e=>{let[t,s]=e;return{question:t,answer:s}});v(t=>t.map(t=>t.id===e?{...t,status:Z.COMPLETED,content:r.length>0?"Answers provided. Continuing...":"Questions skipped. Continuing..."}:t));let a="",o=[],l="";for(let e=b.length-1;e>=0;e--)if("user"===b[e].role){a=b[e].content,o=b[e].attachments||[],l=b[e].id;break}a.trim()&&setTimeout(()=>{n(a,o,!1,!1,!1,l,!0,r,$,en)},500)}catch(e){m.oR.error((null==e?void 0:e.message)||"Failed to submit answers. Please try again.")}finally{G(t=>({...t,[e]:!1}))}};return(0,r.jsxs)("div",{className:"flex flex-col h-full overflow-hidden ".concat(y?"pb-safe":""),onDragOver:e=>{e.preventDefault(),e.stopPropagation(),e.dataTransfer&&(e.dataTransfer.dropEffect="copy")},onDrop:ez,children:[!h&&(0,r.jsx)("div",{className:"px-4 py-3 border-b border-gray-200 dark:border-gray-700",children:(0,r.jsx)("h2",{className:"text-base font-semibold text-gray-900 dark:text-white",children:"Chat"})}),(0,r.jsxs)("div",{className:"flex-1 overflow-y-auto overflow-x-hidden p-2 sm:p-4 space-y-3 sm:space-y-4 ".concat(y?"pb-safe":""),children:[0===b.length?(0,r.jsx)("div",{className:"flex items-center justify-center h-full text-gray-400 text-sm",children:(0,r.jsx)("p",{children:"No messages yet. Start by suggesting a change."})}):(0,r.jsxs)("div",{className:"space-y-3 sm:space-y-4",children:[H&&(0,r.jsx)("div",{className:"flex justify-center pb-2",children:(0,r.jsx)("button",{onClick:eH,disabled:q,className:"px-4 py-2 rounded-lg text-sm font-medium transition-colors ".concat(q?"bg-gray-200 dark:bg-gray-700 text-gray-500 dark:text-gray-400 cursor-not-allowed":"bg-gray-100 dark:bg-gray-800 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-700 border border-gray-200 dark:border-gray-600"),children:q?(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsxs)("svg",{className:"animate-spin w-4 h-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,r.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"2"}),(0,r.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),(0,r.jsx)("span",{children:"Loading..."})]}):(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 15l7-7 7 7"})}),(0,r.jsx)("span",{children:"Load More Messages"})]})})}),b.map((e,t)=>{var s;return(0,r.jsxs)(a.Fragment,{children:[(0,r.jsx)("div",{className:"flex ".concat("user"===e.role?"justify-end":"justify-start"),children:(0,r.jsxs)("div",{className:"max-w-[92%] sm:max-w-[85%] rounded-lg p-2 sm:p-3 overflow-hidden ".concat("user"===e.role?"bg-gray-100 dark:bg-gray-700 text-gray-800 dark:text-gray-200":e.status===Z.LOADING?"bg-primary text-white":e.status===Z.ERROR?"bg-red-50 dark:bg-red-900/20 text-red-600 dark:text-red-300 border border-red-200 dark:border-red-900/50":e.status===Z.STATUS?"bg-blue-50 dark:bg-blue-900/20 text-blue-600 dark:text-blue-300 border border-blue-200 dark:border-blue-900/50":e.status===Z.NEED_SUPABASE_KEY||e.status===Z.CHOOSE_SUPABASE_PROJECT?"bg-white text-black":e.status===Z.NEED_ANSWERS?"bg-purple-50 dark:bg-purple-900/20 text-purple-900 dark:text-purple-200 border border-purple-200 dark:border-purple-900/50":"bg-primary text-white"),children:[e.status===Z.ERROR&&(0,r.jsx)("div",{className:"flex items-center justify-between mb-1",children:(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("div",{className:"mr-2 text-red-500",children:(0,r.jsx)("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),(0,r.jsx)("span",{className:"text-xs text-red-500",children:"Error occurred"})]})}),e.status===Z.STATUS&&(0,r.jsxs)("div",{className:"flex items-center mb-1",children:[(0,r.jsx)("div",{className:"mr-2 text-blue-500",children:(0,r.jsx)("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),(0,r.jsx)("span",{className:"text-xs text-blue-500",children:"Status update"})]}),e.status===Z.NEED_SUPABASE_KEY&&(0,r.jsxs)("div",{className:"flex flex-col space-y-2 mb-1",children:[(0,r.jsxs)("div",{className:"text-sm mb-2",children:[(0,r.jsx)("p",{children:"You'll need to have a Supabase account to add backend functionality:"}),(0,r.jsxs)("ol",{className:"list-decimal list-inside mt-2 ml-1 space-y-1",children:[(0,r.jsxs)("li",{children:["Go to ",(0,r.jsx)("a",{href:"https://supabase.com",target:"_blank",rel:"noopener noreferrer",className:"text-blue-500 underline",children:"Supabase.com"})," to log in or sign up for a free account"]}),(0,r.jsxs)("li",{children:["Go to ",(0,r.jsx)("a",{href:"https://supabase.com/dashboard/account/tokens",target:"_blank",rel:"noopener noreferrer",className:"text-blue-500 underline",children:"Access Tokens"})]}),(0,r.jsx)("li",{children:"Generate a new token"}),(0,r.jsx)("li",{children:"Paste it below"})]})]}),(0,r.jsxs)("div",{className:"mt-3",children:[(0,r.jsxs)("div",{className:"flex space-x-2",children:[(0,r.jsx)("div",{className:"flex-1",children:(0,r.jsx)("input",{type:"password",value:D,onChange:e=>T(e.target.value),placeholder:"Paste token",className:"w-full px-3 py-2 border border-gray-300 rounded-md bg-white text-gray-900 text-sm focus:outline-none focus:ring-1 focus:ring-gray-500 focus:border-gray-500",disabled:I})}),(0,r.jsx)("button",{onClick:()=>eK(e.id),disabled:!D.trim()||I,className:"px-4 py-2 rounded-md text-sm font-medium ".concat(!D.trim()||I?"bg-gray-400 text-white cursor-not-allowed":"bg-black text-white"),children:I?(0,r.jsxs)("svg",{className:"animate-spin w-4 h-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,r.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"2"}),(0,r.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):"Submit"})]}),(0,r.jsxs)("div",{className:"mt-3 flex justify-between items-center",children:[(0,r.jsxs)("div",{className:"relative group",children:[(0,r.jsxs)("span",{className:"text-xs text-blue-500 hover:text-blue-700 cursor-help flex items-center",children:[(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3 w-3 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Why do I need this?"]}),(0,r.jsx)("div",{className:"opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-opacity duration-200 absolute bottom-full left-28 transform -translate-x-1/2 mb-2 w-[180%] bg-gray-900 text-white text-xs rounded-md p-3 shadow-lg z-10",children:(0,r.jsx)("div",{className:"relative",children:(0,r.jsx)("p",{className:"mb-2",children:"Supabase is a platform that lets you build web apps quickly by providing a hosted database, user login system, file storage, and other features that need to run on a secure server. The cloud version at supabase.com manages all the setup and infrastructure for you, so you can focus on building your app without worrying about backend servers."})})})]}),(0,r.jsx)("div",{className:"text-xs text-gray-500 hover:text-gray-700 hover:underline cursor-pointer",onClick:t=>{t.stopPropagation(),eZ(e.id)},children:"Skip"})]})]})]}),e.status===Z.CHOOSE_SUPABASE_PROJECT&&(0,r.jsx)("div",{className:"flex flex-col space-y-2 mb-1",children:(0,r.jsxs)("div",{className:"text-sm",children:[(0,r.jsx)("p",{children:"Choose or create a database for your backend:"}),e.supabaseProjects&&e.supabaseProjects.length>0&&(0,r.jsx)("div",{className:"mt-3 space-y-2",children:(0,r.jsx)("div",{className:"grid grid-cols-1 gap-2",children:e.supabaseProjects.map(t=>(0,r.jsxs)("button",{onClick:()=>eX(e.id,t.id,t.isInternal),disabled:L,className:"flex flex-col items-start px-4 py-3 border border-gray-300 rounded-md bg-white text-gray-800 text-sm hover:bg-gray-50 focus:outline-none focus:ring-1 focus:ring-gray-500 focus:border-gray-500 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[(0,r.jsxs)("div",{className:"flex items-center w-full mb-1",children:[(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 mr-2 text-emerald-500 flex-shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 12h14M12 5l7 7-7 7"})}),(0,r.jsx)("span",{className:"font-medium",children:t.name})]}),(0,r.jsx)("div",{className:"ml-6 text-xs text-gray-500",children:t.id})]},t.id))})}),(0,r.jsx)("div",{className:"mt-2",children:(0,r.jsxs)("button",{onClick:()=>eX(e.id,null,!1),disabled:L,className:"w-full flex items-center justify-center px-4 py-3 border border-blue-500 rounded-md bg-blue-50 text-blue-700 text-sm hover:bg-blue-100 focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 mr-2 flex-shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),(0,r.jsx)("span",{className:"font-medium",children:"Create a new Supabase database"})]})}),(null==J?void 0:null===(s=J.user)||void 0===s?void 0:s.isAdmin)===!0&&(0,r.jsx)("div",{className:"mt-2",children:(0,r.jsxs)("button",{onClick:()=>eX(e.id,null,!0),disabled:L,className:"w-full flex items-center justify-center px-4 py-3 border border-blue-500 rounded-md bg-blue-50 text-blue-700 text-sm hover:bg-blue-100 focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 mr-2 flex-shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),(0,r.jsx)("span",{className:"font-medium",children:(null==eL?void 0:eL.hasEncryptedSupabaseKey)?"Create a new Famous.ai database":"Create a new database"})]})}),(0,r.jsxs)("div",{className:"mt-3 flex justify-between items-center",children:[(0,r.jsxs)("div",{className:"relative group",children:[(0,r.jsxs)("span",{className:"text-xs text-blue-500 hover:text-blue-700 cursor-help flex items-center",children:[(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3 w-3 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Which should I choose?"]}),(0,r.jsx)("div",{className:"opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-opacity duration-200 absolute bottom-full left-32 transform -translate-x-1/2 mb-2 w-[180%] bg-gray-900 text-white text-xs rounded-md p-3 shadow-lg z-10",children:(0,r.jsx)("div",{className:"relative",children:(0,r.jsx)("p",{className:"mb-2",children:"Choose an existing project if you want to connect to a backend or database you've already set up. Create a new project if this integration is for a separate app or feature, so you can keep things organized and avoid conflicts in your database or backend."})})})]}),(0,r.jsx)("div",{className:"text-xs text-gray-500 hover:text-gray-700 hover:underline cursor-pointer",onClick:t=>{t.stopPropagation(),e0(e.id)},children:"Skip"})]})]})}),e.status===Z.NEED_SECRETS&&e.secrets&&e.secrets.length>0&&(0,r.jsxs)("div",{className:"flex flex-col space-y-2 mb-1",children:[(0,r.jsx)("div",{className:"text-sm mb-2",children:(0,r.jsx)("p",{children:"To add this functionality, you'll need to add some secrets:"})}),e.secrets.map(t=>{var s,a;return(0,r.jsxs)("div",{className:"mt-3 p-3 border border-gray-200 dark:border-gray-700 rounded-md bg-white",children:[(0,r.jsxs)("div",{className:"mb-2",children:[(0,r.jsx)("div",{className:"font-medium text-black",children:t.name}),(0,r.jsx)("div",{className:"text-xs text-gray-800 mt-1",children:t.reason})]}),(0,r.jsxs)("div",{className:"flex space-x-2 mt-2",children:[(0,r.jsx)("div",{className:"flex-1",children:(0,r.jsx)("input",{type:"password",value:M[t.name]||"",onChange:e=>O(s=>({...s,[t.name]:e.target.value})),placeholder:"Enter value for ".concat(t.name),className:"w-full px-3 py-2 border border-gray-300 rounded-md bg-white text-gray-900 text-sm focus:outline-none focus:ring-1 focus:ring-gray-500 focus:border-gray-500",disabled:_[t.name]})}),(0,r.jsx)("button",{onClick:()=>e$(e.id,t.name),disabled:!(null===(s=M[t.name])||void 0===s?void 0:s.trim())||_[t.name],className:"px-4 py-2 rounded-md text-sm font-medium ".concat((null===(a=M[t.name])||void 0===a?void 0:a.trim())&&!_[t.name]?"bg-black text-white hover:bg-gray-800":"bg-gray-400 text-white cursor-not-allowed"),children:_[t.name]?(0,r.jsxs)("svg",{className:"animate-spin w-4 h-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,r.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"2"}),(0,r.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):"Submit"})]}),(0,r.jsxs)("div",{className:"mt-2 flex justify-between items-center",children:[(0,r.jsxs)("div",{className:"relative group",children:[(0,r.jsxs)("div",{className:"text-xs text-blue-600 hover:text-blue-700 cursor-help flex items-center",children:[(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3 w-3 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,r.jsx)("span",{children:"How to get this?"})]}),(0,r.jsx)("div",{className:"opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-opacity duration-200 absolute bottom-full left-24 transform -translate-x-1/2 mb-2 w-[180%] bg-gray-900 text-white text-xs rounded-md p-3 shadow-lg z-10",children:(0,r.jsx)("div",{className:"relative",children:(0,r.jsx)("p",{className:"mb-2",children:t.instructions})})})]}),(0,r.jsx)("div",{className:"text-xs text-gray-500 hover:text-gray-700 hover:underline cursor-pointer",onClick:s=>{s.stopPropagation(),eQ(e.id,t.name)},children:"Skip"})]})]},t.name)})]}),e.status===Z.NEED_ANSWERS&&e.questions&&e.questions.length>0&&(0,r.jsxs)("div",{className:"flex flex-col space-y-2 mb-1",children:[(0,r.jsx)("div",{className:"text-sm mb-2 text-purple-900 dark:text-purple-200",children:(0,r.jsx)("p",{children:"I have a few questions to better understand your request."})}),e.questions.map((t,s)=>{var a,n;return(null===(a=U[e.id])||void 0===a?void 0:a[t])?null:(0,r.jsxs)("div",{className:"mt-3 p-3 border border-purple-200 dark:border-purple-700 rounded-md bg-white dark:bg-gray-800",children:[(0,r.jsx)("div",{className:"mb-2",children:(0,r.jsx)("div",{className:"font-medium text-purple-900 dark:text-purple-200",children:t})}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("textarea",{value:(null===(n=R[e.id])||void 0===n?void 0:n[t])||"",onChange:s=>F(r=>({...r,[e.id]:{...r[e.id]||{},[t]:s.target.value}})),placeholder:"Type your answer here...",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 text-sm focus:outline-none focus:ring-1 focus:ring-purple-500 focus:border-purple-500 resize-none",rows:3,disabled:W[e.id]}),(0,r.jsx)("div",{className:"flex justify-end",children:(0,r.jsx)("div",{className:"text-xs text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-200 hover:underline cursor-pointer",onClick:s=>{s.stopPropagation(),z(s=>({...s,[e.id]:{...s[e.id]||{},[t]:!0}}))},children:"Skip this question"})})]})]},s)}),e.questions.some(t=>{var s;return!(null===(s=U[e.id])||void 0===s?void 0:s[t])})&&(0,r.jsx)("div",{className:"mt-4 flex justify-center",children:(0,r.jsx)("button",{onClick:()=>e4(e.id),disabled:W[e.id],className:"px-6 py-2 rounded-md text-sm font-medium ".concat(W[e.id]?"bg-gray-400 text-white cursor-not-allowed":"bg-purple-600 hover:bg-purple-700 text-white"),children:W[e.id]?(0,r.jsxs)("svg",{className:"animate-spin w-4 h-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,r.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"2"}),(0,r.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):"Submit Answers"})}),e.questions.every(t=>{var s;return null===(s=U[e.id])||void 0===s?void 0:s[t]})&&(0,r.jsxs)("div",{className:"mt-4 flex flex-col items-center",children:[(0,r.jsx)("button",{onClick:()=>e4(e.id),disabled:W[e.id],className:"px-6 py-2 rounded-md text-sm font-medium ".concat(W[e.id]?"bg-gray-400 text-white cursor-not-allowed":"bg-gray-600 hover:bg-gray-700 text-white"),children:W[e.id]?(0,r.jsxs)("svg",{className:"animate-spin w-4 h-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,r.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"2"}),(0,r.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):"Continue Without Answers"}),(0,r.jsx)("div",{className:"mt-2 text-xs text-gray-500 dark:text-gray-400",children:"(refresh the page to see questions again)"})]})]}),e.attachments&&e.attachments.length>0&&(0,r.jsx)("div",{className:"mb-2",children:(0,r.jsx)("div",{className:"flex flex-wrap gap-1 mt-1",children:e.attachments.map((e,t)=>(0,r.jsx)("div",{className:"relative w-24 h-24 bg-gray-100 dark:bg-gray-600 rounded overflow-hidden",children:(0,r.jsx)("img",{src:e,alt:"Attachment ".concat(t+1),className:"w-full h-full object-cover"})},t))})}),(0,r.jsx)(er,{message:e,onUpgradeClick:()=>eA(!0)}),e.status===Z.ERROR&&g&&(0,r.jsxs)("div",{className:"flex space-x-2 mt-3",children:[(0,r.jsxs)("button",{onClick:t=>{t.stopPropagation();let s=e.createdAt?new Date(e.createdAt):void 0;g(e.content,s)},className:"flex items-center space-x-1 px-3 py-1 rounded-full text-xs transition-colors border border-gray-50 hover:bg-gray-50 text-gray-50 hover:text-gray-800",children:[(0,r.jsxs)("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]}),(0,r.jsx)("span",{children:"View error"})]}),(0,r.jsxs)("button",{onClick:t=>{t.stopPropagation(),f&&f(e.content)},className:"flex items-center space-x-1 px-3 py-1 rounded-full text-xs transition-colors border border-gray-50 hover:bg-gray-50 text-gray-50 hover:text-gray-800",children:[(0,r.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"w-3 h-3",children:[(0,r.jsx)("path",{d:"m21.64 3.64-1.28-1.28a1.21 1.21 0 0 0-1.72 0L2.36 18.64a1.21 1.21 0 0 0 0 1.72l1.28 1.28a1.2 1.2 0 0 0 1.72 0L21.64 5.36a1.2 1.2 0 0 0 0-1.72"}),(0,r.jsx)("path",{d:"m14 7 3 3"}),(0,r.jsx)("path",{d:"M5 6v4"}),(0,r.jsx)("path",{d:"M19 14v4"}),(0,r.jsx)("path",{d:"M10 2v2"}),(0,r.jsx)("path",{d:"M7 8H3"}),(0,r.jsx)("path",{d:"M21 16h-4"})]}),(0,r.jsx)("span",{children:"Try to fix it"})]})]})]})}),e.preview&&(0,r.jsx)(es,{messageId:e.id,preview:e.preview,projectPreview:u,restoringPreview:p,onRestorePreview:x,timestamp:e.createdAt,messageContent:"assistant"!==e.role||e.status!==Z.COMPLETED||e.content.startsWith("Build successful")||e.content.startsWith("Successfully")||e.content.startsWith("Build unsuccessful")?void 0:e.content,actions:e.actions,totalCost:e.totalCost,duration:e.duration,suggestions:e.suggestions,onSuggestionClick:e1,isLastCheckpoint:t===b.length-1})]},e.id)})]}),(()=>{let e=b.filter(e=>"assistant"===e.role).slice(-1)[0];return e&&e.experiment&&e.variation&&!e.outcome?(0,r.jsx)("div",{className:"flex justify-center",children:(0,r.jsxs)("div",{className:"bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg p-3 shadow-sm",children:[(0,r.jsx)("div",{className:"text-xs text-gray-500 dark:text-gray-400 text-center mb-2",children:"How was this change?"}),(0,r.jsxs)("div",{className:"flex space-x-3 justify-center",children:[(0,r.jsxs)("button",{onClick:async()=>{await e2(e.id,"up")},className:"flex items-center space-x-2 px-4 py-2 rounded-lg text-sm transition-colors bg-gray-50 dark:bg-gray-700 text-gray-700 dark:text-gray-300 border border-gray-200 dark:border-gray-600 hover:bg-gray-100 dark:hover:bg-gray-600",children:[(0,r.jsxs)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",viewBox:"0 0 24 24",children:[(0,r.jsx)("path",{d:"M7 10v12"}),(0,r.jsx)("path",{d:"M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2a3.13 3.13 0 0 1 3 3.88Z"})]}),(0,r.jsx)("span",{children:"Good"})]}),(0,r.jsxs)("button",{onClick:async()=>{await e2(e.id,"down")},className:"flex items-center space-x-2 px-4 py-2 rounded-lg text-sm transition-colors bg-gray-50 dark:bg-gray-700 text-gray-700 dark:text-gray-300 border border-gray-200 dark:border-gray-600 hover:bg-gray-100 dark:hover:bg-gray-600",children:[(0,r.jsxs)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",viewBox:"0 0 24 24",children:[(0,r.jsx)("path",{d:"M17 14V2"}),(0,r.jsx)("path",{d:"M9 18.12 10 14H4.17a2 2 0 0 1-1.92-2.56l2.33-8A2 2 0 0 1 6.5 2H20a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2h-2.76a2 2 0 0 0-1.79 1.11L12 22a3.13 3.13 0 0 1-3-3.88Z"}),"                    "]}),(0,r.jsx)("span",{children:"Bad"})]})]})]})}):null})(),y&&i&&b.length>0&&!eS&&(0,r.jsx)("div",{className:"flex flex-col items-center justify-center",children:(0,r.jsxs)("svg",{className:"animate-spin h-4 w-4 text-primary",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,r.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,r.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})}),(0,r.jsx)("div",{ref:ew})]}),(0,r.jsx)("div",{className:"p-2 sm:p-3 border-t border-gray-200 dark:border-gray-700 ".concat(y?"pb-safe":""),children:(0,r.jsxs)("div",{className:"flex flex-col",children:[(0,r.jsxs)("div",{className:"flex items-center justify-start space-x-6 mb-3 px-1",children:[(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsxs)("label",{className:"flex items-center cursor-pointer group select-none",onMouseEnter:()=>ed(!0),onMouseLeave:()=>ed(!1),children:[(0,r.jsx)("span",{className:"text-xs text-gray-600 dark:text-gray-400 group-hover:text-gray-800 dark:group-hover:text-gray-200 transition-colors mr-2",children:"Bulldozer"}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("input",{type:"checkbox",className:"sr-only peer",checked:ex,onChange:e=>ep(e.target.checked)}),(0,r.jsx)("div",{className:"w-8 h-4 bg-gray-300 dark:bg-gray-700 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-4 peer-checked:after:border-white after:content-[''] after:absolute after:top-0.5 after:left-0.5 after:bg-white after:border-gray-300 after:border after:rounded-full after:h-3 after:w-3 after:transition-all peer-checked:bg-blue-600 dark:peer-checked:bg-blue-500"})]})]}),ec&&(0,r.jsxs)("div",{className:"absolute bottom-full left-0 mb-2 px-2 py-1 bg-gray-700 text-white text-xs rounded shadow-lg border border-gray-700 z-10 w-56",children:["Bulldozer mode allows for long-running changes with deep thinking and meticulous implementation. Perfect for complex, multi-step tasks, or long prompts.",(0,r.jsx)("div",{className:"absolute top-full left-8 w-0 h-0 border-l-4 border-r-4 border-t-4 border-transparent border-t-gray-700"})]})]}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsxs)("label",{className:"flex items-center cursor-pointer group select-none",onMouseEnter:()=>em(!0),onMouseLeave:()=>em(!1),children:[(0,r.jsx)("span",{className:"text-xs text-gray-600 dark:text-gray-400 group-hover:text-gray-800 dark:group-hover:text-gray-200 transition-colors mr-2",children:"Genius"}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("input",{type:"checkbox",className:"sr-only peer",checked:eb,onChange:e=>ev(e.target.checked)}),(0,r.jsx)("div",{className:"w-8 h-4 bg-gray-300 dark:bg-gray-700 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-4 peer-checked:after:border-white after:content-[''] after:absolute after:top-0.5 after:left-0.5 after:bg-white after:border-gray-300 after:border after:rounded-full after:h-3 after:w-3 after:transition-all peer-checked:bg-blue-600 dark:peer-checked:bg-blue-500"})]})]}),eu&&(0,r.jsxs)("div",{className:"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-2 py-1 bg-gray-700 text-white text-xs rounded shadow-lg border border-gray-700 z-10 w-56 whitespace-normal",children:["Genius mode provides enhanced reasoning and problem-solving capabilities for tackling challenging tasks. It's more expensive, so use judiciously.",(0,r.jsx)("div",{className:"absolute top-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-l-4 border-r-4 border-t-4 border-transparent border-t-gray-700"})]})]})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsxs)("div",{className:"flex-1 relative",children:[(0,r.jsx)("textarea",{ref:ej,className:"w-full min-h-[60px] sm:min-h-[76px] max-h-40 border border-gray-300 dark:border-gray-600 rounded-lg p-2 pr-10 resize-none bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:outline-none focus:ring-1 focus:ring-primary focus:border-transparent text-sm",style:{maxHeight:"200px",fontSize:y?"16px":void 0},placeholder:"Suggest a change or ask a question...",value:w,onChange:e=>N(e.target.value),onKeyDown:e=>{"Enter"===e.key&&(e.shiftKey?e.stopPropagation():(e.preventDefault(),eY()))},onPaste:e=>{let{items:t}=e.clipboardData;for(let s=0;s<t.length;s++)if(-1!==t[s].type.indexOf("image")){let r=t[s].getAsFile();r&&(e.preventDefault(),eq(r));break}},rows:3}),(0,r.jsx)("input",{type:"file",ref:eC,className:"hidden",accept:"image/jpeg,image/png,image/gif,image/webp",multiple:!0,onChange:eV,disabled:i||S}),(0,r.jsx)("button",{type:"button",onClick:()=>{var e;null===(e=eC.current)||void 0===e||e.click()},className:"absolute right-2 top-2 text-gray-500 hover:text-primary",disabled:i||S,children:S?(0,r.jsxs)("svg",{className:"animate-spin w-5 h-5",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,r.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"2"}),(0,r.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):(0,r.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})})})]}),(0,r.jsx)("button",{className:"p-2 rounded-lg ".concat(i&&b.length>0&&!eS?"bg-gray-600 text-gray-300 hover:text-gray-200 hover:bg-gray-700":w.trim()||0!==k.length?"".concat(!eD&&"bg-blue-600 hover:bg-blue-700"," text-white"):"bg-gray-200 dark:bg-gray-700 text-gray-400 dark:text-gray-500 cursor-not-allowed"," transition-colors"),style:{backgroundColor:!(i&&b.length>0&&!eS)&&!(!w.trim()&&0===k.length)&&eD&&(null==eT?void 0:eT.tertiaryColor)||void 0},onClick:i&&b.length>0?()=>{l()}:eY,disabled:!i&&!w.trim()&&0===k.length,children:i&&b.length>0&&!eS?(0,r.jsx)("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,r.jsx)("rect",{x:"3",y:"3",width:"18",height:"18"})}):(0,r.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 19l9 2-9-18-9 18 9-2zm0 0v-8"})})})]}),k.length>0&&(0,r.jsx)("div",{className:"mt-2 flex flex-wrap gap-3",children:k.map((e,t)=>(0,r.jsxs)("div",{className:"relative",style:{width:"64px",height:"64px",margin:"4px"},children:[(0,r.jsx)("div",{className:"w-16 h-16 bg-gray-100 dark:bg-gray-600 rounded overflow-hidden",children:(0,r.jsx)("img",{src:e,alt:"Attachment ".concat(t+1),className:"w-full h-full object-cover"})}),(0,r.jsx)("div",{className:"absolute",style:{top:"-7px",right:"-7px"},children:(0,r.jsx)("button",{onClick:e=>{e.stopPropagation(),C(e=>e.filter((e,s)=>s!==t))},className:"bg-gray-500 text-white rounded-full w-5 h-5 flex items-center justify-center hover:bg-gray-600 shadow-md z-10","aria-label":"Remove image",children:(0,r.jsx)("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})})]},t))})]})}),eL&&(0,r.jsx)(Q.A,{isOpen:eI,onClose:()=>{eA(!1)},currentTier:null==eL?void 0:eL.tier,currentUsage:null==eL?void 0:eL.messageCount,currentLimit:null==eL?void 0:eL.limit,subscriptionData:eL})]})});function en(e){let{isOpen:t,onClose:s,errorMessage:n,onTryToFixIt:o,timestamp:l}=e,[i,c]=(0,a.useState)(!1),[d,u]=(0,a.useState)(!1);if((0,a.useEffect)(()=>{let e=()=>{u(window.innerWidth<768)};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),!t)return null;let m=e=>e.replace(/^\d+\.\d+\s+/gm,"").replace(/^#\d+\s+\d+\.\d+\s+/gm,""),x=l?l.toLocaleString("en-US",{weekday:"long",hour:"numeric",minute:"numeric"}):"",p=async()=>{let e=m(n);try{await navigator.clipboard.writeText(e),c(!0),setTimeout(()=>{c(!1)},2e3)}catch(e){console.error("Failed to copy error message: ",e)}},h=()=>{o&&o()};return(0,r.jsx)("div",{className:"absolute inset-0 bg-gray-900 shadow-lg rounded-lg overflow-hidden",children:(0,r.jsxs)("div",{className:"flex h-full flex-col",children:[d?(0,r.jsxs)("div",{className:"p-4 border-b border-gray-700",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,r.jsx)("h2",{className:"text-lg font-medium text-white",children:"Build error"}),(0,r.jsx)("button",{onClick:s,className:"text-gray-400",children:(0,r.jsx)("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("span",{className:"text-gray-400 text-sm font-normal",children:x}),(0,r.jsx)("button",{onClick:h,className:"inline-flex items-center px-3 py-1.5 border border-gray-700 rounded-md shadow-sm text-sm font-medium text-gray-800 bg-white hover:bg-gray-100 hover:text-gray-800 focus:outline-none",disabled:!o,children:"Try to fix it"})]})]}):(0,r.jsxs)("div",{className:"flex items-center justify-between p-4 border-b border-gray-700",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("button",{onClick:s,className:"mr-4 px-3 py-1 text-sm text-gray-200 hover:bg-gray-800 rounded-md transition-colors border border-gray-700",children:(0,r.jsxs)("span",{className:"flex items-center",children:[(0,r.jsx)("svg",{className:"w-3 h-3 mr-1.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})}),"Close"]})}),(0,r.jsxs)("h2",{className:"text-lg font-medium text-white flex items-center",children:["Build error",(0,r.jsx)("span",{className:"text-gray-400 ml-4 text-sm font-normal",children:x})]})]}),(0,r.jsx)("div",{className:"flex items-center",children:(0,r.jsx)("button",{onClick:h,className:"inline-flex items-center px-3 py-1.5 border border-gray-700 rounded-md shadow-sm text-sm font-medium text-gray-800 bg-white hover:bg-gray-100 hover:text-gray-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-gray-800 focus:ring-blue-500",disabled:!o,children:"Try to fix it"})})]}),(0,r.jsxs)("div",{className:"flex-1 overflow-y-auto bg-gray-900 p-0",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between py-2 px-4 border-b border-gray-800 bg-gray-800/70",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("svg",{className:"text-gray-400 w-4 h-4 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),(0,r.jsx)("span",{className:"text-sm text-gray-300 font-mono",children:"Build Log"})]}),(0,r.jsx)("div",{className:"flex items-center",children:(0,r.jsx)("button",{onClick:p,className:"text-gray-400 hover:text-white focus:outline-none transition-colors","aria-label":i?"Copied!":"Copy to clipboard",children:i?(0,r.jsx)("svg",{className:"w-4 h-4 text-green-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})}):(0,r.jsx)("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})})})})]}),(0,r.jsx)("pre",{className:"font-mono text-xs text-white whitespace-pre-wrap p-4 overflow-x-auto",children:m(n)})]})]})})}function eo(e){let{activeTab:t,onTabChange:s,isLoading:a}=e;return(0,r.jsx)("div",{className:"lg:hidden sticky top-[48px] z-0 bg-gray-900 border-b border-gray-700 px-1 py-1 flex justify-between",children:(0,r.jsxs)("div",{className:"flex w-full bg-gray-800 rounded-md p-1 shadow-inner",children:[(0,r.jsxs)("button",{onClick:()=>s("chat"),className:"flex-1 flex items-center justify-center py-2 px-2 rounded-md text-sm font-medium transition-colors ".concat("chat"===t?"bg-primary text-white":"text-gray-400"),children:[(0,r.jsx)("svg",{className:"w-4 h-4 mr-1.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"})}),"Chat"]}),(0,r.jsxs)("button",{onClick:()=>s("code"),className:"flex-1 flex items-center justify-center py-2 px-2 rounded-md text-sm font-medium transition-colors ".concat("code"===t?"bg-primary text-white":"text-gray-400"),children:[(0,r.jsx)("svg",{className:"w-4 h-4 mr-1.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4"})}),"Code"]}),(0,r.jsxs)("button",{onClick:()=>s("preview"),className:"flex-1 flex items-center justify-center py-2 px-2 rounded-md text-sm font-medium transition-colors ".concat("preview"===t?"bg-primary text-white":"text-gray-400"),children:[(0,r.jsxs)("svg",{className:"w-4 h-4 mr-1.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]}),"Preview"]})]})})}function el(e){let{previewSlug:t,activeTab:s,onTabChange:n}=e,[o,l]=(0,a.useState)(!1),[i,c]=(0,a.useState)(null),[d,u]=(0,a.useState)(!0);return(0,a.useEffect)(()=>{t&&t!==i&&("preview"===s||d||l(!0),c(t)),"preview"===s&&l(!1)},[t,i,s,d]),(0,a.useEffect)(()=>{let e=setTimeout(()=>{u(!1)},1e4);return()=>clearTimeout(e)},[s]),(0,r.jsxs)("div",{className:"jsx-b62c4cefca792037 lg:hidden fixed bottom-0 left-0 right-0 z-30 bg-gray-900 border-t border-gray-700 pb-safe h-14",children:[(0,r.jsx)(k(),{id:"b62c4cefca792037",children:"@-webkit-keyframes pulseGlow{0%,100%{-webkit-transform:scale(1);transform:scale(1);opacity:.7}50%{-webkit-transform:scale(1.1);transform:scale(1.1);opacity:1;-webkit-box-shadow:0 0 4px 1px rgba(34,197,94,.7);box-shadow:0 0 4px 1px rgba(34,197,94,.7)}}@-moz-keyframes pulseGlow{0%,100%{-moz-transform:scale(1);transform:scale(1);opacity:.7}50%{-moz-transform:scale(1.1);transform:scale(1.1);opacity:1;-moz-box-shadow:0 0 4px 1px rgba(34,197,94,.7);box-shadow:0 0 4px 1px rgba(34,197,94,.7)}}@-o-keyframes pulseGlow{0%,100%{-o-transform:scale(1);transform:scale(1);opacity:.7}50%{-o-transform:scale(1.1);transform:scale(1.1);opacity:1;box-shadow:0 0 4px 1px rgba(34,197,94,.7)}}@keyframes pulseGlow{0%,100%{-webkit-transform:scale(1);-moz-transform:scale(1);-o-transform:scale(1);transform:scale(1);opacity:.7}50%{-webkit-transform:scale(1.1);-moz-transform:scale(1.1);-o-transform:scale(1.1);transform:scale(1.1);opacity:1;-webkit-box-shadow:0 0 4px 1px rgba(34,197,94,.7);-moz-box-shadow:0 0 4px 1px rgba(34,197,94,.7);box-shadow:0 0 4px 1px rgba(34,197,94,.7)}}.pulse-indicator.jsx-b62c4cefca792037{-webkit-animation:pulseGlow 2s infinite ease-in-out;-moz-animation:pulseGlow 2s infinite ease-in-out;-o-animation:pulseGlow 2s infinite ease-in-out;animation:pulseGlow 2s infinite ease-in-out}"}),(0,r.jsxs)("div",{className:"jsx-b62c4cefca792037 flex items-center justify-around h-full px-2",children:[(0,r.jsxs)("button",{onClick:()=>n("chat"),className:"jsx-b62c4cefca792037 "+"flex flex-col items-center justify-center w-1/3 h-full transition-colors ".concat("chat"===s?"text-blue-500":"text-gray-400 hover:text-gray-300"),children:[(0,r.jsx)("svg",{fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",className:"jsx-b62c4cefca792037 w-6 h-6 mb-1",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z",className:"jsx-b62c4cefca792037"})}),(0,r.jsx)("span",{className:"jsx-b62c4cefca792037 text-xs",children:"Chat"})]}),(0,r.jsxs)("button",{onClick:()=>n("code"),className:"jsx-b62c4cefca792037 "+"flex flex-col items-center justify-center w-1/3 h-full transition-colors ".concat("code"===s?"text-blue-500":"text-gray-400 hover:text-gray-300"),children:[(0,r.jsx)("svg",{fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",className:"jsx-b62c4cefca792037 w-6 h-6 mb-1",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4",className:"jsx-b62c4cefca792037"})}),(0,r.jsx)("span",{className:"jsx-b62c4cefca792037 text-xs",children:"Code"})]}),(0,r.jsxs)("button",{onClick:()=>n("preview"),className:"jsx-b62c4cefca792037 "+"flex flex-col items-center justify-center w-1/3 h-full transition-colors ".concat("preview"===s?"text-blue-500":"text-gray-400 hover:text-gray-300"," relative"),children:[(0,r.jsxs)("div",{className:"jsx-b62c4cefca792037 relative",children:[o&&(0,r.jsx)("span",{className:"jsx-b62c4cefca792037 absolute -top-0.5 -right-2 h-2 w-2 bg-green-500 rounded-full pulse-indicator"}),(0,r.jsxs)("svg",{fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",className:"jsx-b62c4cefca792037 w-6 h-6 mb-1",children:[(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z",className:"jsx-b62c4cefca792037"}),(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z",className:"jsx-b62c4cefca792037"})]})]}),(0,r.jsx)("span",{className:"jsx-b62c4cefca792037 text-xs",children:"Preview"})]})]})]})}ea.displayName="Chat";var ei=s(36347),ec=s(22926);let ed=(0,ei.c)("pk_live_9eBOACiG83hSt0n4y7Kg9Exo"),eu=(0,ei.c)("pk_live_51OJhJBHdGQpsHqInIzu7c6PzGPSH0yImD4xfpofvxvFZs0VFhPRXZCyEgYkkhOtBOXFWvssYASs851mflwQvjnrl00T6DbUwWZ");function em(e){let{onSuccess:t,totalAmount:s,onError:n}=e,o=(0,ec.useStripe)(),l=(0,ec.useElements)(),[i,c]=(0,a.useState)(!1),[d,u]=(0,a.useState)(!1);(0,a.useEffect)(()=>{let e=()=>{u(document.documentElement.classList.contains("dark"))};e();let t=new MutationObserver(e);return t.observe(document.documentElement,{attributes:!0,attributeFilter:["class"]}),()=>t.disconnect()},[]);let x=async e=>{if(e.preventDefault(),!o||!l)return;let s=l.getElement(ec.CardElement);if(s){c(!0);try{let{error:e,paymentMethod:r}=await o.createPaymentMethod({type:"card",card:s});if(e)throw Error(e.message);let a=await fetch("/api/invoice/retry-failed",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({paymentMethodId:r.id})}),n=await a.json();if(!a.ok)throw Error(n.error||"Payment failed");if(n.requiresAction){let{error:e,paymentIntent:t}=await o.confirmCardPayment(n.clientSecret);if(e)throw Error(e.message);if(a=await fetch("/api/invoice/retry-failed",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({paymentIntentId:t.id,paymentConfirmed:!0})}),n=await a.json(),!a.ok)throw Error(n.error||"Payment confirmation failed")}m.oR.success("Payment successful!"),t()}catch(t){let e=t.message||"Payment failed";n(e),m.oR.error(e)}finally{c(!1)}}};return(0,r.jsxs)("form",{onSubmit:x,className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Card Details"}),(0,r.jsx)("div",{className:"p-3 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-900",children:(0,r.jsx)(ec.CardElement,{options:{style:{base:{fontSize:"16px",color:d?"#ffffff":"#374151",backgroundColor:"transparent","::placeholder":{color:d?"#9CA3AF":"#6B7280"}},invalid:{color:"#EF4444"}}}})})]}),(0,r.jsx)("button",{type:"submit",disabled:!o||i,className:"w-full bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-4 rounded-lg transition-colors disabled:opacity-50",children:i?"Processing...":"Pay Now"})]})}function ex(e){let{isOpen:t,onClose:s,onPaymentSuccess:n,totalUnpaidAmount:o,failedCharges:l}=e,[i,c]=(0,a.useState)(!1),[d,u]=(0,a.useState)(!1),[x,p]=(0,a.useState)(null),{isWhitelabel:h,isClient:g}=(0,j.p)();if(!t)return null;let f=async()=>{u(!0),p(null);try{let a=await fetch("/api/invoice/retry-failed",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({})}),o=await a.json();if(!a.ok){var e,t,r;if((null===(e=o.error)||void 0===e?void 0:e.includes("payment method"))||(null===(t=o.error)||void 0===t?void 0:t.includes("missing a payment method"))||(null===(r=o.error)||void 0===r?void 0:r.includes("No payment method found"))){c(!0);return}throw Error(o.error||"Payment failed")}if(o.requiresAction){let e=h?await ed:await eu;if(e){let{error:t,paymentIntent:s}=await e.confirmCardPayment(o.clientSecret);if(t)throw Error(t.message);let r=await fetch("/api/invoice/retry-failed",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({paymentIntentId:s.id,paymentConfirmed:!0})}),a=await r.json();if(!r.ok)throw Error(a.error||"Payment confirmation failed")}}m.oR.success("Payment successful!"),n(),s()}catch(t){let e=t.message||"Payment failed";p(e),c(!0),m.oR.error(e)}finally{u(!1)}};return(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:(0,r.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-6 max-w-md w-full max-h-[90vh] overflow-y-auto",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Payment Required"}),(0,r.jsx)("button",{onClick:s,className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-200 transition-colors",children:(0,r.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]}),(0,r.jsxs)("div",{className:"mb-3",children:[(0,r.jsxs)("div",{className:"flex items-center mb-3",children:[(0,r.jsx)("div",{className:"w-10 h-10 bg-red-100 dark:bg-red-900 rounded-full flex items-center justify-center mr-3",children:(0,r.jsx)("svg",{className:"w-5 h-5 text-red-600 dark:text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"font-medium text-gray-900 dark:text-white",children:"Recent Hosting Payment Failed"}),(0,r.jsxs)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:["You currently have a pending hosting amount of ",(0,r.jsxs)("strong",{children:["$",o.toFixed(2)]})]})]})]}),(0,r.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Please complete your payment to continue sending messages."})]}),x&&(0,r.jsx)("div",{className:"mb-4 p-3 bg-red-100 dark:bg-red-900 text-red-700 dark:text-red-300 rounded-lg text-sm",children:x}),i?(0,r.jsx)(r.Fragment,{children:g&&(0,r.jsx)(r.Fragment,{children:h?(0,r.jsx)(ec.Elements,{stripe:ed,children:(0,r.jsx)(em,{onSuccess:()=>{n(),s()},totalAmount:o,onError:p})}):(0,r.jsx)(ec.Elements,{stripe:eu,children:(0,r.jsx)(em,{onSuccess:()=>{n(),s()},totalAmount:o,onError:p})})})}):(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)("div",{className:"text-center",children:(0,r.jsx)("button",{onClick:()=>{window.open("/dashboard?showUsage=yes#billing","_blank")},className:"text-sm text-blue-600 hover:text-blue-700 dark:text-blue-400 dark:hover:text-blue-300 underline",children:"View Hosting"})}),(0,r.jsx)("button",{onClick:f,disabled:d,className:"w-full bg-blue-600 hover:bg-blue-700 text-white font-medium py-3 px-4 rounded-lg transition-colors disabled:opacity-50",children:d?"Processing...":"Pay Now"})]})]})})}function ep(e){let{isOpen:t,onClose:s,onWakeUp:o}=e,{id:l}=(0,n.useRouter)().query,[i,c]=(0,a.useState)(!1);if(!t)return null;let d=async()=>{if(!l||"string"!=typeof l){m.oR.error("Invalid project ID");return}c(!0);try{let e=await fetch("/api/projects/sleep",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:l,isSleeping:!1})}),t=await e.json();if(!e.ok)throw Error(t.error||"Failed to wake up project");m.oR.success("Project woken up successfully!"),o(),s()}catch(e){console.error("Error waking up project:",e),m.oR.error(e.message||"Failed to wake up project")}finally{c(!1)}};return(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:(0,r.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-6 max-w-md w-full max-h-[90vh] overflow-y-auto",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Project Sleeping"}),(0,r.jsx)("button",{onClick:s,className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-200 transition-colors",disabled:i,children:(0,r.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]}),(0,r.jsxs)("div",{className:"mb-6",children:[(0,r.jsxs)("div",{className:"flex items-center mb-4",children:[(0,r.jsx)("div",{className:"w-10 h-10 bg-blue-100 dark:bg-blue-900 rounded-full flex items-center justify-center mr-3",children:(0,r.jsx)("svg",{className:"w-5 h-5 text-blue-600 dark:text-blue-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"})})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"font-medium text-gray-900 dark:text-white",children:"This project is sleeping"}),(0,r.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"You'll need to wake it up before continuing"})]})]}),(0,r.jsx)("p",{className:"text-gray-700 dark:text-gray-300 text-sm mb-4",children:"Your project has been put to sleep to save resources. Wake it up to continue working on it or send messages."})]}),(0,r.jsxs)("div",{className:"flex justify-end space-x-3",children:[(0,r.jsx)("button",{onClick:s,className:"px-4 py-2 text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200 transition-colors",disabled:i,children:"Cancel"}),(0,r.jsx)("button",{onClick:d,disabled:i,className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400 text-white rounded-lg font-medium transition-colors flex items-center",children:i?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,r.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,r.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Waking Up..."]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"})}),"Wake Up"]})})]})]})})}function eh(){let e=(0,n.useRouter)(),{id:t}=e.query,{isAuthenticated:s,isLoading:o}=(0,d.A)(),{data:i}=(0,et.useSession)(),[c,u]=(0,a.useState)(""),[x,p]=(0,a.useState)({}),[h,g]=(0,a.useState)(!0),[f,y]=(0,a.useState)("Loading project..."),[v,N]=(0,a.useState)(null),[k,C]=(0,a.useState)("preview"),[E,D]=(0,a.useState)("chat"),[T,I]=(0,a.useState)(null),[A,L]=(0,a.useState)(!1),[P,M]=(0,a.useState)([]),[O,B]=(0,a.useState)(!1),[R,F]=(0,a.useState)(null),[U,z]=(0,a.useState)(!1),W=(0,a.useRef)(!1),[G,J]=(0,a.useState)(null),[H,V]=(0,a.useState)("desktop"),[q,Y]=(0,a.useState)(0),{isWhitelabel:K,whitelabelConfig:X}=(0,j.p)(),[ee,es]=(0,a.useState)(null),[er,ei]=(0,a.useState)(!1),[ec,ed]=(0,a.useState)(!1),[eu,em]=(0,a.useState)(!1),[eh,eg]=(0,a.useState)(""),[ef,ey]=(0,a.useState)(void 0),[eb,ev]=(0,a.useState)(!1),[ej,ew]=(0,a.useState)(!1),[eN,ek]=(0,a.useState)("old"),[eC,eS]=(0,a.useState)(!1),[eE,eD]=(0,a.useState)(!1),[eT,eI]=(0,a.useState)(!1),[eA,eL]=(0,a.useState)({}),[eP,eM]=(0,a.useState)(!1),[eO,e_]=(0,a.useState)({}),eB=(0,a.useRef)(null),eR=(0,a.useRef)(!1),eF=(0,a.useRef)(null),eU=(0,a.useRef)(0),ez=(0,a.useRef)("");(0,a.useEffect)(()=>{(null==i?void 0:i.user)?localStorage.setItem("user",JSON.stringify(i.user)):localStorage.removeItem("user")},[i]),(0,a.useEffect)(()=>{let e=localStorage.getItem("previewType");("new"===e||"old"===e)&&ek(e)},[]);let eW=e=>{ek(e),localStorage.setItem("previewType",e)};(0,a.useEffect)(()=>{let e=()=>{ev(window.innerWidth<1024)};return e(),window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}},[]);let eG=e=>{D(e),("code"===e||"preview"===e)&&C(e)};(0,a.useEffect)(()=>{o||s||!t||e.push("/login?redirect=".concat(encodeURIComponent("/project/".concat(t))))},[o,s,t,e]);let eJ=e=>{eB.current&&(eB.current.submitHumanMessage("For the code present, we get this error:\n```\n".concat(e,"\n```\nHow can I resolve this? If making a fix, please make it concise.")),em(!1),eb&&D("chat"))},eH=(0,a.useCallback)(async()=>{if(!W.current)try{W.current=!0,z(!0);let e=await fetch("/api/subscription");if(e.ok){let t=await e.json();t.subscription&&F(t.subscription)}else console.error("Failed to fetch subscription data")}catch(e){console.error("Error fetching subscription data:",e)}finally{z(!1),W.current=!1}},[]),eV=(0,a.useCallback)(async()=>{if(s)try{let e=await fetch("/api/invoice/check-unpaid");if(e.ok){let t=await e.json();es(t)}else console.error("Failed to check unpaid charges")}catch(e){console.error("Error checking unpaid charges:",e)}},[s]);(0,a.useEffect)(()=>{eH()},[eH]),(0,a.useEffect)(()=>{eV()},[eV]),(0,a.useEffect)(()=>()=>{eF.current&&clearTimeout(eF.current)},[]);let eq=(0,a.useCallback)(async e=>{try{let t=await fetch("/api/projects/".concat(e));if(!t.ok)throw Error("Failed to load project");let s=await t.json();I(s.project),u(s.project.prompt||""),s.project.statusMessage&&s.project.statusMessage!==ez.current&&eB.current&&("building"===s.project.status||"answering"===s.project.status)&&(eB.current.addAssistantMessage(s.project.statusMessage,Z.STATUS,!1),ez.current=s.project.statusMessage),"mobile"===s.project.platform?V("mobile"):V("desktop");let r=(s.project.contracts||[]).filter(e=>e.artifactUrl&&!e.actualAddress&&e.isUsed);if(M(r),r.length>0&&"building"!==s.project.status&&"answering"!==s.project.status&&B(!0),s.files&&p(s.files),"completed"===s.project.status||"live"===s.project.status)return g(!1),y(""),!0;if("error"===s.project.status)return g(!1),y(""),N("An error occurred during generation. Please try again."),!0;if("building"===s.project.status)y("Building your app...");else if("answering"===s.project.status)y("Answering your question...");else if("draft"===s.project.status&&!eR.current){eR.current=!0,y("Starting generation...");let t=localStorage.getItem("activeMessageId:".concat(e));t&&localStorage.removeItem("activeMessageId:".concat(e));try{let r=!1,a=!1,n=!0,o=!0;{let e=localStorage.getItem("user");e&&JSON.parse(e).isAdmin;let t=localStorage.getItem("chatMaxMode"),s=localStorage.getItem("chatGeniusMode"),l=localStorage.getItem("chatImageGeneration"),i=localStorage.getItem("chatWebSearch");r=!!t&&JSON.parse(t),a=!!s&&JSON.parse(s),n=!l||JSON.parse(l),o=!i||JSON.parse(i)}await fetch("/api/projects/modify",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:e,message:s.project.prompt,attachments:s.project.attachments,activeMessageId:t,maxMode:r,geniusMode:a,imageGeneration:n,webSearch:o})})}catch(e){console.error("Failed to start generation:",e)}}return!1}catch(e){return console.error("Error fetching project:",e),N("Failed to load project. Please try again."),g(!1),y(""),!0}},[,N,p,g,y,I,u]);(0,a.useEffect)(()=>{if(o||!s||!t||"string"!=typeof t)return;if(eF.current){console.log("Polling already in progress, not restarting");return}console.log("Starting new polling cycle"),g(!0),N(null),y("Loading project..."),eR.current=!1,eU.current=0;let e=async()=>{if(eU.current>=120){y(""),N("Generation is taking longer than expected. Please refresh the page."),g(!1),eF.current=null;return}eU.current++,console.log("Polling project (".concat(eU.current,"/").concat(120,")")),!await eq(t)&&eU.current<120?eF.current=setTimeout(e,1e4):(eF.current=null,eB.current&&eB.current.fetchAndUpdateMessages())};return e(),()=>{eF.current&&(clearTimeout(eF.current),eF.current=null)}},[t,eq,o,s]);let eY=async s=>{if(t&&"string"==typeof t){if((null==T?void 0:T.isSleeping)===!0){ed(!0);return}J(s),g(!0);try{if(!(await fetch("/api/projects/restore",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:t,preview:s})})).ok)throw Error("Failed to restore preview");e.reload()}catch(e){console.error("Error restoring preview:",e),J(null),g(!1),eB.current&&eB.current.addAssistantMessage("Failed to restore preview. Please try again.",Z.ERROR,!1)}}},eK=(e,t)=>(null==T?void 0:T.isSleeping)===!0?(ed(!0),!1):null==ee||!ee.hasUnpaidCharges||!((null==ee?void 0:ee.totalUnpaidAmount)>0)||(ei(!0),!1),eX=async(e,s,r,a,n,o,l,c,d,u)=>{var m,x;if(t&&"string"==typeof t){g(!0);try{eU.current=0;let x=!1,p=!1,h=!0,f=!0;{let e=localStorage.getItem("chatMaxMode"),t=localStorage.getItem("chatGeniusMode"),s=localStorage.getItem("chatImageGeneration"),r=localStorage.getItem("chatWebSearch");x=!!e&&JSON.parse(e),p=!!t&&JSON.parse(t),h=!s||JSON.parse(s),f=!r||JSON.parse(r)}let b=await fetch((null==i||null===(m=i.user)||void 0===m||m.isAdmin,"/api/projects/modify"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:t,message:e,attachments:s||[],forceBackendRequest:r,forceFrontEndRequest:a,forceSkipSecrets:n,activeMessageId:o,forceAnsweredQuestions:l||!1,questionsAndAnswers:c||[],forceExperiment:d||"",forceVariation:u||"",maxMode:x,geniusMode:p,imageGeneration:h,webSearch:f})});if(!b.ok){if(402===b.status){if((await b.json()).requiresUpgrade){L(!0),eB.current&&eB.current.addAssistantMessage("You have reached your message limit for this billing cycle. Please upgrade your subscription to continue.",Z.STATUS,!1),g(!1);return}let e=await b.json();throw Error(e.error||"Failed to modify app")}{let e=await b.json();throw Error(e.error||"Failed to modify app")}}eF.current&&clearTimeout(eF.current),eU.current=0;let v=async()=>{if(eU.current>=120){y(""),N("Modification is taking longer than expected. Please refresh the page."),g(!1);return}eU.current++,console.log("Polling for modification (".concat(eU.current,"/").concat(120,")")),await eq(t)?eB.current&&eB.current.fetchAndUpdateMessages():eU.current<120&&(eF.current=setTimeout(v,1e4))};v()}catch(e){console.error("Error modifying app:",e),eB.current&&((null===(x=e.message)||void 0===x?void 0:x.toLowerCase().includes("listing supabase projects"))?eB.current.addAssistantMessage("I was unable to connect to Supabase. If you revoked your access token, please set a new one in your Dashboard, in the Account tab.",Z.COMPLETED,!0):eB.current.addAssistantMessage("Sorry, I encountered an error while trying to modify the app: ".concat(e.message||"Unknown error",". Please try again with a different request."),Z.COMPLETED,!0)),g(!1)}}},e$=()=>{eB.current&&eB.current.addAssistantMessage("Your app has been published successfully!",Z.COMPLETED,!1),I(e=>({...e,status:"live",build:e.preview}))},eQ=async()=>{if(!t||"string"!=typeof t)return;let e=0,s=async()=>{if(e>=60){console.log("Preview generation polling timeout");return}e++,console.log("Polling for preview generation (".concat(e,"/").concat(60,")"));try{let r=await fetch("/api/projects/".concat(t,"?files=no"));if(!r.ok)return;let a=await r.json();if(I(a.project),a.project.expoPreviewProjectId){console.log("Preview generation completed");return}e<60&&setTimeout(s,1e4)}catch(e){console.error("Error polling for preview:",e)}};s()},eZ=async()=>{if(!t||"string"!=typeof t)return;if((null==T?void 0:T.isSleeping)===!0){ed(!0);return}g(!0),y("Saving changes..."),eF.current&&clearTimeout(eF.current),eU.current=0;let e=async()=>{if(eU.current>=120){y(""),N("Saving is taking longer than expected. Please refresh the page."),g(!1),eF.current=null;return}eU.current++,console.log("Polling for changed files (".concat(eU.current,"/").concat(120,")"));try{let s=await fetch("/api/projects/".concat(t));if(!s.ok){console.error("Failed to fetch project during changed files polling");return}let r=await s.json();if(I(r.project),"building"!==r.project.status&&"answering"!==r.project.status){console.log("Changed files completed"),g(!1),y(""),eF.current=null,r.files&&p(r.files),eB.current&&eB.current.fetchAndUpdateMessages(),C("preview"),eq(t);return}eU.current<120?eF.current=setTimeout(e,1e4):eF.current=null}catch(e){console.error("Error polling for changed files:",e),g(!1),y(""),N("Failed to save changes. Please try again."),eF.current=null}};e()},e0=async()=>{if(t&&"string"==typeof t){if((null==T?void 0:T.isSleeping)===!0){ed(!0);return}try{let e=await fetch("/api/publish",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:t})}),s=await e.json();if(!e.ok)throw Error(s.message||s.error||"Something went wrong");e$()}catch(e){throw console.error("Error publishing app:",e),m.oR.error(e.message||e.error||"Something went wrong"),e}}},e1=(e,t)=>{eg(e),ey(t),em(!0),D("preview")},e2=async()=>{if(t&&"string"==typeof t)try{if(g(!1),y(""),eF.current&&(clearTimeout(eF.current),eF.current=null),!(await fetch("/api/projects/stop",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:t})})).ok)throw Error("Failed to stop project generation")}catch(e){console.error("Error stopping project generation:",e)}},e4=()=>{eS(!0),Y(e=>e+1),setTimeout(()=>{eS(!1)},400)},e3=async()=>{if(t){eD(!0);try{let e=await fetch("/api/projects/".concat(t,"/download"));if(e.ok){let t=await e.blob(),s=window.URL.createObjectURL(t),r=document.createElement("a");r.href=s,r.download="".concat((null==T?void 0:T.slug)||"project",".zip"),document.body.appendChild(r),r.click(),window.URL.revokeObjectURL(s),r.remove()}else if(429===e.status){let t=(await e.json()).message||"Rate limit exceeded. Please try again later.";m.oR.error(t)}else m.oR.error("Failed to download project"),console.error("Failed to download project")}catch(e){console.error("Download error:",e),m.oR.error("Failed to download project. Please try again.")}finally{eD(!1)}}},e6=async()=>{if(console.log("UNSAVED",JSON.stringify({event:"save_code_clicked",projectId:t,fileCount:Object.keys(eA).length,files:Object.keys(eA)})),t&&0!==Object.keys(eA).length){eI(!0);try{console.log("UNSAVED",JSON.stringify({event:"calling_api_from_code_toolbar",endpoint:"/api/projects/change-files",payload:{projectId:t,changedFiles:eA}}));let e=await fetch("/api/projects/change-files",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({projectId:t,changedFiles:eA})});if(console.log("UNSAVED",JSON.stringify({event:"api_response_from_code_toolbar",status:e.status,ok:e.ok})),429===e.status){let t=(await e.json()).message||"Rate limit exceeded. Please try again later.";throw Error(t)}if(!e.ok)throw Error("Failed to save all changes");console.log("UNSAVED",JSON.stringify({event:"api_success_from_code_toolbar",message:"starting_poll"})),await eZ()}catch(e){console.error("UNSAVED",JSON.stringify({event:"save_code_toolbar_error",error:e.message})),m.oR.error(e.message||"Failed to save all changes")}finally{eI(!1)}}},e5=async()=>{if(console.log("UNSAVED",JSON.stringify({event:"save_preview_clicked",projectId:t,fileCount:Object.keys(eO).length,files:Object.keys(eO)})),!t||0===Object.keys(eO).length){console.log("UNSAVED",JSON.stringify({event:"save_skipped",reason:"no_changes_or_no_id"}));return}eI(!0);try{let e={projectId:t,changedFiles:eO};console.log("UNSAVED",JSON.stringify({event:"calling_api_from_preview",endpoint:"/api/projects/change-files",payload:e}));let s=await fetch("/api/projects/change-files",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(console.log("UNSAVED",JSON.stringify({event:"api_response_from_preview",status:s.status,ok:s.ok,statusText:s.statusText})),429===s.status){let e=(await s.json()).message||"Rate limit exceeded. Please try again later.";throw console.log("UNSAVED",JSON.stringify({event:"rate_limit_error",message:e})),Error(e)}if(!s.ok){let e=await s.json().catch(()=>({error:"Unknown error"}));throw console.log("UNSAVED",JSON.stringify({event:"api_error",status:s.status,error:e.error||e.message||"Failed to save changes"})),Error(e.error||e.message||"Failed to save changes")}let r=await s.json();console.log("UNSAVED",JSON.stringify({event:"api_success_from_preview",result:r})),console.log("UNSAVED",JSON.stringify({event:"clearing_unsaved_state_before_poll"})),eM(!1),e_({}),p(e=>({...e,...eO})),console.log("UNSAVED",JSON.stringify({event:"starting_poll_after_save"})),await eZ()}catch(e){console.error("UNSAVED",JSON.stringify({event:"save_preview_error",error:e.message})),m.oR.error(e.message||"Failed to save changes")}finally{eI(!1)}},e7=async()=>{await eV(),await eH()};return o?(0,r.jsx)("div",{className:"min-h-screen bg-gray-900 flex items-center justify-center",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsxs)("svg",{className:"animate-spin h-10 w-10 text-blue-500 mx-auto mb-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,r.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,r.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),(0,r.jsx)("p",{className:"text-gray-300",children:"Checking authentication..."})]})}):s?t?(0,r.jsxs)("div",{className:"min-h-screen ".concat(!K&&"bg-gray-50 dark:bg-gray-900"," flex flex-col ").concat(eb?"fixed-container":""),style:{backgroundColor:K&&(null==X?void 0:X.primaryColor)||void 0},children:[(0,r.jsxs)(l(),{children:[(0,r.jsxs)("title",{children:[K?(null==X?void 0:X.siteName)?"".concat(null==X?void 0:X.siteName," -"):"":"Famous.ai -"," ",(null==T?void 0:T.slug)||t]}),(0,r.jsx)("meta",{name:"description",content:"Manage and preview your generated app"}),(0,r.jsx)("meta",{name:"viewport",content:"width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover"})]}),(0,r.jsxs)("header",{className:"".concat(eb?"fixed top-0 left-0 right-0 z-30":""," h-[56px]"),children:[(0,r.jsx)(w,{activeView:k,mobileActiveTab:E,isMobile:eb,setActiveView:C,isLoading:h,projectSlug:null==T?void 0:T.slug,projectId:"string"==typeof t?t:void 0,projectPreview:(null==T?void 0:T.preview)||"",projectBuild:(null==T?void 0:T.build)||"",projectPlatform:(null==T?void 0:T.platform)||"website",projectExpoPreviewProjectId:(null==T?void 0:T.expoPreviewProjectId)||"",projectStatus:(null==T?void 0:T.status)||"",onPublish:e0,userSubscription:R?{tier:R.tier,messageCount:R.messageCount,messageLimit:R.limit,dailyCount:R.dailyCount||0,monthlyCount:R.monthlyCount||0,dailyLimit:R.dailyLimit||0,monthlyLimit:R.monthlyLimit||0,monthlyBuildSpend:R.monthlyBuildSpend||0,monthlyBuildCredit:R.monthlyBuildCredit||0,dailyBuildSpend:R.dailyBuildSpend||0,dailyBuildCredit:R.dailyBuildCredit||0}:void 0,domains:(null==T?void 0:T.domains)||[],onSubscriptionClick:()=>L(!0),onGeneratePreview:eQ,projectContracts:(null==T?void 0:T.contracts)||[],onContractsDeployed:eZ,onTryToFixIt:eJ}),!eb&&(0,r.jsx)(eo,{activeTab:E,onTabChange:eG,isLoading:h})]}),eb?(0,r.jsxs)("main",{className:"fixed left-0 right-0 top-[56px] bottom-[56px] overflow-hidden",children:[(0,r.jsx)("div",{className:"".concat("chat"!==E?"hidden":"flex"," h-full flex-col"),children:(0,r.jsx)(ea,{ref:eB,initialPrompt:c,onSendMessage:eX,onBeforeSendMessage:eK,onStopProject:e2,isLoading:h,projectId:"string"==typeof t?t:"",projectPreview:(null==T?void 0:T.preview)||"",projectStatus:(null==T?void 0:T.status)||"",hideHeader:!0,onRestorePreview:eY,restoringPreview:G||"",onErrorClick:e1,onTryToFixIt:eJ,isMobile:eb})}),(0,r.jsx)("div",{className:"".concat("chat"===E?"hidden":"flex"," h-full"),children:(0,r.jsx)("div",{className:"bg-white dark:bg-gray-800 flex-1 flex flex-col h-full rounded-lg overflow-hidden border border-gray-200 dark:border-gray-700",children:h?(0,r.jsxs)("div",{className:"flex flex-col items-center justify-center h-full",children:[(0,r.jsxs)("svg",{className:"animate-spin -ml-1 mr-3 h-10 w-10 text-primary",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,r.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,r.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),(0,r.jsx)("p",{className:"mt-3 text-gray-600 dark:text-gray-300",children:f})]}):eu?(0,r.jsx)("div",{className:"h-full relative",children:(0,r.jsx)(en,{isOpen:!0,onClose:()=>{em(!1),eb&&D("chat")},errorMessage:eh,onTryToFixIt:()=>eJ(eh),timestamp:ef})}):"code"===E?(0,r.jsxs)("div",{className:"h-full w-full flex flex-col",children:[(0,r.jsx)($,{activeView:"code",isMobile:eb,projectId:"string"==typeof t?t:void 0,projectSlug:null==T?void 0:T.slug,onDownload:e3,isDownloading:eE,onSaveAllChanges:e6,isSavingAllChanges:eT,hasUnsavedChanges:Object.keys(eA).length>0,whitelabelConfig:X,isWhitelabel:K}),(0,r.jsx)("div",{className:"flex-1 overflow-hidden",children:(0,r.jsx)(S,{files:x,projectId:"string"==typeof t?t:"",isMobile:eb,onSaveAllChanges:eZ,onChangedFilesUpdate:eL,onSavingStateUpdate:eI})})]}):"preview"===E?(0,r.jsxs)("div",{className:"h-full flex flex-col",children:[(0,r.jsx)($,{activeView:"preview",isMobile:eb,previewMode:H,setPreviewMode:V,onRefreshPreview:e4,isRefreshing:eC,projectPlatform:(null==T?void 0:T.platform)||"website",inspectorMode:ej,setInspectorMode:ew,previewType:eN,setPreviewType:eW,hasUnsavedChanges:eP,onSaveAllChanges:e5,isSavingAllChanges:eT,whitelabelConfig:X,isWhitelabel:K}),(0,r.jsx)("div",{className:"flex-1 overflow-hidden",children:(0,r.jsx)(_,{previewSlug:(null==T?void 0:T.preview)||"",projectId:"string"==typeof t?t:"",onTryToFixIt:eJ,previewMode:H,refreshKey:q,files:x,previewType:eN,onSaveAllChanges:eZ,onUnsavedChangesUpdate:(e,t)=>{console.log("UNSAVED",JSON.stringify({event:"parent_received_update",hasChanges:e,fileCount:Object.keys(t).length})),eM(e),e_(t)},platform:(null==T?void 0:T.platform)||"website",inspectorMode:ej,setInspectorMode:ew})})]}):null})})]}):(0,r.jsx)("main",{className:"flex-1 w-full px-2",children:(0,r.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-7 gap-2 h-[calc(100vh-68px)]",children:[(0,r.jsx)("div",{className:"lg:col-span-2 bg-white dark:bg-gray-800 rounded-lg overflow-hidden border border-gray-200 dark:border-gray-700",children:(0,r.jsx)(ea,{ref:eB,initialPrompt:c,onSendMessage:eX,onBeforeSendMessage:eK,onStopProject:e2,isLoading:h,projectId:"string"==typeof t?t:"",projectPreview:(null==T?void 0:T.preview)||"",projectStatus:(null==T?void 0:T.status)||"",hideHeader:!0,onRestorePreview:eY,restoringPreview:G||"",onErrorClick:e1,onTryToFixIt:eJ,isMobile:eb})}),(0,r.jsx)("div",{className:"lg:col-span-5 flex flex-col h-full",children:(0,r.jsxs)("div",{className:"bg-white dark:bg-gray-800 flex-1 flex flex-col h-full rounded-lg overflow-hidden border border-gray-200 dark:border-gray-700",children:[(0,r.jsx)($,{activeView:k,isMobile:eb,previewMode:H,setPreviewMode:V,onRefreshPreview:e4,isRefreshing:eC,projectPlatform:(null==T?void 0:T.platform)||"website",inspectorMode:ej,setInspectorMode:ew,previewType:eN,setPreviewType:eW,projectId:"string"==typeof t?t:void 0,projectSlug:null==T?void 0:T.slug,onDownload:e3,isDownloading:eE,onSaveAllChanges:"preview"===k?e5:e6,isSavingAllChanges:eT,hasUnsavedChanges:"preview"===k?eP:Object.keys(eA).length>0,whitelabelConfig:X,isWhitelabel:K}),(0,r.jsx)("div",{className:"flex-1 overflow-hidden p-0",children:h?(0,r.jsxs)("div",{className:"flex flex-col items-center justify-center h-full",children:[(0,r.jsxs)("svg",{className:"animate-spin -ml-1 mr-3 h-10 w-10 text-primary",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,r.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,r.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),(0,r.jsx)("p",{className:"mt-3 text-gray-600 dark:text-gray-300",children:f})]}):eu?(0,r.jsx)("div",{className:"h-full relative",children:(0,r.jsx)(en,{isOpen:!0,onClose:()=>em(!1),errorMessage:eh,onTryToFixIt:()=>eJ(eh),timestamp:ef})}):"code"===k?(0,r.jsx)("div",{className:"h-full w-full overflow-hidden",children:(0,r.jsx)(S,{files:x,projectId:"string"==typeof t?t:"",isMobile:eb,onSaveAllChanges:eZ,onChangedFilesUpdate:eL,onSavingStateUpdate:eI})}):"preview"===k?(0,r.jsx)("div",{className:"h-full rounded-md overflow-hidden",children:(0,r.jsx)(_,{previewSlug:(null==T?void 0:T.preview)||"",projectId:"string"==typeof t?t:"",onTryToFixIt:eJ,previewMode:H,refreshKey:q,files:x,previewType:eN,onSaveAllChanges:eZ,onUnsavedChangesUpdate:(e,t)=>{console.log("UNSAVED",JSON.stringify({event:"parent_received_update",hasChanges:e,fileCount:Object.keys(t).length})),eM(e),e_(t)},platform:(null==T?void 0:T.platform)||"website",inspectorMode:ej,setInspectorMode:ew})}):null})]})})]})}),eb&&(0,r.jsx)(el,{activeTab:E,onTabChange:eG,previewSlug:(null==T?void 0:T.preview)||""}),R&&(0,r.jsx)(Q.A,{isOpen:A,onClose:()=>{L(!1)},currentTier:R.tier,currentUsage:R.messageCount,currentLimit:R.limit,subscriptionData:R}),P&&P.length>0&&(0,r.jsx)(b,{isOpen:O,onClose:()=>B(!1),pendingContracts:P,onContractsDeployed:eZ,onTryToFixIt:eJ}),ee&&ee.hasUnpaidCharges&&(0,r.jsx)(ex,{isOpen:er,onClose:()=>ei(!1),onPaymentSuccess:e7,totalUnpaidAmount:ee.totalUnpaidAmount,failedCharges:ee.failedCharges}),ec&&(0,r.jsx)(ep,{isOpen:ec,onClose:()=>ed(!1),onWakeUp:async()=>{I(e=>({...e,isSleeping:!1}))}})]}):(0,r.jsx)("div",{className:"p-8 text-center",children:"Loading..."}):null}}},e=>{var t=t=>e(e.s=t);e.O(0,[834,1106,2146,846,2928,1714,804,6191,636,6593,8792],()=>t(60373)),_N_E=e.O()}]);